<meta name='viewport' content='width=device-width, initial-scale=1'/><meta name='viewport' content='width=device-width, initial-scale=1'/><meta name='viewport' content='width=device-width, initial-scale=1'/><meta name='viewport' content='width=device-width, initial-scale=1'/><meta name='viewport' content='width=device-width, initial-scale=1'/><meta name='viewport' content='width=device-width, initial-scale=1'/><meta name='viewport' content='width=device-width, initial-scale=1'/><meta name='viewport' content='width=device-width, initial-scale=1'/><meta name='viewport' content='width=device-width, initial-scale=1'/><meta name='viewport' content='width=device-width, initial-scale=1'/><!DOCTYPE html>
<html lang="my">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Event 1</title>
<!-- Supabase Integration -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
/* NEW: Login Screen Styles - MODIFIED TO CIRCLE */
#login-screen {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background-image: url('https://iili.io/KOZgBK7.jpg');
  background-size: cover;
  background-position: center;
  z-index: 10000;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  color: white;
  font-family: Arial, sans-serif;
}

.login-container {
  background: rgba(0, 0, 0, 0.7);
  backdrop-filter: blur(10px);
  padding: 30px;
  border-radius: 20px; /* ·Ä°·Äù·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏ */
  text-align: center;
  max-width: 350px;
  width: 90%;
  border: 1px solid rgba(255, 255, 255, 0.2);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.profile-picture {
  width: 100px;
  height: 100px;
  border-radius: 50%; /* ·Ä°·Äù·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏ */
  background: rgba(255,255,255,0.2);
  margin: 0 auto 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  border: 3px solid rgba(255,255,255,0.3);
}

.profile-picture img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 50%; /* ·Ä°·Äù·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏ */
}

.profile-picture .default-avatar {
  font-size: 40px;
}

.login-input {
  width: 100%;
  padding: 12px;
  margin: 10px 0;
  border: none;
  border-radius: 25px; /* ·Ä°·Äù·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏ */
  background: rgba(255,255,255,0.9);
  text-align: center;
  font-size: 16px;
}

.login-btn {
  width: 100%;
  padding: 12px;
  margin: 10px 0;
  border: none;
  border-radius: 25px; /* ·Ä°·Äù·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏ */
  background: #4CAF50;
  color: white;
  font-size: 16px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.login-btn:hover {
  background: #45a049;
  transform: translateY(-2px);
}

.secondary-btn {
  background: rgba(255,255,255,0.2);
  color: white;
}

.secondary-btn:hover {
  background: rgba(255,255,255,0.3);
}

.login-note {
  font-size: 12px;
  opacity: 0.8;
  margin-top: 15px;
}

.user-profile {
  position: absolute;
  top: 10px;
  right: 10px;
  display: flex;
  align-items: center;
  gap: 10px;
  background: rgba(0,0,0,0.7);
  padding: 8px 15px;
  border-radius: 25px; /* ·Ä°·Äù·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏ */
  color: white;
  z-index: 100;
}

.user-avatar {
  width: 30px;
  height: 30px;
  border-radius: 50%; /* ·Ä°·Äù·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏ */
  object-fit: cover;
}

/* Profile Circle Styles - MODIFIED TO CIRCLE */
.profile-circle {
  position: absolute;
  top: 10px;
  right: 10px;
  width: 40px;
  height: 40px;
  border-radius: 50%; /* ·Ä°·Äù·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏ */
  background: rgba(0, 0, 0, 0.7);
  cursor: pointer;
  z-index: 100;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: visible;
  border: 2px solid rgba(255, 255, 255, 0.3);
  transition: all 0.3s ease;
}

.profile-circle:hover {
  transform: scale(1.1);
  border-color: rgba(255, 255, 255, 0.6);
}

.profile-circle img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 50%; /* ·Ä°·Äù·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏ */
}

.profile-circle .default-avatar {
  font-size: 20px;
  color: white;
}

/* Account Screen Styles - MODIFIED TO CIRCLE */
#account-screen {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.8);
  backdrop-filter: blur(10px);
  z-index: 1000;
  display: none;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

.account-container {
  background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
  border-radius: 20px; /* ·Ä°·Äù·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏ */
  padding: 30px;
  width: 90%;
  max-width: 400px;
  text-align: center;
  color: white;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.account-header {
  margin-bottom: 25px;
}

/* üß© Frame System - Fixed Version */
.account-avatar {
  position: relative;
  width: 100px;
  height: 100px;
  margin: 0 auto 15px;
  overflow: visible;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%; /* ·Ä°·Äù·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏ */
}

.account-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 50%; /* ·Ä°·Äù·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏ */
  z-index: 1;
  position: relative;
}

/* Frame overlay - ·Ä°·Äï·Äº·ÄÑ·Ä∫·Äò·ÄÄ·Ä∫·Äë·ÄΩ·ÄÄ·Ä∫·Ä°·Ä±·Ä¨·ÄÑ·Ä∫ */
.account-avatar.frame-active::before {
  content: "";
  position: absolute;
  top: -15px;
  left: -15px;
  width: calc(100% + 30px);
  height: calc(100% + 30px);
  background-image: var(--frame-url);
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  z-index: 2;
  pointer-events: none;
}

.account-avatar .default-avatar {
  font-size: 40px;
  z-index: 1;
  position: relative;
}

.account-name {
  font-size: 22px;
  font-weight: bold;
  margin-bottom: 5px;
}

.account-id {
  font-size: 14px;
  opacity: 0.8;
  margin-bottom: 20px;
}

.account-stats {
  display: flex;
  justify-content: space-around;
  margin: 20px 0;
  background: rgba(0, 0, 0, 0.3);
  padding: 15px;
  border-radius: 15px; /* ·Ä°·Äù·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏ */
}

.stat-item {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.stat-value {
  font-size: 18px;
  font-weight: bold;
  margin-bottom: 5px;
}

.stat-label {
  font-size: 12px;
  opacity: 0.8;
}

.account-actions {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-top: 20px;
}

.account-btn {
  padding: 12px;
  border: none;
  border-radius: 25px; /* ·Ä°·Äù·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏ */
  font-size: 16px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.edit-profile-btn {
  background: rgba(255, 255, 255, 0.2);
  color: white;
}

.edit-profile-btn:hover {
  background: rgba(255, 255, 255, 0.3);
}

.close-account-btn {
  position: absolute;
  top: 20px;
  right: 20px;
  background: rgba(255, 255, 255, 0.2);
  color: white;
  border: none;
  width: 40px;
  height: 40px;
  border-radius: 50%; /* ·Ä°·Äù·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏ */
  font-size: 20px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
}

.close-account-btn:hover {
  background: rgba(255, 255, 255, 0.3);
  transform: rotate(90deg);
}

/* Profile Circle with Frame */
.profile-circle.frame-active {
  overflow: visible;
}

.profile-circle.frame-active::before {
  content: "";
  position: absolute;
  top: -10px;
  left: -10px;
  width: calc(100% + 20px);
  height: calc(100% + 20px);
  background-image: var(--frame-url);
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  z-index: 2;
  pointer-events: none;
}

/* Splash Screen Styles */
#splash-screen {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background-image: url('https://i.ibb.co/tT37rGFt/Grid-Art-20251021-200434273.jpg');
  background-size: 100% 100%; /* ·Äï·ÄØ·Ä∂·ÄÄ·Ä≠·ÄØ ·Ä°·Äï·Äº·Ää·Ä∑·Ä∫·Äï·Äº·Äû */
  background-position: center;
  display: flex;
  flex-direction: column;
  justify-content: flex-end; /* ·Ä°·Ä±·Ä¨·ÄÄ·Ä∫·Äò·ÄÄ·Ä∫·Äû·Ä≠·ÄØ·Ä∑·ÄÅ·Äª */
  align-items: center;
  padding-bottom: 80px; /* ·Ä°·Ä±·Ä¨·ÄÄ·Ä∫ margin */
  z-index: 9999;
}

/* ·Äú·Ää·Ä∫·Äî·Ä±·Äû·Ä±·Ä¨ ·Ä°·Äù·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏ (·Äû·Ä±·Ä∏ version) */
.loading-circle {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  border: 4px solid transparent;
  border-top: 4px solid white;
  border-right: 4px solid skyblue;
  border-left: 4px solid lightblue;
  border-bottom: 4px solid white;
  animation: spin 1.2s linear infinite;
  margin-bottom: 15px;
}

/* ·Äú·Ää·Ä∫·Äï·Äê·Ä∫ Animation */
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* ·Äù·ÄÑ·Ä∫·Äõ·Äî·Ä∫ ·ÄÅ·Äú·ÄØ·Äê·Ä∫ (·Äî·Ää·Ä∫·Ä∏·Äî·Ää·Ä∫·Ä∏·Äû·Ä±·Ä∏ version) */
.enter-btn {
  margin-top: 15px;
  padding: 8px 22px; /* ·Äû·Ä±·Ä∏ */
  font-size: 15px;
  background: linear-gradient(145deg, #00aaff, #0077cc);
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(0, 153, 255, 0.4);
}

.enter-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 18px rgba(0, 153, 255, 0.6);
}

/* Countdown ·ÄÖ·Ä¨ */
.countdown-text {
  color: white;
  font-size: 15px;
  margin-top: 8px;
}

  *{margin:0;padding:0;box-sizing:border-box;}
  body{font-family:Arial,sans-serif;overflow:hidden;}

  /* Main Screen */
  #main-screen{
    width:100vw;height:100vh;
    background-image:url('https://i.ibb.co/gnbtJQs/429ad56884f1cefe7971e04bd4e66358.jpg');
    background-size:cover;background-position:center;
    position:relative;
  }

.token-card {
    position: absolute;
    top: 10px;
    left: 10px;
    min-width: 80px;
    height: 40px;
    background: black;
    border-radius: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0 10px;
    color: white;
    font-weight: bold;
    font-size: 14px;
    gap: 5px;
    z-index: 10;
}

.token-card img {
    width: 30px;
    height: auto;
}

.token-card .count {
    color: white;
    font-weight: bold;
    font-size: 14px;
}

/* Crystal stone next to coin */
.token-card .crystal {
    width: 24px;
    height: 24px;
    margin-left: 2px;
}
  /* Buttons */
  .buttons{
    position:absolute;top:50%;right:10px;
    transform:translateY(-50%);
    display:flex;flex-direction:column;gap:10px;
  }
  .btn{padding:6px 12px;font-size:13px;border:none;border-radius:6px;background:#007bff;color:white;cursor:pointer;transition:0.3s;}
  .btn:hover{background:#0056b3;}
  .btn:disabled{background:#6c757d;cursor:not-allowed;}

/* Event Screen */
#event-screen {
  display: block; /* ·ÄÖ·Äô·Ä∫·Ä∏·Äû·Äï·Ä∫·Äõ·Äî·Ä∫ display none ·ÄÄ·Ä≠·ÄØ block ·Äú·ÄØ·Äï·Ä∫·Äë·Ä¨·Ä∏ */
  width: 100vw;
  height: 100vh;
  background-image: url('https://i.ibb.co/7tZL0Fhg/a2fde05c6d9780b57f3b05cc831f351b.jpg');
  background-size: cover;
  background-position: center;
  position: relative;
}

/* Box ·Ä°·Äï·Ä±·Ä´ */
.event-box {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 180px;
  height: 180px;
  background-image: url('https://i.ibb.co/bRgmGWcf/Grid-Art-20251012-184614471.png');
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  z-index: 5;
}

/* ·Ä°·ÄÅ·Äº·Ä¨·Ä∏ GIF overlay (optional) */
#screen2-gif {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: none;
  background-size: cover;
  background-position: center;
  z-index: 10;
}

  .open-btn{
    position:absolute;bottom:80px;left:50%;
    transform:translateX(-50%);
    padding:12px 24px;font-size:16px;border:none;border-radius:8px;background:#007bff;color:white;cursor:pointer;transition:0.3s;
    z-index:5;
  }
  .open-btn:hover{background:#0056b3;}

  .back-btn{
    position:absolute;top:20px;left:20px;
    padding:8px 16px;font-size:14px;border:none;border-radius:6px;background:#007bff;color:white;
    cursor:pointer;display:flex;align-items:center; z-index:5;
  }
  .back-btn:hover{background:#0056b3;}
  .back-btn::before{content:'‚Üê';margin-right:6px;font-size:16px;}

  .reward-popup{
    position:absolute;top:50%;left:50%;
    transform:translate(-50%,-50%);
    display:none;flex-direction:column;align-items:center;
    background:rgba(0,0,0,0.7);padding:20px;border-radius:12px;
    color:white;font-size:18px;font-weight:bold;text-align:center;
    z-index:20;
  }
  .reward-popup img{width:80px;height:80px;margin-bottom:10px;}
  .reward-popup .close-btn{
    margin-top:10px;padding:6px 12px;font-size:14px;border:none;border-radius:6px;background:#007bff;color:white;cursor:pointer;
  }
  .reward-popup .close-btn:hover{background:#0056b3;}

/* Main Layout Reset */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: Arial, sans-serif;
  overflow: hidden;
}

/* Exchange Screen Base */
#exchange-screen {
  display: block;
  width: 100vw;
  height: 100vh;
  background-image: url('https://i.ibb.co/FLT1LhqQ/f9ace1a0821b26ca96f698d873d697ab.jpg');
  background-size: cover;
  background-position: center;
  position: relative;
  color: white;
  overflow-y: auto;
}

/* Exchange Header */
.exchange-header {
  text-align: center;
  margin-top: 20px;
  background: rgba(0, 0, 0, 0.6);
  padding: 15px 30px;
  border-radius: 12px;
}

.exchange-header h2 {
  font-size: 28px;
  margin: 0;
  text-shadow: 0 2px 4px rgba(0,0,0,0.5);
}

/* Exchange Cards Container */
.exchange-items-container {
  width: 100%;
  padding: 20px;
  background: rgba(0, 0, 0, 0.7);
  border-radius: 20px 20px 0 0;
  margin-top: 20px;
}

.exchange-cards {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 20px;
  justify-items: center;
  align-items: start;
  max-width: 700px;
  margin: 0 auto;
}

.exchange-card {
  background: rgba(0, 0, 0, 0.7);
  border-radius: 12px;
  padding: 15px;
  width: 100%;
  max-width: 300px;
  text-align: center;
  display: flex;
  flex-direction: column;
  align-items: center;
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.exchange-card img {
  width: 100%;
  border-radius: 8px;
  margin-bottom: 10px;
}

.exchange-card p {
  margin: 8px 0;
  font-size: 14px;
  min-height: 40px;
  display: flex;
  align-items: center;
}

/* Back Button */
.back-btn {
  position: absolute;
  top: 20px;
  left: 20px;
  padding: 8px 16px;
  font-size: 14px;
  border: none;
  border-radius: 6px;
  background: #007bff;
  color: white;
  cursor: pointer;
  display: flex;
  align-items: center;
  z-index: 5;
}

.back-btn:hover {
  background: #0056b3;
}

.back-btn::before {
  content: '‚Üê';
  margin-right: 6px;
  font-size: 16px;
}

/* ============================= */
/* üß° Anime Girl + Typing Chat  */
/* ============================= */

#exchange-chat-container {
  position: absolute;
  bottom: 5px;
  left: 50%;
  transform: translateX(-50%);
  width: 200%;
  display: flex;
  justify-content: center;
  align-items: flex-end;
  z-index: 10;
  pointer-events: none;
}

/* Anime Girl */
#exchange-chat-icon {
  width: 400px;
  height: auto;
  border-radius: 3px;
  pointer-events: none;
  filter: drop-shadow(0 4px 10px rgba(0,0,0,0.5));
  transition: transform 0.3s ease;
}

#exchange-chat-icon:hover {
  transform: scale(1.05);
}

/* üÜô Chat Text ·ÄÄ·Ä≠·ÄØ Anime ·Äï·Ä±·Ä´·Ä∫·Ä°·Äï·Ä±·Ä´·Ä∫·Äê·ÄÑ·Ä∫·Äë·Ä¨·Ä∏·Äô·Äö·Ä∫ */
#exchange-chat-text {
  position: absolute;
  top: 250px; /* üÜô ·Ä°·Äï·Ä±·Ä´·Ä∫·ÄÜ·ÄØ·Ä∂·Ä∏·Äô·Äæ·Ä¨·Äê·ÄÑ·Ä∫ */
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0, 0, 0, 0.6);
  color: white;
  padding: 12px 24px;
  border-radius: 20px;
  font-size: 17px;
  font-weight: bold;
  text-align: center;
  box-shadow: 0 0 12px rgba(0,0,0,0.6);
  max-width: 360px;
  width: 90%;
  line-height: 1.4em;
  overflow: hidden;
  white-space: normal;
  transition: opacity 0.3s ease;
  pointer-events: auto;
  z-index: 20;
}

/* ·Äú·Ä≠·Äô·Äπ·Äô·Ä±·Ä¨·Ä∫·Äõ·Ä±·Ä¨·ÄÑ·Ä∫ link */
#exchange-chat-text .exchange-link {
  color: #ffae00;
  text-decoration: underline;
  cursor: pointer;
  transition: color 0.3s ease;
}

#exchange-chat-text .exchange-link:hover {
  color: #ffd35b;
}

/* Scrollbar Hidden */
::-webkit-scrollbar {
  width: 0;
  height: 0;
}
/* ‚ùå Media query ·Äñ·Äª·ÄÄ·Ä∫·Äú·Ä≠·ÄØ·ÄÄ·Ä∫ -- Android ·Äô·Äæ·Ä¨·Äú·Ä≤ ·ÅÇ ·ÄÄ·ÄΩ·ÄÄ·Ä∫·Äï·Ä≤·ÄÄ·Äª·Äî·Ä∫ */
  
  /* Task Screen */
  #task-screen{
    display:none;width:100vw;height:100vh;
    background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
    position:relative;color:white;
    padding:20px;
    overflow-y: auto;
  }

  .task-header {
    text-align: center;
    margin-bottom: 20px;
    padding-top: 20px;
  }

  .task-header h2 {
    font-size: 24px;
    margin-bottom: 10px;
    text-shadow: 0 2px 4px rgba(0,0,0,0.5);
  }

  .task-header p {
    font-size: 14px;
    opacity: 0.8;
  }

  .task-list{
    margin-top: 20px;
    display:flex;flex-direction:column;gap:15px;
    padding-bottom: 30px;
  }
  .task-item{
    background: rgba(255,255,255,0.1);
    backdrop-filter: blur(10px);
    padding:15px;border-radius:12px;
    display:flex;justify-content:space-between;align-items:center;
    transition: all 0.3s ease;
    border: 1px solid rgba(255,255,255,0.2);
  }

  .task-item:hover {
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
  }

  .task-info h3{
    margin-bottom:5px;
    font-size: 16px;
  }
  .task-info p{
    font-size:14px;
    color:#ddd;
    margin-bottom: 5px;
  }

  .task-reward {
    display: flex;
    align-items: center;
    gap: 5px;
    margin-top: 5px;
    font-size: 14px;
    color: gold;
  }

  .task-reward img {
    width: 16px;
    height: 16px;
  }

  .task-completed{
    background:rgba(26, 83, 27, 0.7);
    color:#90ee90;
  }
  .task-completed .btn{
    background:#28a745;
  }

  /* Exchange Form */
  .exchange-form{
    position:absolute;top:50%;left:50%;
    transform:translate(-50%,-50%);
    background:rgba(0,0,0,0.8);padding:20px;border-radius:12px;
    color:white;width:300px;display:none;z-index:20;
  }
  .exchange-form h3{text-align:center;margin-bottom:15px;}
  .form-group{margin-bottom:15px;}
  .form-group label{display:block;margin-bottom:5px;font-size:14px;}
  .form-group input{width:100%;padding:8px;border-radius:4px;border:none;}
  .form-buttons{display:flex;gap:10px;justify-content:center;}
  .form-buttons button{padding:8px 16px;border:none;border-radius:4px;cursor:pointer;}
  .confirm-btn{background:#28a745;color:white;}
  .cancel-btn{background:#dc3545;color:white;}

  /* Telegram Success Message */
  .telegram-success{
    position:absolute;top:50%;left:50%;
    transform:translate(-50%,-50%);
    background:rgba(0,0,0,0.8);padding:20px;border-radius:12px;
    color:white;text-align:center;display:none;z-index:30;
  }
  .telegram-success h3{color:#28a745;margin-bottom:10px;}

  /* Timer Display */
  .timer-display{
    position:absolute;
    bottom: 20px;
    left: 50%;
    transform:translateX(-50%);
    background:rgba(0,0,0,0.7);color:white;
    padding:12px 16px;border-radius:8px;font-size:14px;
    text-align: center;
    width: 90%;
    max-width: 400px;
  }

  .timer-display.ready {
    background: rgba(40, 167, 69, 0.7);
    animation: pulse 2s infinite;
  }

  @keyframes pulse {
    0% { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0.7); }
    70% { box-shadow: 0 0 0 10px rgba(40, 167, 69, 0); }
    100% { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0); }
  }

  /* Claim Time Display */
  .claim-time-display {
    font-size: 12px;
    color: #90ee90;
    margin-top: 5px;
    font-style: italic;
  }

  .next-claim-time {
    font-size: 12px;
    color: #ffa500;
    margin-top: 3px;
    font-style: italic;
  }

  /* Countdown Timer Styles */
  .countdown-timer {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
    margin: 10px 0;
    font-size: 16px;
    font-weight: bold;
  }

  .countdown-unit {
    display: flex;
    flex-direction: column;
    align-items: center;
    background: rgba(0, 0, 0, 0.5);
    padding: 8px 12px;
    border-radius: 8px;
    min-width: 60px;
  }

  .countdown-value {
    font-size: 20px;
    color: #ffcc00;
  }

  .countdown-label {
    font-size: 12px;
    color: #ddd;
    margin-top: 4px;
  }

  .ready-to-claim {
    color: #90ee90;
    font-size: 18px;
    font-weight: bold;
    text-align: center;
    margin: 15px 0;
    animation: blink 1.5s infinite;
  }

  @keyframes blink {
    0% { opacity: 1; }
    50% { opacity: 0.5; }
    100% { opacity: 1; }
  }

#chat-container {
  position: fixed; /* scroll ·Äî·Ä±·Äõ·Ä¨·Äô·Äæ·Ä¨·Äê·Ää·Ä∫·Äî·Ä±·ÄÖ·Ä± */
  bottom: 0;
  left: 0;
  width: 100%; /* ·Ä°·Äï·Ä±·Ä´·Ä∫·Äô·Äæ·Ä¨ ·Ä°·ÄÅ·Äº·Ä¨·Ä∏ elements ·Äñ·ÄØ·Ä∂·Ä∏·Äô·Äë·Ä¨·Ä∏·ÄÖ·Ä±·Äõ·Äî·Ä∫ */
  height: auto;
  display: flex;
  justify-content: center; /* ·Ä°·Äú·Äö·Ä∫·Äê·ÄΩ·ÄÑ·Ä∫·Äë·Ä¨·Ä∏·ÄÅ·Äª·ÄÑ·Ä∫·Äõ·ÄÑ·Ä∫ center */
  align-items: flex-end;
  pointer-events: none; /* container ·Äî·Äæ·ÄÑ·Ä∑·Ä∫·Äï·ÄØ·Ä∂·ÄÄ·Ä≠·ÄØ click ·Äô·Äñ·Äº·ÄÖ·Ä∫·ÄÖ·Ä± */
  z-index: 0; /* ·Ä°·ÄÅ·Äº·Ä¨·Ä∏ UI ·Äï·Ä±·Ä´·Ä∫·Äô·Äæ·Ä¨·Äî·Ä±·Ä¨·ÄÄ·Ä∫·ÄÅ·Ä∂·Ä°·Äñ·Äº·ÄÖ·Ä∫ */
}

#chat-icon {
  width: 300px;
  height: 300px;
  border-radius: 50%;
  transform: translateY(20px);
  pointer-events: none; /* click ·Äô·Äñ·Äº·ÄÖ·Ä∫·ÄÖ·Ä±·Äñ·Ä≠·ÄØ·Ä∑ */
}

#chat-icon:hover {
  transform: scale(1.05) translate(-40px, 20px);
}

#chat-text {
  position: absolute;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0, 0, 0, 0.6);
  color: white;
  padding: 12px 24px;
  border-radius: 20px;
  font-size: 22px;
  font-weight: bold;
  text-align: center;
  box-shadow: 0 0 12px rgba(0,0,0,0.6);
  z-index: 999; /* ·Äï·ÄØ·Ä∂·Ä°·Äï·Ä±·Ä´·Ä∫·Äë·Äï·Ä∫·Äñ·Ä≠·ÄØ·Ä∑ */
  transition: opacity 0.5s ease;

  width: 90%;              /* ·ÄÖ·Ä¨·Äê·Äî·Ä∫·Ä∏·Ä°·Äõ·Äæ·Ää·Ä∫·ÄÄ·Äª·Äö·Ä∫·Ä°·Ä±·Ä¨·ÄÑ·Ä∫ */
  max-width: 380px;        /* ·Ä°·Äô·Äª·Ä¨·Ä∏·ÄÜ·ÄØ·Ä∂·Ä∏·Ä°·Äê·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏·Äû·Äê·Ä∫·Äô·Äæ·Äê·Ä∫ */
  line-height: 1.4em;      /* ·Äê·Äî·Ä∫·Ä∏·ÄÄ·Äº·Ä¨·Ä∏·Ä°·Äî·Ää·Ä∫·Ä∏·ÄÑ·Äö·Ä∫·Äï·Ä±·Ä∏ */
  display: -webkit-box;    
  -webkit-line-clamp: 2;   /* ·ÅÇ ·Äê·Äî·Ä∫·Ä∏·Äë·ÄÄ·Ä∫·Äô·Äï·Ä≠·ÄØ·ÄÖ·Ä± */
  -webkit-box-orient: vertical;
  overflow: hidden;        /* ·ÅÇ ·Äê·Äî·Ä∫·Ä∏·ÄÄ·Äª·Ä±·Ä¨·Ä∫·Äê·Ä¨·Äñ·Äº·Äê·Ä∫ */
  text-overflow: ellipsis; /* ·Äñ·Äº·Äê·Ä∫·Äú·Äª·Äæ·ÄÑ·Ä∫ ‚Ä¶ ·Äï·Äº */
  white-space: normal;     /* ·ÄÖ·Ä¨·Ä°·Äê·ÄΩ·ÄÑ·Ä∫·Ä∏ line break ·ÄÅ·ÄΩ·ÄÑ·Ä∑·Ä∫·Äï·Äº·ÄØ */
}

/* Arrow ·ÄÄ·Ä≠·ÄØ ·Äñ·Äö·Ä∫·Äõ·Äæ·Ä¨·Ä∏·Äë·Ä¨·Ä∏·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äï·Ä´·Äê·Äö·Ä∫ ·Ä°·Ä±·Ä¨·ÄÄ·Ä∫·Äô·Äæ·Ä¨·Äô·Äú·Ä≠·ÄØ·Äú·Äª·Äæ·ÄÑ·Ä∫ */
#chat-text::after {
  content: '';
  position: absolute;
  display: none; /* ·Äú·Ä≠·ÄØ·Äô·Äú·Ä≠·ÄØ·Ä°·Äï·Ä∫·Äô·Äæ·Ä∫·Ä¨·Äï·Ä±·Ä´·Ä∫·Äô·Äï·Äº */
}

#battle-screen {
  display: none;
  width: 100vw;
  height: 100vh;
  position: fixed;
  top: 0;
  left: 0;
  background-image: url('https://iili.io/KhFjP1V.gif');
  background-size: cover;        /* ‚úÖ ·Äï·ÄØ·Ä∂·Ä°·Äï·Äº·Ää·Ä∑·Ä∫·Ä°·Äî·ÄÄ·Ä∫·Ä°·Äï·Äº·Ää·Ä∑·Ä∫ */
  background-position: center;   /* ‚úÖ ·Ä°·Äú·Äö·Ä∫·Ä°·Äî·ÄÄ·Ä∫ */
  background-repeat: no-repeat;
  background-attachment: fixed;  /* ‚úÖ scroll ·Äô·Äñ·Äº·ÄÖ·Ä∫·Ä°·Ä±·Ä¨·ÄÑ·Ä∫ */
  z-index: 999;
  overflow: hidden;
}

/* Transparent Sidebar Menu Styles (Dark + Blue Version) */
.sidebar-menu {
  position: fixed; /* ·Ä°·Äì·Ä≠·ÄÄ·Äï·Äº·ÄÑ·Ä∫·Äû·ÄÑ·Ä∑·Ä∫·Äê·Ä≤·Ä∑·Äî·Ä±·Äõ·Ä¨ */
  top: 50%;
  right: 0;
  transform: translateY(-50%);
  display: flex;
  align-items: center;
  z-index: 100;
  transition: all 0.4s ease;
}

/* Sidebar Toggle (open button) */
.sidebar-toggle {
  width: 28px;
  height: 80px;
  background: rgba(20, 20, 20, 0.8);
  border: 1px solid rgba(0, 0, 0, 0.6);
  border-radius: 14px 0 0 14px;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 5px;
  padding: 0 5px;
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  transition: all 0.3s ease;
  box-shadow: -3px 3px 10px rgba(0, 0, 0, 0.6);
}

.sidebar-toggle:hover {
  background: rgba(35, 35, 35, 0.9);
  border-color: rgba(0, 0, 0, 0.8);
  width: 30px;
}

.sidebar-toggle span {
  width: 16px;
  height: 2px;
  background: rgba(255, 255, 255, 0.95);
  border-radius: 1px;
  transition: all 0.3s ease;
}

.sidebar-toggle.active {
  background: rgba(50, 50, 50, 0.9);
  border-color: rgba(0, 0, 0, 0.8);
}

.sidebar-toggle.active span:nth-child(1) {
  transform: rotate(45deg) translate(4px, 4px);
}
.sidebar-toggle.active span:nth-child(2) {
  opacity: 0;
}
.sidebar-toggle.active span:nth-child(3) {
  transform: rotate(-45deg) translate(4px, -4px);
}

/* Sidebar Buttons Container */
.sidebar-buttons {
  display: none;
  flex-direction: column;
  gap: 10px;
  background: linear-gradient(135deg, rgba(5,5,5,0.95), rgba(15,15,15,0.85));
  padding: 18px;
  border-radius: 18px 0 0 18px;
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid rgba(0, 0, 0, 0.6);
  margin-right: -8px;
  animation: slideIn 0.35s ease;
  box-shadow: -5px 5px 25px rgba(0,0,0,0.7);
}

.sidebar-buttons.show {
  display: flex;
}

/* Slide animation */
@keyframes slideIn {
  from { 
    opacity: 0;
    transform: translateX(25px);
  }
  to { 
    opacity: 1;
    transform: translateX(0);
  }
}

/* Sidebar Button */
.sidebar-btn {
  padding: 14px 22px;
  font-size: 15px;
  border: none;
  border-radius: 10px;
  background: linear-gradient(145deg, rgba(0,90,255,0.85), rgba(0,60,180,0.8));
  color: #fff;
  cursor: pointer;
  transition: all 0.3s ease;
  text-align: left;
  min-width: 150px;
  position: relative;
  overflow: hidden;
  border: 1px solid rgba(0, 100, 255, 0.4);
  box-shadow: 0 0 10px rgba(0, 100, 255, 0.3);
}

.sidebar-btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
  transition: left 0.5s ease;
}

.sidebar-btn:hover::before {
  left: 100%;
}

.sidebar-btn:hover {
  background: linear-gradient(145deg, rgba(0,100,255,0.95), rgba(0,70,200,0.9));
  transform: translateX(-5px);
  box-shadow: -2px 2px 20px rgba(0,120,255,0.5);
}

.sidebar-btn:active {
  background: rgba(0,80,200,0.9);
  transform: translateX(-3px);
}

.sidebar-btn:disabled {
  background: rgba(0,0,0,0.2);
  color: rgba(255,255,255,0.6);
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
  border-color: rgba(255,255,255,0.1);
}

.sidebar-btn:disabled:hover::before {
  left: -100%;
}

/* Responsive for mobile */
@media (max-width: 768px) {
  .sidebar-btn {
    min-width: 125px;
    padding: 11px 16px;
    font-size: 13px;
  }

  .sidebar-buttons {
    padding: 14px;
  }

  .sidebar-toggle {
    height: 65px;
    width: 25px;
  }
}

/* Rank System Styles - SLOWER ANIMATIONS (Full Updated) */
.rank-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
  max-width: 650px;
  margin: 0 auto;
  max-height: 75vh;
  overflow-y: auto;
  padding: 15px;
  position: relative;
  z-index: 1;
}

/* Scrollbar Design */
.rank-list::-webkit-scrollbar {
  width: 10px;
}
.rank-list::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.15);
  border-radius: 5px;
}
.rank-list::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.4);
  border-radius: 5px;
}
.rank-list::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.6);
}

.rank-item {
  background: rgba(255,255,255,0.18);
  backdrop-filter: blur(20px);
  padding: 18px;
  border-radius: 15px;
  display: flex;
  align-items: center;
  gap: 18px;
  transition: all 0.4s ease;
  border: 1.5px solid rgba(255,255,255,0.4);
  position: relative;
  z-index: 1;
  min-height: 85px;
}
.rank-item:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 25px rgba(0,0,0,0.4);
  background: rgba(255,255,255,0.25);
}

.rank-position {
  font-size: 22px;
  font-weight: bold;
  min-width: 50px;
  text-align: center;
  position: relative;
  text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
}

/* Glory Badges for Top 3 */
.rank-top-1 {
  background: linear-gradient(135deg, rgba(255,215,0,0.6), rgba(255,255,255,0.25));
  border: 3px solid gold;
  position: relative;
  overflow: hidden;
  padding: 20px;
  min-height: 90px;
  border-radius: 18px;
  animation: top1ColorGlow 4s infinite;
}
.rank-top-1::before {
  content: "";
  position: absolute;
  top: 0; left: -150%;
  width: 150%; height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,215,0,0.25), rgba(255,255,255,0.35), rgba(255,215,0,0.25), transparent);
  animation: slowShine 3s infinite;
  pointer-events: none;
}
.rank-top-1::after {
  content: "GLORY";
  position: absolute;
  top: 10px;
  right: 10px;
  font-size: 11px;
  color: gold;
  font-weight: 700;
  background: rgba(255,215,0,0.45);
  padding: 3px 8px;
  border-radius: 10px;
  animation: slowGloryPulse 3s infinite;
  border: 1px solid rgba(255,255,255,0.6);
  text-shadow: 0 0 6px rgba(255,215,0,0.45);
  pointer-events: none;
}

.rank-top-2 {
  background: linear-gradient(135deg, rgba(192,192,192,0.6), rgba(255,255,255,0.25));
  border: 3px solid silver;
  position: relative;
  overflow: hidden;
  padding: 20px;
  min-height: 90px;
  border-radius: 18px;
  animation: top2ColorGlow 4s infinite 1s;
}
.rank-top-2::before {
  content: "";
  position: absolute;
  top: 0; left: -150%;
  width: 150%; height: 100%;
  background: linear-gradient(90deg, transparent, rgba(192,192,192,0.25), rgba(255,255,255,0.35), rgba(192,192,192,0.25), transparent);
  animation: slowShine 3s infinite 1s;
  pointer-events: none;
}
.rank-top-2::after {
  content: "GLORY";
  position: absolute;
  top: 10px; right: 10px;
  font-size: 11px; color: silver;
  font-weight: 700;
  background: rgba(192,192,192,0.45);
  padding: 3px 8px;
  border-radius: 10px;
  animation: slowGloryPulse 3s infinite 1s;
  border: 1px solid rgba(255,255,255,0.6);
  text-shadow: 0 0 6px rgba(192,192,192,0.45);
  pointer-events: none;
}

.rank-top-3 {
  background: linear-gradient(135deg, rgba(205,127,50,0.6), rgba(255,255,255,0.25));
  border: 3px solid #cd7f32;
  position: relative;
  overflow: hidden;
  padding: 20px;
  min-height: 100px;
  border-radius: 18px;
  animation: top3ColorGlow 4s infinite 2s;
}
.rank-top-3::before {
  content: "";
  position: absolute;
  top: 0; left: -150%;
  width: 150%; height: 100%;
  background: linear-gradient(90deg, transparent, rgba(205,127,50,0.25), rgba(255,255,255,0.35), rgba(205,127,50,0.25), transparent);
  animation: slowShine 3s infinite 2s;
  pointer-events: none;
}
.rank-top-3::after {
  content: "GLORY";
  position: absolute;
  top: 10px; right: 10px;
  font-size: 11px;
  color: #cd7f32;
  font-weight: 700;
  background: rgba(205,127,50,0.45);
  padding: 3px 8px;
  border-radius: 10px;
  animation: slowGloryPulse 3s infinite 2s;
  border: 1px solid rgba(255,255,255,0.6);
  text-shadow: 0 0 6px rgba(205,127,50,0.45);
  pointer-events: none;
}

/* Animations */
@keyframes top1ColorGlow {
  0%,100%{box-shadow:0 0 15px rgba(255,215,0,0.3),inset 0 0 15px rgba(255,215,0,0.1);}
  50%{box-shadow:0 0 30px rgba(255,215,0,0.6),inset 0 0 25px rgba(255,215,0,0.2);}
}
@keyframes top2ColorGlow {
  0%,100%{box-shadow:0 0 12px rgba(192,192,192,0.3),inset 0 0 12px rgba(192,192,192,0.1);}
  50%{box-shadow:0 0 25px rgba(192,192,192,0.5),inset 0 0 20px rgba(192,192,192,0.2);}
}
@keyframes top3ColorGlow {
  0%,100%{box-shadow:0 0 12px rgba(205,127,50,0.3),inset 0 0 12px rgba(205,127,50,0.1);}
  50%{box-shadow:0 0 22px rgba(205,127,50,0.5),inset 0 0 18px rgba(205,127,50,0.2);}
}
@keyframes slowShine {
  0%{left:-150%;}
  100%{left:150%;}
}
@keyframes slowGloryPulse {
  0%,100%{transform:scale(1);opacity:0.9;}
  50%{transform:scale(1.04);opacity:1;}
}

/* Avatar Zone */
.rank-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  overflow: visible;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(255,255,255,0.35);
  border: 2px solid rgba(255,255,255,0.5);
  transition: all 0.5s ease;
  position: relative;
  z-index: 2;
}
.rank-avatar:hover {
  transform: scale(1.05);
  border-color: rgba(255,255,255,0.8);
  box-shadow: 0 0 10px rgba(255,255,255,0.4);
}
.rank-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 50%;
  position: relative;
  z-index: 3;
}
.rank-avatar .default-avatar {
  font-size: 18px;
  color: white;
  position: relative;
  z-index: 3;
}

.rank-avatar.frame-active::before {
  content: "" !important;
  position: absolute !important;
  top: -4px !important;       /* ·Äî·Ää·Ä∫·Ä∏·Äî·Ää·Ä∫·Ä∏·Ä°·Äï·Ä±·Ä´·Ä∫ */
  left: -6px !important;      /* ·Äî·Ää·Ä∫·Ä∏·Äî·Ää·Ä∫·Ä∏·Äò·Äö·Ä∫·Äò·ÄÄ·Ä∫·Äû·Ä≠·ÄØ·Ä∑·Äõ·ÄΩ·Äæ·Ä±·Ä∑ */
  width: 50px !important;     /* ·Äî·Ää·Ä∫·Ä∏·Äî·Ää·Ä∫·Ä∏·ÄÄ·Äº·ÄÆ·Ä∏ */
  height: 50px !important;    /* ·Äî·Ää·Ä∫·Ä∏·Äî·Ää·Ä∫·Ä∏·ÄÄ·Äº·ÄÆ·Ä∏ */
  background-image: var(--frame-url) !important;
  background-size: contain !important;
  background-repeat: no-repeat !important;
  background-position: center !important;
  z-index: 6 !important;
  pointer-events: none !important;
  border-radius: 50% !important;
  transform-origin: center !important;
  filter: drop-shadow(0 0 4px rgba(0,0,0,0.4)) !important;
  animation: none !important;    /* animation ·Äñ·Äª·ÄÄ·Ä∫ */
  transition: none !important;   /* hover/scale ·Äú·Äæ·ÄØ·Äï·Ä∫·Äõ·Äæ·Ä¨·Ä∏·Äô·Äæ·ÄØ ·Äñ·Äª·ÄÄ·Ä∫ */
}

/* Frame Image Sets */
.rank-avatar.frame-1::before { background-image: url('https://i.ibb.co/QV84J2p/Grid-Art-20251021-174653561.png') !important; }
.rank-avatar.frame-2::before { background-image: url('https://i.ibb.co/WvbrkX5Q/Grid-Art-20251021-174724409.png') !important; }
.rank-avatar.frame-3::before { background-image: url('https://i.ibb.co/4gmzsRv1/Grid-Art-20251021-185346595.png') !important; }
.rank-avatar.frame-4::before { background-image: url('https://i.ibb.co/tTHqDxgL/Grid-Art-20251021-185427346.png') !important; }
.rank-avatar.frame-5::before { background-image: url('https://i.ibb.co/b5yDXZ3X/Grid-Art-20251021-191526385.png') !important; }
.rank-avatar.frame-6::before { background-image: url('https://i.ibb.co/fdDyXb4f/Grid-Art-20251021-191206825.png') !important; }
/* NEW FRAMES */
.rank-avatar.frame-7::before { background-image: url('https://i.ibb.co/WvhQNXV0/Grid-Art-20251022-203314542.png') !important; }
.rank-avatar.frame-8::before { background-image: url('https://i.ibb.co/YFPQqWLT/Grid-Art-20251022-203053097.png') !important; }
.rank-avatar.frame-9::before { background-image: url('https://i.ibb.co/CKHjc9Yv/Grid-Art-20251022-203131283.png') !important; }
.rank-avatar.frame-10::before { background-image: url('https://i.ibb.co/3YPVPzBQ/Grid-Art-20251022-203203551.png') !important; }
.rank-avatar.frame-11::before { background-image: url('https://i.ibb.co/5xf2gynX/Grid-Art-20251022-203239723.png') !important; }
.rank-avatar.frame-12::before { background-image: url('https://i.ibb.co/bRBtyRZz/Grid-Art-20251022-202649925.png') !important; }
.rank-avatar.frame-13::before { background-image: url('https://i.ibb.co/LwVZZ8k/Grid-Art-20251022-202724485.png') !important; }
.rank-avatar.frame-14::before { background-image: url('https://i.ibb.co/dwKFfgZP/bceab2c603a6123d4e7f8c3189cdb77f.gif') !important; }
/* NEW FRAMES (·Ä°·Äû·ÄÖ·Ä∫) */
.rank-avatar.frame-15::before { background-image: url('https://i.ibb.co/7tbQSvR5/Grid-Art-20251023-110346131.png') !important; }
.rank-avatar.frame-16::before { background-image: url('https://i.ibb.co/TByr3SP5/Grid-Art-20251023-110424499.png') !important; }
.rank-avatar.frame-17::before { background-image: url('https://i.ibb.co/yc8Y4Qsp/Grid-Art-20251023-110503741.png') !important; }
.rank-avatar.frame-18::before { background-image: url('https://i.ibb.co/7dyyNNWC/Grid-Art-20251023-110615606.png') !important; }
.rank-avatar.frame-19::before { background-image: url('https://i.ibb.co/Gfcnkmsf/Grid-Art-20251023-110704674.png') !important; }
.rank-avatar.frame-20::before { background-image: url('https://i.ibb.co/gFtR2ctd/Grid-Art-20251023-123518546.png') !important; }
.rank-avatar.frame-21::before { background-image: url('https://i.ibb.co/hxkQX8gr/Grid-Art-20251023-123550710.png') !important; }
.rank-avatar.frame-22::before { background-image: url('https://i.ibb.co/7JcHyRmC/Grid-Art-20251023-123620592.png') !important; }
.rank-avatar.frame-23::before { background-image: url('https://i.ibb.co/tp6K9jtJ/Grid-Art-20251023-123654397.png') !important; }
.rank-avatar.frame-24::before { background-image: url('https://i.ibb.co/jkFL2LVM/Grid-Art-20251023-123726543.png') !important; }
.rank-avatar.frame-25::before { background-image: url('https://i.ibb.co/N2sMqPZB/Grid-Art-20251023-123800635.png') !important; }
.rank-avatar.frame-26::before { background-image: url('https://i.ibb.co/HLNH2K6B/Grid-Art-20251023-123846894.png') !important; }
.rank-avatar.frame-27::before { background-image: url('https://i.ibb.co/F4Pmw0g4/Grid-Art-20251023-123923903.png') !important; }


/* Text + Info */
.rank-details { flex: 1; }
.rank-name {
  font-weight: bold;
  margin-bottom: 8px;
  font-size: 16px;
  color: white;
  text-shadow: 2px 2px 6px rgba(0,0,0,0.9);
}
.rank-coins {
  font-size: 14px;
  color: gold;
  font-weight: bold;
  text-shadow: 1px 1px 4px rgba(0,0,0,0.8);
  margin-bottom: 4px;
}
.rank-id {
  font-size: 11px;
  opacity: 0.9;
  color: #ddd;
  font-style: italic;
}

/* Current User */
.current-user-rank {
  background: rgba(0, 100, 255, 0.5);
  border: 3px solid rgba(0, 150, 255, 0.9);
  box-shadow: 0 0 25px rgba(0, 100, 255, 0.5),
              inset 0 0 15px rgba(0, 100, 255, 0.2);
  padding: 20px;
  min-height: 90px;
  border-radius: 18px;
  animation: slowCurrentUserGlow 5s infinite;
}
@keyframes slowCurrentUserGlow {
  0%,100%{box-shadow:0 0 15px rgba(0,100,255,0.3),inset 0 0 10px rgba(0,100,255,0.1);}
  50%{box-shadow:0 0 30px rgba(0,100,255,0.7),inset 0 0 20px rgba(0,100,255,0.3);}
}

/* Header */
.rank-header {
  text-align: center;
  margin-bottom: 25px;
  padding-top: 25px;
}
.rank-header h2 {
  font-size: 32px;
  margin-bottom: 12px;
  color: white;
  background: linear-gradient(45deg, #ffffff, #ffd700);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  animation: slowTitleGlow 6s infinite;
}
@keyframes slowTitleGlow {
  0%,100%{text-shadow:3px 3px 8px rgba(0,0,0,0.9);}
  50%{text-shadow:3px 3px 15px rgba(255,215,0,0.5),0 0 20px rgba(255,255,255,0.3);}
}
.rank-header p {
  font-size: 16px;
  opacity: 0.95;
  color: #eee;
}

/* Tabs */
.rank-tabs {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin: 25px 0;
}
.rank-tab-btn {
  padding: 12px 24px;
  border-radius: 10px;
  background: rgba(255,255,255,0.25);
  color: white;
  cursor: pointer;
  font-size: 16px;
  transition: all 0.6s ease;
  backdrop-filter: blur(15px);
  border: 2px solid rgba(255,255,255,0.4);
  font-weight: bold;
}
.rank-tab-btn.active {
  background: linear-gradient(45deg,#007bff,#0056b3) !important;
  transform: translateY(-2px);
  box-shadow: 0 6px 15px rgba(0,123,255,0.6);
  border: 2px solid rgba(255,255,255,0.8);
  animation: slowTabGlow 4s infinite;
}
@keyframes slowTabGlow {
  0%,100%{box-shadow:0 6px 15px rgba(0,123,255,0.6);}
  50%{box-shadow:0 6px 25px rgba(0,123,255,0.8);}
}

/* Back Button */
#back-rank {
  position: fixed;
  top: 25px;
  left: 25px;
  z-index: 1001;
  background: rgba(0, 123, 255, 0.9);
  border: 2px solid rgba(255,255,255,0.5);
  padding: 10px 18px;
  font-size: 15px;
  border-radius: 10px;
  transition: all 0.5s ease;
}
#back-rank:hover {
  background: rgba(0, 123, 255, 1);
  transform: scale(1.05);
  box-shadow: 0 0 15px rgba(0,123,255,0.5);
}

/* Responsive */
@media (max-width:768px){
  .rank-list{max-width:95%;padding:10px;gap:10px;}
  .rank-item{padding:15px;gap:15px;min-height:80px;}
  .rank-avatar{width:45px;height:45px;}
  .rank-position{font-size:20px;min-width:45px;}
  .rank-name{font-size:15px;}
  .rank-coins{font-size:13px;}
  .rank-header h2{font-size:28px;}
}
/* Back Button Styling for Rank Screen */
#back-rank {
  position: fixed;
  top: 20px;
  left: 20px;
  z-index: 1001;
  background: rgba(0, 123, 255, 0.8);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255,255,255,0.3);
}
/* Halloween Screen Styles */
#halloween-screen {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background-image: url('https://iili.io/K88KWas.jpg');
  background-size: cover;
  background-position: center;
  z-index: 1000;
  display: none;
  overflow-y: auto;
  color: white;
  padding: 20px;
}

#open-halloween-btn {
  background: linear-gradient(145deg, #ff6b00, #ff8c00);
  color: white;
  border: none;
  padding: 12px 24px;
  font-size: 16px;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(255, 107, 0, 0.4);
}

#open-halloween-btn:hover:not(:disabled) {
  transform: translateY(-2px);
  box-shadow: 0 6px 18px rgba(255, 107, 0, 0.6);
}

#open-halloween-btn:disabled {
  background: #6c757d;
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}

#level-up-btn {
  background: linear-gradient(145deg, #8a2be2, #9370db);
  color: white;
  border: none;
  padding: 10px 20px;
  font-size: 14px;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(138, 43, 226, 0.4);
}

#level-up-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 18px rgba(138, 43, 226, 0.6);
}

#halloween-status {
  background: rgba(0, 0, 0, 0.7);
  padding: 12px 16px;
  border-radius: 8px;
  font-size: 14px;
  text-align: center;
  max-width: 300px;
  margin: 20px auto 0;
  line-height: 1.4;
}

#level-up-cost {
  background: rgba(0, 0, 0, 0.5);
  padding: 8px 12px;
  border-radius: 6px;
  font-size: 12px;
  text-align: center;
  max-width: 250px;
  margin: 10px auto 0;
}

/* Game Mode Card Styles - Android Optimized */
.mode-card {
  transition: all 0.3s ease;
}

.mode-card:active {
  transform: scale(0.95);
  opacity: 0.8;
}

#start-game-btn:active {
  transform: scale(0.95);
  background: rgba(255, 140, 0, 0.6) !important;
}

/* Pumpkin Game Styles - Android Optimized */
.pumpkin-item {
  position: absolute;
  width: 65px;
  height: 65px;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  cursor: pointer;
  transition: transform 0.1s ease;
  z-index: 5;
  animation: float 2s ease-in-out infinite;
  touch-action: manipulation;
}

.pumpkin-item:active {
  transform: scale(1.2);
}

.tnt-item {
  position: absolute;
  width: 65px;
  height: 65px;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  cursor: pointer;
  transition: transform 0.1s ease;
  z-index: 5;
  animation: shake 0.5s ease-in-out infinite;
  touch-action: manipulation;
}

.tnt-item:active {
  transform: scale(1.2);
}

/* Loading Circle for Pumpkin Items Only */
.pumpkin-loading {
  position: absolute;
  width: 65px;
  height: 65px;
  background: rgba(0, 100, 255, 0.3);
  border-radius: 50%;
  border: 3px solid #007bff;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 4;
  animation: pulse 1s ease-in-out infinite;
}

.tnt-loading {
  position: absolute;
  width: 65px;
  height: 65px;
  background: rgba(255, 0, 0, 0.1);
  border-radius: 50%;
  border: 3px solid rgba(255, 0, 0, 0.3);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 4;
}

@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-8px); }
}

@keyframes shake {
  0%, 100% { transform: rotate(0); }
  25% { transform: rotate(-3deg); }
  75% { transform: rotate(3deg); }
}

@keyframes pulse {
  0%, 100% { opacity: 0.7; transform: scale(1); }
  50% { opacity: 1; transform: scale(1.05); }
}

/* Countdown Animation */
@keyframes countdownPop {
  0% { transform: scale(0.5); opacity: 0; }
  50% { transform: scale(1.2); opacity: 1; }
  100% { transform: scale(1); opacity: 1; }
}

.countdown-pop {
  animation: countdownPop 0.5s ease-out;
}

/* Mobile Responsive */
@media (max-width: 480px) {
  .pumpkin-item, .tnt-item, .pumpkin-loading, .tnt-loading {
    width: 55px;
    height: 55px;
  }
  
  #countdown-number {
    font-size: 60px;
  }
}
</style>
</head>
<body>
<!-- ===== NEW LOGIN SCREEN ===== -->
<div id="login-screen" style="display: none;">
  <div class="login-container">
    <!-- Profile Picture -->
    <div class="profile-picture">
      <img id="profile-pic-preview" src="" style="display: none;">
      <div class="default-avatar" id="default-avatar">üë§</div>
    </div>
    
    <!-- Name Input -->
    <input type="text" id="user-name" class="login-input" placeholder="·Äû·ÄÑ·Ä∑·Ä∫·Äî·Ä¨·Äô·Ää·Ä∫·Äë·Ää·Ä∑·Ä∫·Äï·Ä´" maxlength="20">
    
    <!-- Profile Picture Upload -->
    <input type="file" id="profile-pic-upload" accept="image/*" style="display: none;">
    <button class="login-btn secondary-btn" onclick="document.getElementById('profile-pic-upload').click()">
      Profile ·Äï·ÄØ·Ä∂·Äõ·ÄΩ·Ä±·Ä∏·ÄÅ·Äª·Äö·Ä∫·Äõ·Äî·Ä∫
    </button>
    
    <!-- Create Account Button -->
    <button class="login-btn" id="create-account-btn">
      ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äñ·ÄΩ·ÄÑ·Ä∑·Ä∫·Äô·Ää·Ä∫
    </button>
    
    <p class="login-note">·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äñ·ÄΩ·ÄÑ·Ä∑·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äô·Äæ Event ·ÄÄ·Ä≠·ÄØ·Äù·ÄÑ·Ä∫·Äõ·Ä±·Ä¨·ÄÄ·Ä∫·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äô·Ää·Ä∫</p>
  </div>
</div>

<!-- User Profile Display (will be shown after login) -->
<div class="user-profile" id="user-profile" style="display: none;">
  <img class="user-avatar" id="user-avatar" src="">
  <span id="user-display-name"></span>

</div>

<!-- Splash Screen -->
<div id="splash-screen">
  <div class="loading-circle"></div>
  <div class="countdown-text" id="countdown-text">Loading...</div>
  <button class="enter-btn" id="enter-btn" style="display:none;">·ÅÄ·ÄÑ·Ä∫·Äõ·Ä±·Ä¨·ÄÄ·Ä∫·Äô·Ää·Ä∫</button>
</div>


<!-- Main Screen ·Äë·Ä≤·Äô·Äæ·Ä¨ ·Äí·ÄÆ·Äú·Ä≠·ÄØ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´ -->
<div id="main-screen">
  <!-- Profile Circle (·Ä°·Äï·Ä±·Ä´·Ä∫·Ää·Ä¨·Äò·ÄÄ·Ä∫) -->
  <div class="profile-circle" id="profile-circle">
    <img id="profile-circle-img" src="" style="display: none;">
    <div class="default-avatar" id="profile-circle-default">üë§</div>
  </div>


<div class="token-card">
    <img src="https://iili.io/KVxjsG1.png" alt="Token">
    <div class="count" id="token-count">0</div>
    <img src="https://i.ibb.co/yBQgnMKz/Grid-Art-20251012-184528037.png" alt="Coin">
    <div class="count" id="coin-count">0</div>
    <!-- Crystal stone with 0 -->
    <img src="https://iili.io/KvbIfKg.png" alt="Crystal" class="crystal">
    <div class="count">0</div>
</div>

  <!-- Modern Sidebar Menu -->
  <div class="sidebar-menu">
    <button class="sidebar-toggle" id="sidebar-toggle">
      <span></span>
      <span></span>
      <span></span>
    </button>
    <div class="sidebar-buttons" id="sidebar-buttons">
      <button class="sidebar-btn" id="event-btn">
        <span>Event ·Äû·Ä≠·ÄØ·Ä∑</span>
      </button>
      <button class="sidebar-btn" id="task-btn">
        <span>Task ·Äô·Äª·Ä¨·Ä∏</span>
      </button>
      <button class="sidebar-btn" id="exchange-btn">
        <span>·Äú·Ä≤·Äô·Ää·Ä∫</span>
      </button>
      <button class="sidebar-btn" id="battle-btn">
        <span>Token Box</span>
      </button>
      <button class="sidebar-btn" id="halloween-btn">
  <span>Halloween Box</span>
</button>
      <!-- Add this Winner button after the Rank button in the sidebar -->
<button class="sidebar-btn" id="winner-btn">
  <span>·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äë·Ä¨·Ä∏·Äû·Ä∞·Äô·Äª·Ä¨·Ä∏</span>
</button>
  <button class="sidebar-btn" id="game-mode-btn">
    <span>·ÄÄ·Äº·Ä±·Ä∏·ÄÖ·Ä¨·Ä∏·ÄÇ·Ä≠·Äô·Ä∫·Ä∏</span>
  </button>
    </div>
  </div>
</div>


<!-- üéµ Background Music -->
<audio id="bg-music" loop>
  <source src="Halloween_Waltz__Ìï†Î°úÏúà_ÏôàÏ∏†_(256k).mp3" type="audio/mpeg">
</audio>


<!-- Floating Chat Image (Left Bottom) -->
<div id="chat-container">
  <div id="chat-text"></div>
  <img id="chat-icon" src="https://i.ibb.co/svpY1Hfs/Grid-Art-20251017-100826774.png" alt="Chat Icon">
</div>

<!-- Add this Winner screen HTML after the Rank screen -->
<div id="winner-screen" style="display: none; width: 100vw; height: 100vh; background-image: url('https://i.ibb.co/YFCTVMbf/06b058bd50bfe9123427d47145d7aea4.jpg'); background-size: cover; background-position: center; background-repeat: no-repeat; position: fixed; top: 0; left: 0; z-index: 1000; overflow-y: auto; color: white; padding: 20px;">
  <button class="back-btn" id="back-winner">Home</button>
  
  <div class="winner-header" style="text-align: center; margin-bottom: 20px; padding-top: 20px;">
    <h2 style="font-size: 28px; margin-bottom: 10px; text-shadow: 0 2px 4px rgba(0,0,0,0.5);">·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äû·Ä∞·Äô·Äª·Ä¨·Ä∏ </h2>
    <p style="font-size: 14px; opacity: 0.8;">Gift </p>
  </div>
  
  <div class="winner-list" style="display: flex; flex-direction: column; gap: 10px; max-width: 600px; margin: 0 auto; max-height: 70vh; overflow-y: auto; padding: 10px; position: relative; z-index: 1;">
    
    <!-- Winner 1 -->
    <div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
      <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
        <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
      </div>
      <div class="rank-details" style="flex: 1;">
        <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
          16245
        </div>
        <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
          1491861***
        </div>
        <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
          5 Diamonds ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
        </div>
      </div>
    </div>

    <!-- Winner 2 -->
    <div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
      <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
        <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
      </div>
      <div class="rank-details" style="flex: 1;">
        <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
          16454
        </div>
        <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
          1539019***
        </div>
        <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
          5 Diamonds ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
        </div>
      </div>
    </div>

    <!-- Winner 3 -->
    <div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
      <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
        <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
      </div>
      <div class="rank-details" style="flex: 1;">
        <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
          5334
        </div>
        <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
          1069567***
        </div>
        <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
          5 Diamonds ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
        </div>
      </div>
    </div>

    <!-- Winner 4 -->
    <div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
      <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
        <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
      </div>
      <div class="rank-details" style="flex: 1;">
        <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
          13894
        </div>
        <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
          1201928***
        </div>
        <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
          5 Diamonds ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
        </div>
      </div>
    </div>

    <!-- Winner 5 -->
    <div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
      <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
        <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
      </div>
      <div class="rank-details" style="flex: 1;">
        <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
          16059
        </div>
        <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
          1452801***
        </div>
        <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
          5 Diamonds ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
        </div>
      </div>
    </div>

    <!-- Winner 6 -->
    <div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
      <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
        <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
      </div>
      <div class="rank-details" style="flex: 1;">
        <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
          19290
        </div>
        <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
          1971809***
        </div>
        <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
          5 Diamonds ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
        </div>
      </div>
    </div>

    <!-- Winner 7 -->
    <div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
      <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
        <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
      </div>
      <div class="rank-details" style="flex: 1;">
        <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
          15028
        </div>
        <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
          1240136***
        </div>
        <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
          5 Diamonds ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
        </div>
      </div>
    </div>

    <!-- Winner 8 -->
    <div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
      <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
        <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
      </div>
      <div class="rank-details" style="flex: 1;">
        <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
          16908
        </div>
        <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
          1629514***
        </div>
        <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
          5 Diamonds ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
        </div>
      </div>
    </div>

    <!-- Winner 9 -->
    <div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
      <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
        <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
      </div>
      <div class="rank-details" style="flex: 1;">
        <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
          16842
        </div>
        <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
          1621884***
        </div>
        <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
          5 Diamonds ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
        </div>
      </div>
    </div>

    <!-- Winner 10 -->
    <div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
      <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
        <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
      </div>
      <div class="rank-details" style="flex: 1;">
        <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
          15908
        </div>
        <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
          1420839***
        </div>
        <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
          5 Diamonds ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
        </div>
      </div>
    </div>

<!-- Winner 11 -->
<div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
  <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
    <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
  </div>
  <div class="rank-details" style="flex: 1;">
    <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
      18708
    </div>
    <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      1808149***
    </div>
    <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      5 Diamonds ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
    </div>
  </div>
</div>

<!-- Winner 12 -->
<div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
  <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
    <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
  </div>
  <div class="rank-details" style="flex: 1;">
    <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
      19290
    </div>
    <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      1971809***
    </div>
    <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      5 Diamonds ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
    </div>
  </div>
</div>

<!-- Winner 13 -->
<div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
  <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
    <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
  </div>
  <div class="rank-details" style="flex: 1;">
    <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
      16233
    </div>
    <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      1492316***
    </div>
    <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      5 Diamonds ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
    </div>
  </div>
</div>

<!-- Add this after the existing winner items in the winner-screen div -->

<!-- Winner 14 -->
<div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
  <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
    <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
  </div>
  <div class="rank-details" style="flex: 1;">
    <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
      8679
    </div>
    <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      673689***
    </div>
    <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      11 Diamonds ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
    </div>
  </div>
</div>

<!-- Winner 15 -->
<div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
  <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
    <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
  </div>
  <div class="rank-details" style="flex: 1;">
    <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
      19290
    </div>
    <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      1971809***
    </div>
    <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      5 Diamonds ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
    </div>
  </div>
</div>

<!-- Winner 16 -->
<div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
  <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
    <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
  </div>
  <div class="rank-details" style="flex: 1;">
    <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
      19062
    </div>
    <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      1907799***
    </div>
    <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      5 Diamonds ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
    </div>
  </div>
</div>

<!-- Winner 17 -->
<div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
  <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
    <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
  </div>
  <div class="rank-details" style="flex: 1;">
    <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
      13487
    </div>
    <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      1115381***
    </div>
    <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      5 Diamonds ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
    </div>
  </div>
</div>

<!-- Winner 18 -->
<div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
  <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
    <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
  </div>
  <div class="rank-details" style="flex: 1;">
    <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
      18695
    </div>
    <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      1804509***
    </div>
    <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      11 Diamonds ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
    </div>
  </div>
</div>

<!-- Winner 19 -->
<div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
  <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
    <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
  </div>
  <div class="rank-details" style="flex: 1;">
    <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
      18896
    </div>
    <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      1844237***
    </div>
    <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      11 Diamonds ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
    </div>
  </div>
</div>

<!-- Winner 20 -->
<div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
  <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
    <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
  </div>
  <div class="rank-details" style="flex: 1;">
    <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
      16842
    </div>
    <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      1621884***
    </div>
    <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      5 Diamonds ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
    </div>
  </div>
</div>

<!-- Winner 21 -->
<div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
  <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
    <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
  </div>
  <div class="rank-details" style="flex: 1;">
    <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
      19241
    </div>
    <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      1953223***
    </div>
    <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      5 Diamond ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
    </div>
  </div>
</div>

<!-- Winner 22 -->
<div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
  <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
    <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
  </div>
  <div class="rank-details" style="flex: 1;">
    <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
      16066
    </div>
    <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      1450688***
    </div>
    <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      5 Diamond ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
    </div>
  </div>
</div>

<!-- Winner 23 -->
<div class="rank-item" style="background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.2); position: relative; z-index: 1; min-height: 70px;">
  <div class="rank-avatar" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);">
    <div class="default-avatar" style="font-size: 18px; color: white;">üíé</div>
  </div>
  <div class="rank-details" style="flex: 1;">
    <div class="server-id" style="font-size: 11px; color: #90ee90; margin-bottom: 2px; font-weight: bold;">
      19298
    </div>
    <div class="rank-name" style="font-weight: bold; margin-bottom: 5px; font-size: 14px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      1971868***
    </div>
    <div class="rank-coins" style="font-size: 12px; color: gold; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">
      11 Diamond ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∫ 
    </div>
  </div>
</div>

</div>
</div>
  


<!-- Add this Halloween Screen after the existing screens -->
<div id="halloween-screen" style="display: none; width: 100vw; height: 100vh; background-image: url('https://iili.io/K88KWas.jpg'); background-size: cover; background-position: center; position: fixed; top: 0; left: 0; z-index: 1000; overflow-y: auto; color: white; padding: 15px;">
  <button class="back-btn" id="back-halloween" style="padding: 6px 12px; font-size: 12px;">Home</button>
  
  <div style="display: flex; flex-direction: column; height: 100%;">
    <!-- Box Level Display (Top) -->
    <div id="box-level-display" style="margin-top: 40px; background: rgba(0,0,0,0.7); padding: 5px 12px; border-radius: 12px; display: inline-block; font-size: 12px; color: #ffcc00; border: 1px solid #ffcc00; align-self: center;">
      Level ·Äê·ÄÑ·Ä∫·Äú·Ä±·Äô·Äª·Ä¨·Ä∏·Äô·Äª·Ä¨·Ä∏·Äõ·Äú·Ä±  <span id="current-level"></span>
    </div>
    
    <!-- Halloween Box (Moved Down) -->
    <div id="halloween-box-image" style="position: relative; width: 260px; height: 260px; margin: 80px auto 40px auto;">
      <!-- Box image will be set by JavaScript based on level -->
    </div>
    
    <!-- Bottom Section -->
    <div style="margin-bottom: 30px; margin-top: auto;">
      <!-- Buttons Container - One Row Two Columns -->
      <div style="display: flex; justify-content: center; gap: 8px; margin-bottom: 10px;">
        <!-- Share Button -->
        <button id="open-halloween-btn" class="btn" style="padding: 6px 12px; font-size: 12px; border-radius: 6px; background: #ff6b00; color: white; border: none; cursor: pointer; min-width: 100px; flex: 1;">
          ·Äñ·Ä±·Ä¨·ÄÄ·Ä∫·Äô·Ää·Ä∫
        </button>
        
        <!-- Level Up Button -->
        <button id="level-up-btn" class="btn" style="padding: 6px 12px; font-size: 12px; border-radius: 6px; background: #8a2be2; color: white; border: none; cursor: pointer; min-width: 100px; flex: 1;">
          Level ·Äê·ÄÑ·Ä∫·Äô·Ää·Ä∫
        </button>
      </div>
      
      <!-- Status Display -->
      <div id="halloween-status" style="text-align: center; color: white; font-size: 11px; background: rgba(0,0,0,0.7); padding: 6px 10px; border-radius: 6px; max-width: 280px; margin: 0 auto 8px;">
        Loading...
      </div>
      
      <!-- Level Up Cost Display -->
      <div id="level-up-cost" style="text-align: center; color: #ffcc00; font-size: 10px; background: rgba(0,0,0,0.5); padding: 5px 8px; border-radius: 5px; max-width: 240px; margin: 0 auto;">
        <!-- Will be populated by JavaScript -->
      </div>
    </div>
  </div>
</div>
<!-- Rank Screen -->
<div id="rank-screen" style="display: none; width: 100vw; height: 100vh; background-image: url('https://iili.io/KOZNH0J.jpg'); background-size: cover; background-position: center; background-repeat: no-repeat; position: fixed; top: 0; left: 0; z-index: 1000; overflow-y: auto; color: white; padding: 20px;">
  <button class="back-btn" id="back-rank">Home</button>
  
  <div class="rank-header" style="text-align: center; margin-bottom: 20px; padding-top: 20px;">
    <h2 style="font-size: 28px; margin-bottom: 10px; text-shadow: 0 2px 4px rgba(0,0,0,0.5);">Rank </h2>
    <p style="font-size: 14px; opacity: 0.8;">TOP Users</p>
    
    <!-- Ranking Type Buttons -->
    <div class="rank-tabs" style="display: flex; justify-content: center; gap: 15px; margin: 20px 0;">
      <button class="rank-tab-btn active" id="coins-rank-btn" style="padding: 10px 20px; border: none; border-radius: 8px; background: #007bff; color: white; cursor: pointer; font-size: 14px; transition: all 0.3s ease;">
        Coins Rank
      </button>
      <button class="rank-tab-btn" id="tokens-rank-btn" style="padding: 10px 20px; border: none; border-radius: 8px; background: rgba(255,255,255,0.2); color: white; cursor: pointer; font-size: 14px; transition: all 0.3s ease;">
        Token Rank
      </button>
    </div>
  </div>
  
  <div class="rank-list" id="rank-list" style="display: flex; flex-direction: column; gap: 10px; max-width: 600px; margin: 0 auto;">
    <!-- Rankings will be loaded here -->
  </div>
</div>



<!-- Account Screen (Profile Circle ·Äî·Äæ·Ä≠·Äï·Ä∫·Äô·Äæ·Äï·Ä±·Ä´·Ä∫·Äô·Äö·Ä∫) -->
<div id="account-screen">
  <button class="close-account-btn" id="close-account-btn">‚úï</button>
  
  <div class="account-container">
    <div class="account-header">
      <div class="account-avatar">
        <img id="account-avatar-img" src="" style="display: none;">
        <div class="default-avatar" id="account-avatar-default">üë§</div>
      </div>
      <div class="account-name" id="account-name-display"></div>
      <div class="account-id" id="account-id-display"></div>
    </div>
    
<!-- Account Screen ·Äë·Ä≤·ÄÄ account-stats section ·ÄÄ·Ä≠·ÄØ update ·Äú·ÄØ·Äï·Ä∫·Äï·Ä´ -->
<div class="account-stats">
  <div class="stat-item">
    <div class="stat-value" id="account-tokens">0</div>
    <div class="stat-label">Token Cards</div>
  </div>
  <div class="stat-item">
    <div class="stat-value" id="account-coins">0</div>
    <div class="stat-label">Coins</div>
  </div>
  </div>
    
<!-- Account Screen ·Äë·Ä≤·ÄÄ account-actions section ·ÄÄ·Ä≠·ÄØ update ·Äú·ÄØ·Äï·Ä∫·Äï·Ä´ -->
<div class="account-actions">
  <button class="account-btn edit-profile-btn" id="edit-profile-btn">Edit Profile</button>
  <button class="account-btn edit-frame-btn" id="edit-frame-btn">Edit Frame</button>
</div>

<!-- Frame Selection Screen - ANDROID OPTIMIZED -->
<div id="frame-screen" style="display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d); z-index: 1001; color: white; padding: 0; overflow-y: auto;">
  
  <!-- Header -->
  <div style="background: rgba(0,0,0,0.7); padding: 15px 20px; border-bottom: 1px solid rgba(255,255,255,0.2); position: sticky; top: 0; z-index: 10;">
    <div style="display: flex; align-items: center; justify-content: space-between;">
      <button class="back-btn" id="close-frame-btn" style="padding: 10px 16px; font-size: 14px; border: none; border-radius: 8px; background: #007bff; color: white; cursor: pointer; display: flex; align-items: center; min-width: 80px;">
         Back
      </button>
      <div style="text-align: center; flex: 1; margin: 0 15px;">
        <h2 style="font-size: 18px; margin: 0; font-weight: bold;"></h2>
        <p style="font-size: 12px; margin: 3px 0 0 0; opacity: 0.8;"></p>
      </div>
      <div style="min-width: 80px;"></div> <!-- Spacer for balance -->
    </div>
  </div>

  <!-- Main Content -->
  <div style="padding: 20px 15px; max-width: 500px; margin: 0 auto;">

    <!-- Frame Selection Grid - Responsive 3 Columns -->
    <div style="margin-bottom: 25px;">
      <div class="frame-grid" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; justify-items: center;">
        
        <!-- Frame 1 - 100 Crystals -->
        <div class="frame-item" data-frame="1" data-cost="100" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
          <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
            <img src="https://i.ibb.co/QV84J2p/Grid-Art-20251021-174653561.png" alt="Frame 1" style="width: 100%; height: 100%; object-fit: contain;">
          </div>
          <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 1</div>
          <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
            <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
            <span>100</span>
          </div>
          <button class="frame-action-btn" data-frame="1" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
            ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
          </button>
        </div>
        
        <!-- Frame 2 - 100 Crystals -->
        <div class="frame-item" data-frame="2" data-cost="100" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
          <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
            <img src="https://i.ibb.co/WvbrkX5Q/Grid-Art-20251021-174724409.png" alt="Frame 2" style="width: 100%; height: 100%; object-fit: contain;">
          </div>
          <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 2</div>
          <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
            <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
            <span>100</span>
          </div>
          <button class="frame-action-btn" data-frame="2" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
            ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
          </button>
        </div>
        
        <!-- Frame 3 - 200 Crystals -->
        <div class="frame-item" data-frame="3" data-cost="200" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
          <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
            <img src="https://i.ibb.co/4gmzsRv1/Grid-Art-20251021-185346595.png" alt="Frame 3" style="width: 100%; height: 100%; object-fit: contain;">
          </div>
          <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 3</div>
          <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
            <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
            <span>200</span>
          </div>
          <button class="frame-action-btn" data-frame="3" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
            ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
          </button>
        </div>
        
        <!-- Frame 4 - 200 Crystals -->
        <div class="frame-item" data-frame="4" data-cost="200" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
          <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
            <img src="https://i.ibb.co/tTHqDxgL/Grid-Art-20251021-185427346.png" alt="Frame 4" style="width: 100%; height: 100%; object-fit: contain;">
          </div>
          <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 4</div>
          <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
            <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
            <span>200</span>
          </div>
          <button class="frame-action-btn" data-frame="4" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
            ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
          </button>
        </div>

        <!-- Frame 5 - 200 Crystals -->
        <div class="frame-item" data-frame="5" data-cost="200" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
          <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
            <img src="https://i.ibb.co/b5yDXZ3X/Grid-Art-20251021-191526385.png" alt="Frame 5" style="width: 100%; height: 100%; object-fit: contain;">
          </div>
          <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 5</div>
          <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
            <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
            <span>200</span>
          </div>
          <button class="frame-action-btn" data-frame="5" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
            ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
          </button>
        </div>

        <!-- Frame 6 - 300 Crystals -->
        <div class="frame-item" data-frame="6" data-cost="300" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
          <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
            <img src="https://i.ibb.co/fdDyXb4f/Grid-Art-20251021-191206825.png" alt="Frame 6" style="width: 100%; height: 100%; object-fit: contain;">
          </div>
          <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 6</div>
          <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
            <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
            <span>300</span>
          </div>
          <button class="frame-action-btn" data-frame="6" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
            ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
          </button>
        </div>
        
        <!-- Frame 7 - Free -->
<div class="frame-item" data-frame="7" data-cost="0" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
  <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
    <img src="https://i.ibb.co/WvhQNXV0/Grid-Art-20251022-203314542.png" alt="Frame 7" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 7</div>
  <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
    <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
    <span>Free</span>
  </div>
  <button class="frame-action-btn" data-frame="7" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
    ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
  </button>
</div>

<!-- Frame 8 - 200 Crystals -->
<div class="frame-item" data-frame="8" data-cost="200" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
  <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
    <img src="https://i.ibb.co/YFPQqWLT/Grid-Art-20251022-203053097.png" alt="Frame 8" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 8</div>
  <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
    <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
    <span>200</span>
  </div>
  <button class="frame-action-btn" data-frame="8" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
    ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
  </button>
</div>

<!-- Frame 9 - 300 Crystals -->
<div class="frame-item" data-frame="9" data-cost="300" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
  <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
    <img src="https://i.ibb.co/CKHjc9Yv/Grid-Art-20251022-203131283.png" alt="Frame 9" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 9</div>
  <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
    <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
    <span>300</span>
  </div>
  <button class="frame-action-btn" data-frame="9" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
    ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
  </button>
</div>

<!-- Frame 10 - 300 Crystals -->
<div class="frame-item" data-frame="10" data-cost="300" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
  <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
    <img src="https://i.ibb.co/3YPVPzBQ/Grid-Art-20251022-203203551.png" alt="Frame 10" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 10</div>
  <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
    <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
    <span>300</span>
  </div>
  <button class="frame-action-btn" data-frame="10" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
    ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
  </button>
</div>

<!-- Frame 11 - 100 Crystals -->
<div class="frame-item" data-frame="11" data-cost="100" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
  <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
    <img src="https://i.ibb.co/5xf2gynX/Grid-Art-20251022-203239723.png" alt="Frame 11" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 11</div>
  <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
    <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
    <span>100</span>
  </div>
  <button class="frame-action-btn" data-frame="11" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
    ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
  </button>
</div>

<!-- Frame 12 - 200 Crystals -->
<div class="frame-item" data-frame="12" data-cost="200" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
  <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
    <img src="https://i.ibb.co/bRBtyRZz/Grid-Art-20251022-202649925.png" alt="Frame 12" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 12</div>
  <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
    <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
    <span>200</span>
  </div>
  <button class="frame-action-btn" data-frame="12" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
    ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
  </button>
</div>

<!-- Frame 13 - 100 Crystals -->
<div class="frame-item" data-frame="13" data-cost="100" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
  <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
    <img src="https://i.ibb.co/LwVZZ8k/Grid-Art-20251022-202724485.png" alt="Frame 13" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 13</div>
  <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
    <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
    <span>100</span>
  </div>
  <button class="frame-action-btn" data-frame="13" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
    ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
  </button>
</div>

<!-- Frame 14 - 500 Crystals -->
<div class="frame-item" data-frame="14" data-cost="500" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
  <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
    <img src="https://i.ibb.co/dwKFfgZP/bceab2c603a6123d4e7f8c3189cdb77f.gif" alt="Frame 14" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 14</div>
  <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
    <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
    <span>500</span>
  </div>
  <button class="frame-action-btn" data-frame="14" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
    ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
  </button>
</div>

<!-- Frame 15 - 100 Crystals -->
<div class="frame-item" data-frame="15" data-cost="100" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
  <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
    <img src="https://i.ibb.co/7tbQSvR5/Grid-Art-20251023-110346131.png" alt="Frame 15" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 15</div>
  <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
    <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
    <span>100</span>
  </div>
  <button class="frame-action-btn" data-frame="15" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
    ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
  </button>
</div>

<!-- Frame 16 - 100 Crystals -->
<div class="frame-item" data-frame="16" data-cost="100" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
  <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
    <img src="https://i.ibb.co/TByr3SP5/Grid-Art-20251023-110424499.png" alt="Frame 16" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 16</div>
  <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
    <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
    <span>100</span>
  </div>
  <button class="frame-action-btn" data-frame="16" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
    ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
  </button>
</div>

<!-- Frame 17 - 200 Crystals -->
<div class="frame-item" data-frame="17" data-cost="200" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
  <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
    <img src="https://i.ibb.co/yc8Y4Qsp/Grid-Art-20251023-110503741.png" alt="Frame 17" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 17</div>
  <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
    <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
    <span>200</span>
  </div>
  <button class="frame-action-btn" data-frame="17" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
    ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
  </button>
</div>

<!-- Frame 18 - 100 Crystals -->
<div class="frame-item" data-frame="18" data-cost="100" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
  <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
    <img src="https://i.ibb.co/7dyyNNWC/Grid-Art-20251023-110615606.png" alt="Frame 18" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 18</div>
  <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
    <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
    <span>100</span>
  </div>
  <button class="frame-action-btn" data-frame="18" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
    ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
  </button>
</div>

<!-- Frame 19 - Free -->
<div class="frame-item" data-frame="19" data-cost="0" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
  <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
    <img src="https://i.ibb.co/Gfcnkmsf/Grid-Art-20251023-110704674.png" alt="Frame 19" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 19</div>
  <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
    <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
    <span>Free</span>
  </div>
  <button class="frame-action-btn" data-frame="19" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
    ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
  </button>
</div>

<!-- Frame 20 - 100 Crystals -->
<div class="frame-item" data-frame="20" data-cost="100" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
  <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
    <img src="https://i.ibb.co/gFtR2ctd/Grid-Art-20251023-123518546.png" alt="Frame 20" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 20</div>
  <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
    <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
    <span>100</span>
  </div>
  <button class="frame-action-btn" data-frame="20" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
    ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
  </button>
</div>

<!-- Frame 21 - 100 Crystals -->
<div class="frame-item" data-frame="21" data-cost="100" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
  <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
    <img src="https://i.ibb.co/hxkQX8gr/Grid-Art-20251023-123550710.png" alt="Frame 21" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 21</div>
  <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
    <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
    <span>100</span>
  </div>
  <button class="frame-action-btn" data-frame="21" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
    ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
  </button>
</div>

<!-- Frame 22 - 100 Crystals -->
<div class="frame-item" data-frame="22" data-cost="100" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
  <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
    <img src="https://i.ibb.co/7JcHyRmC/Grid-Art-20251023-123620592.png" alt="Frame 22" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 22</div>
  <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
    <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
    <span>100</span>
  </div>
  <button class="frame-action-btn" data-frame="22" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
    ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
  </button>
</div>

<!-- Frame 23 - 100 Crystals -->
<div class="frame-item" data-frame="23" data-cost="100" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
  <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
    <img src="https://i.ibb.co/tp6K9jtJ/Grid-Art-20251023-123654397.png" alt="Frame 23" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 23</div>
  <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
    <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
    <span>100</span>
  </div>
  <button class="frame-action-btn" data-frame="23" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
    ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
  </button>
</div>

<!-- Frame 24 - 100 Crystals -->
<div class="frame-item" data-frame="24" data-cost="100" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
  <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
    <img src="https://i.ibb.co/jkFL2LVM/Grid-Art-20251023-123726543.png" alt="Frame 24" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 24</div>
  <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
    <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
    <span>100</span>
  </div>
  <button class="frame-action-btn" data-frame="24" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
    ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
  </button>
</div>

<!-- Frame 25 - 200 Crystals -->
<div class="frame-item" data-frame="25" data-cost="200" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
  <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
    <img src="https://i.ibb.co/N2sMqPZB/Grid-Art-20251023-123800635.png" alt="Frame 25" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 25</div>
  <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
    <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
    <span>200</span>
  </div>
  <button class="frame-action-btn" data-frame="25" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
    ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
  </button>
</div>

<!-- Frame 26 - 200 Crystals -->
<div class="frame-item" data-frame="26" data-cost="200" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
  <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
    <img src="https://i.ibb.co/HLNH2K6B/Grid-Art-20251023-123846894.png" alt="Frame 26" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 26</div>
  <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
    <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
    <span>200</span>
  </div>
  <button class="frame-action-btn" data-frame="26" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
    ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
  </button>
</div>

<!-- Frame 27 - Free -->
<div class="frame-item" data-frame="27" data-cost="0" style="background: rgba(255,255,255,0.12); border-radius: 10px; padding: 15px 10px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; width: 100%;">
  <div class="frame-preview" style="width: 80px; height: 80px; margin: 0 auto 10px; position: relative;">
    <img src="https://i.ibb.co/F4Pmw0g4/Grid-Art-20251023-123923903.png" alt="Frame 27" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  <div class="frame-name" style="font-size: 12px; margin-bottom: 8px; font-weight: bold; color: white;">Frame 27</div>
  <div class="frame-cost" style="font-size: 11px; color: #ffcc00; display: flex; align-items: center; justify-content: center; gap: 4px; margin-bottom: 8px;">
    <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 12px; height: 12px;">
    <span>Free</span>
  </div>
  <button class="frame-action-btn" data-frame="27" style="width: 100%; padding: 6px 10px; font-size: 11px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer;">
    ·Äê·Äï·Ä∫·Äô·Ää·Ä∫
  </button>
</div>

      </div>
    </div>

    <!-- User Crystal Balance -->
    <div style="background: rgba(0,0,0,0.5); padding: 12px 16px; border-radius: 10px; text-align: center; border: 1px solid rgba(255,255,255,0.2); margin-bottom: 10px;">
      <div style="display: flex; align-items: center; justify-content: center; gap: 8px; font-size: 14px;">
        <img src="https://iili.io/KvbIfKg.png" alt="Crystal" style="width: 20px; height: 20px;">
        <span>Your Crystals: <span id="user-crystal-balance" style="font-weight: bold; color: #ffcc00;">0</span></span>
      </div>
    </div>

  </div>
</div>
    </div>
  </div>

<!-- Game Mode Screen - Android Optimized -->
<div id="game-mode-screen" style="display: none; width: 100vw; height: 100vh; background-image: url('https://i.ibb.co/spwHMt08/Grid-Art-20251023-165052122.jpg'); background-size: cover; background-position: center; position: fixed; top: 0; left: 0; z-index: 1000; overflow-y: auto; color: white; padding: 15px;">
  <button class="back-btn" id="back-game-mode" style="padding: 8px 16px; font-size: 14px;">Home</button>
  
  <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; padding: 10px;">
    
    <!-- Share Button (Initially Show) -->
    <div id="share-to-play-btn" style="text-align: center; margin-bottom: 30px; cursor: pointer; padding: 12px 24px; background: rgba(255, 86, 0, 0.9); border-radius: 25px; transition: all 0.3s ease;">
      <div style="color: white; font-size: 18px; font-weight: bold;">Share ·Äï·Ä´</div>
      <div style="color: #ffcc00; font-size: 12px; margin-top: 5px;">1 ·Äî·Ä¨·Äõ·ÄÆ·Äê·ÄÖ·Ä∫·ÄÅ·Ä´·Äû·Ä¨·ÄÜ·Ä±·Ä¨·Ä∑·Äú·Ä≠·ÄØ·Ä∑·Äõ·Äï·Ä´·Äô·Ää·Ä∫</div>
    </div>
    
    <!-- Start Game Button (Initially Hidden) -->
    <div id="start-game-btn" style="display: none; text-align: center; margin-bottom: 30px; cursor: pointer; padding: 12px 24px; background: rgba(255, 140, 0, 0.8); border-radius: 25px; transition: all 0.3s ease;">
      <div style="color: white; font-size: 18px; font-weight: bold;">·ÄÇ·Ä≠·Äô·Ä∫·Ä∏·ÄÄ·ÄÖ·Ä¨·Ä∏·Äô·Ää·Ä∫</div>
    </div>
    
    <!-- Cooldown Timer (Initially Hidden) -->
    <div id="cooldown-timer" style="display: none; text-align: center; margin-bottom: 30px; padding: 12px 24px; background: rgba(108, 117, 125, 0.8); border-radius: 25px;">
      <div style="color: white; font-size: 16px; font-weight: bold; margin-bottom: 5px;">·Äî·Ä±·Ä¨·ÄÄ·Ä∫·Äë·Äï·Ä∫·ÄÜ·Ä±·Ä¨·Ä∑·Äõ·Äî·Ä∫</div>
      <div id="cooldown-time" style="color: #ffcc00; font-size: 18px; font-weight: bold;">60:00</div>
      <div style="color: #ddd; font-size: 12px; margin-top: 5px;">1 ·Äî·Ä¨·Äõ·ÄÆ·ÄÄ·Äº·Ä¨·Äï·Ä´·ÄÄ ·Äë·Äï·Ä∫·ÄÜ·Ä±·Ä¨·Ä∑·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äô·Ää·Ä∫</div>
    </div>
    
    <!-- Mode Selection (Initially Hidden) -->
    <div id="mode-selection" style="display: none; width: 100%; max-width: 500px;">
      
      <!-- Easy Mode -->
      <div class="mode-card" data-mode="easy" style="background: rgba(0,0,0,0.8); border-radius: 15px; padding: 20px; margin-bottom: 20px; cursor: pointer; transition: all 0.3s ease; border: 2px solid #90ee90;">
        <div style="display: flex; align-items: center; gap: 15px;">
          <div style="width: 60px; height: 60px; background-image: url('https://i.ibb.co/4ZRK4Yzs/Grid-Art-20251023-165303031.png'); background-size: contain; background-repeat: no-repeat; background-position: center;"></div>
          <div style="flex: 1;">
            <h3 style="color: #90ee90; font-size: 18px; margin-bottom: 8px;">·Äú·ÄΩ·Äö·Ä∫·ÄÄ·Ä∞·Äû·Ä±·Ä¨ Mod</h3>
            <div style="font-size: 12px; color: #ddd; margin-bottom: 6px;"></div>
            <div style="font-size: 11px; color: #ffcc00; margin-bottom: 6px;">·ÄÄ·ÄÖ·Ä¨·Ä∏·ÄÅ·Äª·Ä≠·Äî·Ä∫: 15 ·ÄÖ·ÄÄ·Äπ·ÄÄ·Äî·Ä∑·Ä∫ </div>
            <div style="display: flex; gap: 10px;">
              <div style="background: rgba(40, 167, 69, 0.4); padding: 4px 8px; border-radius: 6px; font-size: 10px; color: #90ee90;">
                ·Ä°·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äõ·Äõ·Äæ·Ä≠·Äï·Ä´·ÄÄ 2 Token ·Äõ·Äõ·Äæ·Ä≠·Äô·Ää·Ä∫
              </div>
              <div style="background: rgba(220, 53, 69, 0.4); padding: 4px 8px; border-radius: 6px; font-size: 10px; color: #ff6b6b;">
                ·Äõ·Äæ·ÄØ·Ä∂·Ä∏·Äï·Ä´·ÄÄ 100 Coins ·ÄÄ·ÄØ·Äî·Ä∫·Äô·Ää·Ä∫
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Hard Mode -->
      <div class="mode-card" data-mode="hard" style="background: rgba(0,0,0,0.8); border-radius: 15px; padding: 20px; cursor: pointer; transition: all 0.3s ease; border: 2px solid #ff6b6b;">
        <div style="display: flex; align-items: center; gap: 15px;">
          <div style="width: 60px; height: 60px; background-image: url('https://i.ibb.co/LhYbJbsC/Grid-Art-20251023-165232034.png'); background-size: contain; background-repeat: no-repeat; background-position: center;"></div>
          <div style="flex: 1;">
            <h3 style="color: #ff6b6b; font-size: 18px; margin-bottom: 8px;">·Ä°·ÄÅ·ÄÄ·Ä∫·ÄÖ·Ä¨·Ä∏ Mod</h3>
            <div style="font-size: 12px; color: #ddd; margin-bottom: 6px;"></div>
            <div style="font-size: 11px; color: #ffcc00; margin-bottom: 6px;">·ÄÄ·ÄÖ·Ä¨·Ä∏·ÄÅ·Äª·Ä≠·Äî·Ä∫: 30 ·ÄÖ·ÄÄ·Äπ·ÄÄ·Äî·Ä∑·Ä∫ </div>
            <div style="display: flex; gap: 10px;">
              <div style="background: rgba(40, 167, 69, 0.4); padding: 4px 8px; border-radius: 6px; font-size: 10px; color: #90ee90;">
                ·Ä°·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äõ·Äõ·Äæ·Ä≠·Äï·Ä´·ÄÄ 5 Token ·Äõ·Äõ·Äæ·Ä≠·Äô·Ää·Ä∫
              </div>
              <div style="background: rgba(220, 53, 69, 0.4); padding: 4px 8px; border-radius: 6px; font-size: 10px; color: #ff6b6b;">
                ·Äõ·Äæ·ÄØ·Ä∂·Ä∏·Äï·Ä´·ÄÄ 300 Coins ·ÄÄ·ÄØ·Äî·Ä∫·Äô·Ää·Ä∫
              </div>
            </div>
          </div>
        </div>
      </div>
      
    </div>
  </div>
</div>
<!-- Pumpkin Game Screen - Simplified No Home Button -->
<div id="pumpkin-game-screen" style="display: none; width: 100vw; height: 100vh; background-image: url('https://i.ibb.co/7d0ZQwSQ/26af0e228da2cdf8b5af4425313603a8.jpg'); background-size: cover; background-position: center; position: fixed; top: 0; left: 0; z-index: 1000; overflow: hidden; color: white;">
  
  <!-- Countdown Screen -->
  <div id="countdown-screen" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 25; display: flex; flex-direction: column; justify-content: center; align-items: center;">
    <div id="countdown-number" style="font-size: 80px; font-weight: bold; color: #ffcc00; text-shadow: 0 0 20px rgba(255,204,0,0.7);">3</div>
    <div style="font-size: 24px; color: white; margin-top: 20px;">·ÄÇ·Ä≠·Äô·Ä∫·Ä∏·ÄÖ·Äê·ÄÑ·Ä∫·Äô·Ää·Ä∫...</div>
  </div>
  
  <!-- Game Header - Simplified -->
  <div style="position: absolute; top: 10px; left: 0; width: 100%; z-index: 10; padding: 0 10px;">
    <div style="display: flex; justify-content: space-between; align-items: center;">
      
      <!-- My Score -->
      <div style="display: flex; align-items: center; gap: 8px; background: rgba(0,0,0,0.7); padding: 6px 12px; border-radius: 20px;">
        <div style="font-size: 12px; color: white;">My:</div>
        <div id="game-score" style="font-size: 16px; font-weight: bold; color: #90ee90;">0</div>
      </div>
      
      <!-- AI Player -->
      <div style="display: flex; align-items: center; gap: 8px; background: rgba(0,0,0,0.7); padding: 6px 12px; border-radius: 20px;">
        <div id="ai-player-avatar" style="width: 24px; height: 24px; background-size: contain; background-repeat: no-repeat; background-position: center;"></div>
        <div id="ai-player-score" style="font-size: 16px; font-weight: bold; color: #ff6b6b;">0</div>
      </div>
    </div>
  </div>
  
  <!-- Game Timer (Small) -->
  <div style="position: absolute; top: 50px; left: 50%; transform: translateX(-50%); z-index: 10;">
    <div id="game-timer" style="font-size: 14px; font-weight: bold; color: #ffcc00; text-shadow: 2px 2px 4px rgba(0,0,0,0.8); background: rgba(0,0,0,0.7); padding: 4px 12px; border-radius: 12px;">15</div>
  </div>
  
  <!-- Game Area -->
  <div id="game-area" style="width: 100%; height: 100%; position: relative;"></div>
  
  <!-- Game Over Screen -->
  <div id="game-over-screen" style="display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 20; flex-direction: column; justify-content: center; align-items: center; padding: 20px;">
    <h2 style="color: #ffcc00; font-size: 24px; margin-bottom: 15px; text-align: center;">·ÄÇ·Ä≠·Äô·Ä∫·Ä∏·Äï·Äº·ÄÆ·Ä∏·ÄÜ·ÄØ·Ä∂·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ!</h2>
    <div id="final-score" style="font-size: 20px; color: #90ee90; margin-bottom: 8px; text-align: center;">·Äû·ÄÑ·Ä∑·Ä∫·Äõ·Ä≤·Ä∑·Ä°·Äô·Äæ·Äê·Ä∫: 0</div>
    <div id="ai-final-score" style="font-size: 18px; color: #ff6b6b; margin-bottom: 8px; text-align: center;">AI Player ·Ä°·Äô·Äæ·Äê·Ä∫: 0</div>
    <div id="reward-message" style="font-size: 16px; color: #ffcc00; margin-bottom: 8px; text-align: center;"></div>
    <div id="winner-message" style="font-size: 16px; color: #ffcc00; margin-bottom: 20px; text-align: center;"></div>
    <div style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;">
      <button class="btn" id="play-again-btn" style="background: #28a745; padding: 8px 16px; font-size: 14px;">·Äë·Äï·Ä∫·ÄÄ·ÄÖ·Ä¨·Ä∏·Äô·Ää·Ä∫</button>
      <button class="btn" id="exit-game-btn" style="background: #dc3545; padding: 8px 16px; font-size: 14px;">·Äë·ÄΩ·ÄÄ·Ä∫·Äô·Ää·Ä∫</button>
    </div>
  </div>
</div>
<!-- Event Screen -->
<div id="event-screen">
  <div class="event-box" id="event-box"></div>
  <div id="screen2-gif" style="background-image:url('https://i.ibb.co/p6VN6dH3/GIF-20251012-200755-325.gif');"></div>
  <button class="open-btn" id="open-btn">Open Box</button>
  <button class="back-btn" id="back-btn">Home</button>
  <div class="reward-popup" id="reward-popup">
    <img src="" alt="Reward" id="reward-img">
    <div id="reward-text"></div>
    <button class="close-btn" id="close-reward">·Äü·ÄØ·Äê·Ä∫·Äï·Äº·ÄÆ</button>
  </div>
</div>

<!-- Task Screen -->
<div id="task-screen">
  <button class="back-btn" id="back-task">Home</button>

  <div class="task-header">
    <h2>Task ·Äô·Äª·Ä¨·Ä∏</h2>
    <p>Task ·Äô·Äª·Ä¨·Ä∏·Äï·Äº·ÄÆ·Ä∏·ÄÜ·ÄØ·Ä∂·Ä∏·Äï·Ä´·ÄÄ Token Card ·Äô·Äª·Ä¨·Ä∏·Äõ·Äõ·Äæ·Ä≠·Äô·Ää·Ä∫</p>
  </div>

  <div class="task-list">
    <div class="task-item" id="task-3hour">
      <div class="task-info">
        <h3>·ÅÉ ·Äî·Ä¨·Äõ·ÄÆ·Äê·ÄÖ·Ä∫·ÄÅ·Ä´ Token Card ·Äõ·Äö·Ä∞·Äï·Ä´</h3>
        <p>·ÅÉ ·Äî·Ä¨·Äõ·ÄÆ·ÄÄ·Äº·Ä¨·Äê·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏ 1 Token Card ·Äõ·Äõ·Äæ·Ä≠·Äô·Ää·Ä∫</p>

        <!-- Countdown Timer Section -->
        <div id="countdown-section">
          <div class="countdown-timer" id="countdown-timer">
            <div class="countdown-unit">
              <div class="countdown-value" id="countdown-hours">03</div>
              <div class="countdown-label">·Äî·Ä¨·Äõ·ÄÆ</div>
            </div>
            <div class="countdown-unit">
              <div class="countdown-value" id="countdown-minutes">00</div>
              <div class="countdown-label">·Äô·Ä≠·Äî·ÄÖ·Ä∫</div>
            </div>
            <div class="countdown-unit">
              <div class="countdown-value" id="countdown-seconds">00</div>
              <div class="countdown-label">·ÄÖ·ÄÄ·Äπ·ÄÄ·Äî·Ä∑·Ä∫</div>
            </div>
          </div>
          <div class="ready-to-claim" id="ready-to-claim" style="display:none;">
            ·Äë·Äï·Ä∫·Äö·Ä∞·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äô·Ää·Ä∫!
          </div>
        </div>

        <div class="task-reward">
          <img src="https://iili.io/KVxjsG1.png" alt="Token">
          <span>1 Token Card</span>
        </div>
      </div>
      <button class="btn" id="btn-3hour" disabled>·Äô·Äõ·Äû·Ä±·Ä∏·Äï·Ä´</button>
    </div>
    <div class="task-item" id="task-channel1">
      <div class="task-info">
        <h3>Channel ·Äû·Ä≠·ÄØ·Ä∑ Join ·Äï·Ä´</h3>
        <p>https://t.me/StarlarCompany</p>
        <div class="task-reward">
          <img src="https://iili.io/KVxjsG1.png" alt="Token">
          <span>5 Token Card</span>
        </div>
      </div>
      <button class="btn" id="btn-channel1">Join & Claim</button>
    </div>
    <div class="task-item" id="task-channel2">
      <div class="task-info">
        <h3>Channel ·Äû·Ä≠·ÄØ·Ä∑ Join ·Äï·Ä´</h3>
        <p>https://t.me/stw27925</p>
        <div class="task-reward">
          <img src="https://iili.io/KVxjsG1.png" alt="Token">
          <span>5 Token Card</span>
        </div>
      </div>
      <button class="btn" id="btn-channel2">Join & Claim</button>
    </div>
    <div class="task-item" id="task-channel3">
      <div class="task-info">
        <h3>Channel ·Äû·Ä≠·ÄØ·Ä∑ Join ·Äï·Ä´</h3>
        <p>https://t.me/calvin2k78</p>
        <div class="task-reward">
          <img src="https://iili.io/KVxjsG1.png" alt="Token">
          <span>5 Token Card</span>
        </div>
      </div>
      <button class="btn" id="btn-channel3">Join & Claim</button>
    </div>
    <div class="task-item" id="task-channel4">
      <div class="task-info">
        <h3>Channel ·Äû·Ä≠·ÄØ·Ä∑ Join ·Äï·Ä´</h3>
        <p>https://t.me/MythicMart_2</p>
        <div class="task-reward">
          <img src="https://iili.io/KVxjsG1.png" alt="Token">
          <span>5 Token Card</span>
        </div>
      </div>
      <button class="btn" id="btn-channel4">Join & Claim</button>
    </div>
<!-- NEW: Max Diamonds Shop Channel Join Task -->
<div class="task-item" id="task-maxdiamond">
  <div class="task-info">
    <h3>Channel ·Äû·Ä≠·ÄØ·Ä∑ Join ·Äï·Ä´</h3>
    <p>https://t.me/MaxDiamondShop</p>
    <div class="task-reward">
      <img src="https://iili.io/KVxjsG1.png" alt="Token">
      <span>3 Token Card</span>
    </div>
  </div>
  <button class="btn" id="btn-maxdiamond">Join & Claim</button>
</div>
    <!-- NEW: YouTube Subscribe Task -->
    <div class="task-item" id="task-youtube">
      <div class="task-info">
        <h3>YouTube Channel Subscribe ·Äú·ÄØ·Äï·Ä∫·Äï·Ä´</h3>
        <p>https://youtube.com/@starlar.1?si=MXHDQE_quqeRN7pA</p>
        <div class="task-reward">
          <img src="https://iili.io/KVxjsG1.png" alt="Token">
          <span>3 Token Card</span>
        </div>
      </div>
      <button class="btn" id="btn-youtube">Subscribe & Claim</button>
    </div>

    <!-- NEW: Telegram Share Task -->
    <div class="task-item" id="task-share">
      <div class="task-info">
        <h3>Telegram ·ÄÄ ·Äô·Ä≠·Äê·Ä∫·ÄÜ·ÄΩ·Ä±·Äô·Äª·Ä¨·Ä∏·ÄÖ·ÄÆ ·ÅÉ ·ÄÅ·Ä´ Share ·Äï·Ä´</h3>
        <p>MLBB Diamonds ·Äô·Äª·Ä¨·Ä∏·ÄÄ·Ä≠·ÄØ ·Ä°·ÄÅ·Äô·Ä≤·Ä∑ ·Äõ·Äö·Ä∞·Äõ·Äî·Ä∫ Event ·Äê·ÄΩ·ÄÑ·Ä∫·Äï·Ä´·Äù·ÄÑ·Ä∫·Äú·Ä≠·ÄØ·ÄÄ·Ä∫·Äï·Ä´ üíé</p>
        <p>https://starlar1.github.io/Event1/</p>
        <div class="task-reward">
          <img src="https://iili.io/KVxjsG1.png" alt="Token">
          <span>3 Token Card</span>
        </div>
      </div>
      <button class="btn" id="btn-share">Share & Claim</button>
    </div>
<!-- Task Screen ·Ä°·Äê·ÄΩ·ÄÑ·Ä∫·Ä∏ ·Äõ·Äæ·Ä≠·Äï·Äº·ÄÆ·Ä∏·Äû·Ä¨·Ä∏ task-list ·Äë·Ä≤·Äô·Äæ·Ä¨ ·Ä°·Ä±·Ä¨·ÄÄ·Ä∫·Äï·Ä´ task ·Äî·Äæ·ÄÖ·Ä∫·ÄÅ·ÄØ·ÄÄ·Ä≠·ÄØ ·Äë·Ää·Ä∑·Ä∫·Äû·ÄΩ·ÄÑ·Ä∫·Ä∏·Äï·Ä´ -->

<!-- NEW: Moonton Company Channel Join Task -->
<div class="task-item" id="task-moonton">
  <div class="task-info">
    <h3>Channel ·Äû·Ä≠·ÄØ·Ä∑ Join ·Äï·Ä´</h3>
    <p>https://t.me/MoontonCompamyMM</p>
    <div class="task-reward">
      <img src="https://iili.io/KVxjsG1.png" alt="Token">
      <span>3 Token Card</span>
    </div>
  </div>
  <button class="btn" id="btn-moonton">Join & Claim</button>
</div>



<!-- NEW: Lily Dia Shop Channel Join Task -->
<div class="task-item" id="task-lily">
  <div class="task-info">
    <h3>Channel ·Äû·Ä≠·ÄØ·Ä∑ Join ·Äï·Ä´</h3>
    <p>https://t.me/lily_diashop</p>
    <div class="task-reward">
      <img src="https://iili.io/KVxjsG1.png" alt="Token">
      <span>3 Token Card</span>
    </div>
  </div>
  <button class="btn" id="btn-lily">Join & Claim</button>
</div>

<!-- NEW: 10 Times Share Task -->
<div class="task-item" id="task-share10">
  <div class="task-info">
    <h3>·Äû·Ä∞·ÄÑ·Äö·Ä∫·ÄÅ·Äª·ÄÑ·Ä∫·Ä∏·Äô·Äª·Ä¨·Ä∏·ÄÖ·ÄÆ ·ÅÅ·ÅÄ ·ÄÅ·Ä´ Share ·Äï·Ä´</h3>
    <p>MLBB Diamonds ·Äô·Äª·Ä¨·Ä∏·ÄÄ·Ä≠·ÄØ ·Ä°·ÄÅ·Äô·Ä≤·Ä∑ ·Äõ·Äö·Ä∞·Äõ·Äî·Ä∫ Event ·Äê·ÄΩ·ÄÑ·Ä∫·Äï·Ä´·Äù·ÄÑ·Ä∫·Äú·Ä≠·ÄØ·ÄÄ·Ä∫·Äï·Ä´ üíé</p>
    <p>https://starlar1.github.io/Event1/</p>
    <div class="task-reward">
      <img src="https://iili.io/KVxjsG1.png" alt="Token">
      <span>5 Token Card</span>
    </div>
  </div>
  <button class="btn" id="btn-share10">Share & Claim</button>
</div>
  </div>
</div>

<!-- Exchange Screen -->
<div id="exchange-screen" style="display: none;">
  <div class="exchange-container">
    <button class="back-btn" id="back-exchange">Home</button>
    

    <!-- Exchange Items Grid (Initially Hidden) -->
    <div class="exchange-items-container" id="exchange-items" style="display: none;">
      <div class="exchange-cards">
        <!-- Existing items -->
        <div class="exchange-card">
          <img src="https://iili.io/KGldYUG.jpg">
          <p>5 Diamond - 4500 Coin 19 ·Äö·Ä±·Ä¨·ÄÄ·Ä∫·Äû·Ä¨·Äú·Ä≤·Äî·Ä≠·ÄØ·ÄÑ·Ä∫</p>
          <button class="btn exchange-item" data-diamond="5" data-coins="4500">·Äú·Ä≤·Äô·Ää·Ä∫</button>
        </div>
        <div class="exchange-card">
          <img src="https://iili.io/KGlFqle.jpg">
          <p>11 Diamond - 8000 Coin ·Äú·Ä≤·Äô·Äõ·Äê·Ä±·Ä¨·Ä∑·Äï·Ä´</p>
          <button class="btn exchange-item" data-diamond="11" data-coins="8000">·Äú·Ä≤·Äô·Äõ·Äû·Ä±·Ä∏·Äï·Ä´</button>
        </div>
        <div class="exchange-card">
          <img src="https://iili.io/KGlfSK7.jpg">
          <p>50 + 50 Diamond - ·Äú·Ä≤·Äô·Äõ·Äû·Ä±·Ä∏·Äï·Ä´</p>
          <button class="btn exchange-item" data-diamond="100" data-coins="20000">·Äú·Ä≤·Äô·Äõ·Äû·Ä±·Ä∏·Äï·Ä´</button>
        </div>
        
               <!-- NEW: Wp Pass Item -->
        <div class="exchange-card">
          <img src="https://iili.io/KjVZcW7.jpg">
          <p>Wp Pass - 35000 Coin 1 ·Äö·Ä±·Ä¨·ÄÄ·Ä∫·Äû·Ä¨·Äú·Ä≤·Äî·Ä≠·ÄØ·ÄÑ·Ä∫</p>
          <button class="btn exchange-item" data-diamond="0" data-coins="35000" data-item="Wp Pass">·Äú·Ä≤·Äô·Ää·Ä∫</button>
        </div>
        
        
        <!-- New items -->
        <div class="exchange-card">
          <img src="https://iili.io/KhdF7sa.jpg">
          <p>YUI 300 Coins - 100 ·Äö·Ä±·Ä¨·ÄÄ·Ä∫·Äû·Ä¨·Äú·Ä≤·Äî·Ä≠·ÄØ·ÄÑ·Ä∫</p>
          <button class="btn exchange-item" data-diamond="0" data-coins="300">·Äú·Ä≤·Äô·Ää·Ä∫</button>
        </div>
        <div class="exchange-card">
          <img src="https://iili.io/KhdKQGs.jpg">
          <p>HSI 300 Coins - 100 ·Äö·Ä±·Ä¨·ÄÄ·Ä∫·Äû·Ä¨·Äú·Ä≤·Äî·Ä≠·ÄØ·ÄÑ·Ä∫</p>
          <button class="btn exchange-item" data-diamond="0" data-coins="300">·Äú·Ä≤·Äô·Ää·Ä∫</button>
        </div>
        <div class="exchange-card">
          <img src="https://iili.io/Khdqlgj.jpg">
          <p>OPS 1000 Coins - 7 ·Äö·Ä±·Ä¨·ÄÄ·Ä∫·Äû·Ä¨·Äú·Ä≤·Äî·Ä≠·ÄØ·ÄÑ·Ä∫</p>
          <button class="btn exchange-item" data-diamond="0" data-coins="1000">·Äú·Ä≤·Äô·Ää·Ä∫</button>
        </div>
        <div class="exchange-card">
          <img src="https://iili.io/KhdB1Gn.jpg">
          <p>PKJ 1000 Coins - 7 ·Äö·Ä±·Ä¨·ÄÄ·Ä∫·Äû·Ä¨·Äú·Ä≤·Äî·Ä≠·ÄØ·ÄÑ·Ä∫</p>
          <button class="btn exchange-item" data-diamond="0" data-coins="1000">·Äú·Ä≤·Äô·Ää·Ä∫</button>
        </div>
        <div class="exchange-card">
          <img src="https://iili.io/KhdC0NV.jpg">
          <p>UHF 2000 Coins - ·Äú·Ä≤·Äô·Äõ·Äê·Ä±·Ä¨·Ä∑·Äï·Ä´</p>
          <button class="btn exchange-item" data-diamond="0" data-coins="2000">·Äú·Ä≤·Äô·Äõ·Äû·Ä±·Ä∏·Äï·Ä´</button>
        </div>
        <div class="exchange-card">
          <img src="https://iili.io/Khdo5yx.jpg">
          <p>WDS 2000 Coins - 3 ·Äö·Ä±·Ä¨·ÄÄ·Ä∫·Äû·Ä¨·Äú·Ä≤·Äî·Ä≠·ÄØ·ÄÑ·Ä∫</p>
          <button class="btn exchange-item" data-diamond="0" data-coins="2000">·Äú·Ä≤·Äô·Ää·Ä∫</button>
        </div>
        <div class="exchange-card">
          <img src="https://iili.io/KhdzqsS.jpg">
          <p>HHS 2000 Coins - 4 ·Äö·Ä±·Ä¨·ÄÄ·Ä∫·Äû·Ä¨·Äú·Ä≤·Äî·Ä≠·ÄØ·ÄÑ·Ä∫</p>
          <button class="btn exchange-item" data-diamond="0" data-coins="2000">·Äú·Ä≤·Äô·Ää·Ä∫</button>
        </div>
        <div class="exchange-card">
          <img src="https://iili.io/KhdIE67.jpg">
          <p>OJS 2000 Coins - 2 ·Äö·Ä±·Ä¨·ÄÄ·Ä∫·Äû·Ä¨·Äú·Ä≤·Äî·Ä≠·ÄØ·ÄÑ·Ä∫</p>
          <button class="btn exchange-item" data-diamond="0" data-coins="2000">·Äú·Ä≤·Äô·Ää·Ä∫</button>
        </div>
        <div class="exchange-card">
          <img src="https://iili.io/Khdu9g1.jpg">
          <p>KJN 2000 Coins - 10 ·Äö·Ä±·Ä¨·ÄÄ·Ä∫·Äû·Ä¨·Äú·Ä≤·Äî·Ä≠·ÄØ·ÄÑ·Ä∫</p>
          <button class="btn exchange-item" data-diamond="0" data-coins="2000">·Äú·Ä≤·Äô·Ää·Ä∫</button>
        </div>
        <div class="exchange-card">
          <img src="https://iili.io/KhdAd4S.jpg">
          <p>PLY 2000 Coins - 2 ·Äö·Ä±·Ä¨·ÄÄ·Ä∫·Äû·Ä¨·Äú·Ä≤·Äî·Ä≠·ÄØ·ÄÑ·Ä∫</p>
          <button class="btn exchange-item" data-diamond="0" data-coins="2000">·Äú·Ä≤·Äô·Ää·Ä∫</button>
        </div>
        <div class="exchange-card">
          <img src="https://iili.io/Khd7Cjs.jpg">
          <p>RRE 2000 Coins - 8 ·Äö·Ä±·Ä¨·ÄÄ·Ä∫·Äû·Ä¨·Äú·Ä≤·Äî·Ä≠·ÄØ·ÄÑ·Ä∫</p>
          <button class="btn exchange-item" data-diamond="0" data-coins="2000">·Äú·Ä≤·Äô·Ää·Ä∫</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Anime Girl Section (Initially Visible) -->
  <div id="exchange-chat-container">
    <div id="exchange-chat-text"></div>
    <img id="exchange-chat-icon" src="https://i.ibb.co/jZrM3Tsn/Grid-Art-20251009-165747395.png" alt="Anime Girl">
  </div>
</div>





<!-- Battle Screen (New Full Version) -->
<div id="battle-screen-new" style="display:none; width:100vw; height:100vh;
  background-image:url('https://i.ibb.co/1fQ1YRWL/cd7f2fd0557c68286a3a03d491e18fe3.jpg');
  background-size:cover; background-position:center; position:fixed; top:0; left:0; z-index:1000;">

  <button class="back-btn" id="back-battle-new">Home</button>

  <!-- ·Ä°·Äï·Ä±·Ä´·Ä∫ Box -->
  <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
              width:220px; height:220px; background:url('https://i.ibb.co/WNhC2n1W/Grid-Art-20251009-112221949.png') center/contain no-repeat;">
  </div>

<!-- ·Äñ·Ä±·Ä¨·ÄÄ·Ä∫·Äô·Ää·Ä∫·ÄÅ·Äú·ÄØ·Äï·Ä∫ (·Äî·Ää·Ä∫·Ä∏·Äî·Ää·Ä∫·Ä∏·Äú·Ä±·Ä∏·Äê·ÄÑ·Ä∫) -->
<button id="open-token-btn" class="btn"
        style="position:absolute; bottom:120px; left:50%; transform:translateX(-50%);
               font-size:15px; padding:8px 20px; border-radius:8px;">
  ·Äñ·Ä±·Ä¨·ÄÄ·Ä∫·Äô·Ää·Ä∫
</button>

  <!-- ·ÄÄ·Äª·Äî·Ä∫·Äõ·Äæ·Ä≠·Äû·Ä±·Ä¨ ·Äñ·Ä±·Ä¨·ÄÄ·Ä∫·ÄÅ·ÄΩ·ÄÑ·Ä∑·Ä∫·Ä°·Äõ·Ä±·Ä°·Äê·ÄΩ·ÄÄ·Ä∫·Äï·Äº·Äô·Äö·Ä∑·Ä∫ Display -->
  <div id="battle-tries" style="position:absolute; bottom:60px; left:50%; transform:translateX(-50%); 
                 text-align:center; color:white; font-size:14px; background:rgba(0,0,0,0.7); 
                 padding:8px 12px; border-radius:8px; width:90%; max-width:350px;">
    Loading...
  </div>

  <!-- ·Äõ·Äú·Äí·Ä∫·Äï·Äº popup -->
  <div id="token-result" 
       style="display:none; position:absolute; top:0; left:0; width:100%; height:100%;
              background:rgba(0,0,0,0.8); color:white; 
              flex-direction:column; justify-content:center; align-items:center; z-index:2000;">
    <img id="token-result-img" src="" style="width:100px; height:100px; margin-bottom:10px;">
    <div id="token-result-text" style="font-size:20px; margin-bottom:10px;"></div>
    <button id="token-result-close" class="btn">·Äü·ÄØ·Äê·Ä∫·Äï·Äº·ÄÆ</button>
  </div>
</div>

<!-- Exchange Form -->
<div class="exchange-form" id="exchange-form">
  <h3>·Äú·Ä≤·Äô·Ää·Ä∫</h3>
  <div class="form-group">
    <label for="game-id">Game ID</label>
    <input type="text" id="game-id" placeholder="·Äû·ÄÑ·Ä∑·Ä∫ Game ID ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´">
  </div>
  <div class="form-group">
    <label for="server-id">Server ID</label>
    <input type="text" id="server-id" placeholder="·Äû·ÄÑ·Ä∑·Ä∫ Server ID ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´">
  </div>
  <div class="form-group">
    <p id="exchange-details">5 Diamond ·Ä°·Äê·ÄΩ·ÄÄ·Ä∫ 1500 Coins ·Äú·Ä≠·ÄØ·Ä°·Äï·Ä∫·Äï·Ä´·Äû·Ää·Ä∫</p>
  </div>
  <div class="form-buttons">
    <button class="confirm-btn" id="confirm-exchange">·Ä°·Äê·Ää·Ä∫·Äï·Äº·ÄØ·Äô·Ää·Ä∫</button>
    <button class="cancel-btn" id="cancel-exchange">·Äô·Äú·Ä≤·Äê·Ä±·Ä¨·Ä∑·Äï·Ä´</button>
  </div>
</div>

<!-- Telegram Success Message -->
<div class="telegram-success" id="telegram-success">
  <h3>·Äú·Ä≤·Äú·Äæ·Ää·Ä∫·Äô·Äæ·ÄØ ·Ä°·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äº·ÄÑ·Ä∫·Äï·Ä´·Äû·Ää·Ä∫!</h3>
  <p>·Äû·ÄÑ·Ä∑·Ä∫·Äõ·Ä≤·Ä∑ ·Äú·Ä≤·Äú·Äæ·Ää·Ä∫·Äô·Äæ·ÄØ·Ä°·ÄÅ·Äª·ÄÄ·Ä∫·Ä°·Äú·ÄÄ·Ä∫·Äô·Äª·Ä¨·Ä∏·ÄÄ·Ä≠·ÄØ·Äï·Ä≠·ÄØ·Ä∑·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ·Åã</p>
  <p>·ÄÄ·Äª·Ä±·Ä∏·Äá·Ä∞·Ä∏·Äï·Äº·ÄØ·Åç ·ÄÖ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·ÄÜ·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏·Äï·Ä±·Ä∏·Äï·Ä´·Åã</p>
  <button class="btn" id="close-success" style="margin-top:15px;">·Äü·ÄØ·Äê·Ä∫·Äï·Äº·ÄÆ</button>
</div>


<script>
  // DOM Elements
  const eventBtn = document.getElementById('event-btn');
  const exchangeBtn = document.getElementById('exchange-btn');
  const taskBtn = document.getElementById('task-btn');
  const mainScreen = document.getElementById('main-screen');
  const eventScreen = document.getElementById('event-screen');
  const exchangeScreen = document.getElementById('exchange-screen');
  const taskScreen = document.getElementById('task-screen');
  const openBtn = document.getElementById('open-btn');
  const backBtn = document.getElementById('back-btn');
  const backExchange = document.getElementById('back-exchange');
  const backTask = document.getElementById('back-task');
  const tokenCountElem = document.getElementById('token-count');
  const coinCountElem = document.getElementById('coin-count');
  const rewardPopup = document.getElementById('reward-popup');
  const rewardImg = document.getElementById('reward-img');
  const rewardText = document.getElementById('reward-text');
  const screen2Gif = document.getElementById('screen2-gif');
  const exchangeForm = document.getElementById('exchange-form');
  const telegramSuccess = document.getElementById('telegram-success');
  const gameIdInput = document.getElementById('game-id');
  const serverIdInput = document.getElementById('server-id');
  const exchangeDetails = document.getElementById('exchange-details');
  const confirmExchange = document.getElementById('confirm-exchange');
  const cancelExchange = document.getElementById('cancel-exchange');
  const closeSuccess = document.getElementById('close-success');

  // Countdown timer elements
  const countdownHours = document.getElementById('countdown-hours');
  const countdownMinutes = document.getElementById('countdown-minutes');
  const countdownSeconds = document.getElementById('countdown-seconds');
  const countdownTimer = document.getElementById('countdown-timer');
  const readyToClaim = document.getElementById('ready-to-claim');

// Task buttons
const btn3hour = document.getElementById('btn-3hour');
const btnChannel1 = document.getElementById('btn-channel1');
const btnChannel2 = document.getElementById('btn-channel2');
const btnChannel3 = document.getElementById('btn-channel3');
const btnChannel4 = document.getElementById('btn-channel4');
const btnYoutube = document.getElementById('btn-youtube');
const btnShare = document.getElementById('btn-share');
const btnMoonton = document.getElementById('btn-moonton');
const btnLily = document.getElementById('btn-lily');
const btnShare10 = document.getElementById('btn-share10');
const btnMaxdiamond = document.getElementById('btn-maxdiamond'); // ‚úÖ NEW

// Game State (·Ä°·ÄÅ·Äº·Ä¨·Ä∏ variables ·Äê·ÄΩ·Ä±·Äî·Ä≤·Ä∑·Ä°·Äê·Ä∞)
let tokens = parseInt(localStorage.getItem('tokens')) || 0;
let coins = parseInt(localStorage.getItem('coins')) || 0;
let crystals = parseInt(localStorage.getItem('crystals')) || 0; // ‚úÖ NEW
let currentExchange = null;

// Task completion state
let completedTasks = JSON.parse(localStorage.getItem('completedTasks')) || {
  '3hour': false,
  'channel1': false,
  'channel2': false,
  'channel3': false,
  'channel4': false,
  'youtube': false,
  'share': false,
  'moonton': false,
  'share10': false,
  'lily': false,
  'maxdiamond': false // ‚úÖ NEW
};

  // Timer state
  let lastTokenTime = parseInt(localStorage.getItem('lastTokenTime')) || 0;
  const TOKEN_COOLDOWN = 3 * 60 * 60 * 1000; // 3 hours in milliseconds

  const rewards = [
  { value: 10,  chance: 80, img: 'https://i.ibb.co/yBQgnMKz/Grid-Art-20251012-184528037.png' },
  { value: 20,  chance: 70, img: 'https://i.ibb.co/yBQgnMKz/Grid-Art-20251012-184528037.png' },
  { value: 30,  chance: 60, img: 'https://i.ibb.co/yBQgnMKz/Grid-Art-20251012-184528037.png' },
  { value: 50,  chance: 50, img: 'https://i.ibb.co/yBQgnMKz/Grid-Art-20251012-184528037.png' },
  { value: 70,  chance: 40, img: 'https://i.ibb.co/yBQgnMKz/Grid-Art-20251012-184528037.png' },
  { value: 100, chance: 10, img: 'https://i.ibb.co/yBQgnMKz/Grid-Art-20251012-184528037.png' }
];

// Initialize game state
function initializeGame() {
  tokenCountElem.textContent = tokens;
  coinCountElem.textContent = coins;
  
  // ‚úÖ NEW: Crystal display update
  const crystalCountElem = document.querySelector('.token-card .crystal + .count');
  if (crystalCountElem) {
    crystalCountElem.textContent = crystals;
  }

  // Update task states
  updateTaskStates();

  // Start timer for 3-hour task
  updateTaskTimer();
  setInterval(updateTaskTimer, 1000);
}

  // Update task completion states
  function updateTaskStates() {
    if (completedTasks['3hour']) {
      document.getElementById('task-3hour').classList.add('task-completed');
      btn3hour.textContent = '·Äö·Ä∞·Äï·Äº·ÄÆ·Ä∏·Äï·Äº·ÄÆ';
      btn3hour.disabled = true;
    }

    if (completedTasks['channel1']) {
      document.getElementById('task-channel1').classList.add('task-completed');
      btnChannel1.textContent = '·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Äº·ÄÆ';
      btnChannel1.disabled = true;
    }

    if (completedTasks['channel2']) {
      document.getElementById('task-channel2').classList.add('task-completed');
      btnChannel2.textContent = '·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Äº·ÄÆ';
      btnChannel2.disabled = true;
    }

    if (completedTasks['channel3']) {
      document.getElementById('task-channel3').classList.add('task-completed');
      btnChannel3.textContent = '·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Äº·ÄÆ';
      btnChannel3.disabled = true;
    }

if (completedTasks['maxdiamond']) {
    document.getElementById('task-maxdiamond').classList.add('task-completed');
    btnMaxdiamond.textContent = '·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Äº·ÄÆ';
    btnMaxdiamond.disabled = true;
  }


    if (completedTasks['channel4']) {
      document.getElementById('task-channel4').classList.add('task-completed');
      btnChannel4.textContent = '·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Äº·ÄÆ';
      btnChannel4.disabled = true;
    }

    // NEW tasks state
    if (completedTasks['youtube']) {
      document.getElementById('task-youtube').classList.add('task-completed');
      btnYoutube.textContent = '·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Äº·ÄÆ';
      btnYoutube.disabled = true;
    }
    if (completedTasks['share']) {
      document.getElementById('task-share').classList.add('task-completed');
      btnShare.textContent = '·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Äº·ÄÆ';
      btnShare.disabled = true;
    }
  

  if (completedTasks['moonton']) {
    document.getElementById('task-moonton').classList.add('task-completed');
    btnMoonton.textContent = '·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Äº·ÄÆ';
    btnMoonton.disabled = true;
  }
  
  if (completedTasks['lily']) {
  document.getElementById('task-lily').classList.add('task-completed');
  btnLily.textContent = '·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Äº·ÄÆ';
  btnLily.disabled = true;
}




  if (completedTasks['share10']) {
    document.getElementById('task-share10').classList.add('task-completed');
    btnShare10.textContent = '·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Äº·ÄÆ';
    btnShare10.disabled = true;
  }
}
  // Update timer for 3-hour task ONLY in task screen
  function updateTaskTimer() {
    const now = Date.now();
    const timePassed = now - lastTokenTime;
    const timeRemaining = TOKEN_COOLDOWN - timePassed;

    if (timeRemaining <= 0) {
      // Timer finished - ready to claim
      countdownTimer.style.display = 'none';
      readyToClaim.style.display = 'block';
      btn3hour.disabled = false;
      btn3hour.textContent = 'Token Card ·Äõ·Äö·Ä∞·Äô·Ää·Ä∫';
    } else {
      // Timer still running
      countdownTimer.style.display = 'flex';
      readyToClaim.style.display = 'none';

      const hours = Math.floor(timeRemaining / (1000 * 60 * 60));
      const minutes = Math.floor((timeRemaining % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((timeRemaining % (1000 * 60)) / 1000);

      // Update countdown display
      countdownHours.textContent = hours.toString().padStart(2, '0');
      countdownMinutes.textContent = minutes.toString().padStart(2, '0');
      countdownSeconds.textContent = seconds.toString().padStart(2, '0');

      btn3hour.textContent = '·Äô·Äõ·Äû·Ä±·Ä∏·Äï·Ä´';
      btn3hour.disabled = true;
    }
  }

// Save game state to localStorage
function saveGameState() {
  localStorage.setItem('tokens', tokens);
  localStorage.setItem('coins', coins);
  localStorage.setItem('crystals', crystals); // ‚úÖ NEW
  localStorage.setItem('completedTasks', JSON.stringify(completedTasks));
  localStorage.setItem('lastTokenTime', lastTokenTime);
}

  // Screen Navigation
  eventBtn.addEventListener('click', ()=>{
    mainScreen.style.display='none';
    eventScreen.style.display='block';
  });

  taskBtn.addEventListener('click', ()=>{
    mainScreen.style.display='none';
    taskScreen.style.display='block';
  });

  exchangeBtn.addEventListener('click', ()=>{
    mainScreen.style.display='none';
    exchangeScreen.style.display='block';
  });

  backBtn.addEventListener('click', ()=>{
    eventScreen.style.display='none';
    mainScreen.style.display='block';
  });

  backTask.addEventListener('click', ()=>{
    taskScreen.style.display='none';
    mainScreen.style.display='block';
  });

  backExchange.addEventListener('click', ()=>{
    exchangeScreen.style.display='none';
    mainScreen.style.display='block';
  });

  // Event Box Opening
  function getReward(){
    const totalChance = rewards.reduce((sum,r)=>sum+r.chance,0);
    let rand = Math.random()*totalChance;
    for(let r of rewards){
      if(rand < r.chance) return r;
      rand -= r.chance;
    }
    return rewards[0];
  }

  openBtn.addEventListener('click', ()=>{
    if(tokens<=0){alert('Token Card ·Äô·Äú·ÄØ·Ä∂·Äú·Ä±·Ä¨·ÄÄ·Ä∫·Äï·Ä´!');return;}
    tokens--; 
    tokenCountElem.textContent = tokens;
    saveGameState();

    screen2Gif.style.display = 'block';
    setTimeout(()=>{
      screen2Gif.style.display = 'none';
      const reward = getReward();
      coins += reward.value;
      coinCountElem.textContent = coins;
      rewardImg.src = reward.img;
      rewardText.textContent = `+${reward.value} Coin`;
      rewardPopup.style.display='flex';
      saveGameState();
    },2000);
  });

  document.getElementById('close-reward').addEventListener('click', ()=>{
    rewardPopup.style.display='none';
  });

  // Task System
  btn3hour.addEventListener('click', () => {
    if (completedTasks['3hour']) {
      // Reset for next claim
      completedTasks['3hour'] = false;
    }

    tokens += 1;
    tokenCountElem.textContent = tokens;
    completedTasks['3hour'] = true;
    lastTokenTime = Date.now();

    document.getElementById('task-3hour').classList.add('task-completed');
    btn3hour.textContent = '·Äö·Ä∞·Äï·Äº·ÄÆ·Ä∏·Äï·Äº·ÄÆ';
    btn3hour.disabled = true;

    // Reset timer display
    countdownTimer.style.display = 'flex';
    readyToClaim.style.display = 'none';

    saveGameState();
    alert('1 Token ·Äõ·Äõ·Äæ·Ä≠·Äï·Ä´·Äû·Ää·Ä∫! ·Äî·Ä±·Ä¨·ÄÄ·Ä∫ ·ÅÉ ·Äî·Ä¨·Äõ·ÄÆ·ÄÄ·Äº·Ä¨·Äï·Ä´·ÄÄ ·Äë·Äï·Ä∫·Äô·Ä∂·Äõ·Äõ·Äæ·Ä≠·Äô·Ää·Ä∫');
  });

  btnChannel1.addEventListener('click', () => {
    if (completedTasks['channel1']) return;

    window.open('https://t.me/StarlarCompany', '_blank');

    // Simulate user joining channel (in real app, you'd verify this)
    setTimeout(() => {
      tokens += 5;
      tokenCountElem.textContent = tokens;
      completedTasks['channel1'] = true;

      document.getElementById('task-channel1').classList.add('task-completed');
      btnChannel1.textContent = '·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Äº·ÄÆ';
      btnChannel1.disabled = true;

      saveGameState();
      alert('Channel Join ·Äï·Äº·ÄÆ·Ä∏ 5 Token Card ·Äõ·Äõ·Äæ·Ä≠·Äï·Ä´·Äû·Ää·Ä∫!');
    }, 1000);
  });

  btnChannel2.addEventListener('click', () => {
    if (completedTasks['channel2']) return;

    window.open('https://t.me/stw27925', '_blank');

    setTimeout(() => {
      tokens += 5;
      tokenCountElem.textContent = tokens;
      completedTasks['channel2'] = true;

      document.getElementById('task-channel2').classList.add('task-completed');
      btnChannel2.textContent = '·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Äº·ÄÆ';
      btnChannel2.disabled = true;

      saveGameState();
      alert('Channel Join ·Äï·Äº·ÄÆ·Ä∏ 5 Token Card ·Äõ·Äõ·Äæ·Ä≠·Äï·Ä´·Äû·Ää·Ä∫!');
    }, 1000);
  });

// NEW: Max Diamonds Shop Channel Join Task
btnMaxdiamond.addEventListener('click', () => {
  if (completedTasks['maxdiamond']) return;

  window.open('https://t.me/MaxDiamondShop', '_blank');

  setTimeout(() => {
    tokens += 3;
    tokenCountElem.textContent = tokens;
    completedTasks['maxdiamond'] = true;

    document.getElementById('task-maxdiamond').classList.add('task-completed');
    btnMaxdiamond.textContent = '·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Äº·ÄÆ';
    btnMaxdiamond.disabled = true;

    saveGameState();
    alert('Channel Join ·Äï·Äº·ÄÆ·Ä∏ 3 Token Card ·Äõ·Äõ·Äæ·Ä≠·Äï·Ä´·Äû·Ää·Ä∫!');
  }, 1000);
});

  btnChannel3.addEventListener('click', () => {
    if (completedTasks['channel3']) return;

    window.open('https://t.me/calvin2k78', '_blank');

    setTimeout(() => {
      tokens += 5;
      tokenCountElem.textContent = tokens;
      completedTasks['channel3'] = true;

      document.getElementById('task-channel3').classList.add('task-completed');
      btnChannel3.textContent = '·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Äº·ÄÆ';
      btnChannel3.disabled = true;

      saveGameState();
      alert('Channel Join ·Äï·Äº·ÄÆ·Ä∏ 5 Token Card ·Äõ·Äõ·Äæ·Ä≠·Äï·Ä´·Äû·Ää·Ä∫!');
    }, 1000);
  });

  btnChannel4.addEventListener('click', () => {
    if (completedTasks['channel4']) return;

    window.open('https://t.me/MythicMart_2', '_blank');

    setTimeout(() => {
      tokens += 5;
      tokenCountElem.textContent = tokens;
      completedTasks['channel4'] = true;

      document.getElementById('task-channel4').classList.add('task-completed');
      btnChannel4.textContent = '·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Äº·ÄÆ';
      btnChannel4.disabled = true;

      saveGameState();
      alert('Channel Join ·Äï·Äº·ÄÆ·Ä∏ 5 Token Card ·Äõ·Äõ·Äæ·Ä≠·Äï·Ä´·Äû·Ää·Ä∫!');
    }, 1000);
  });

  // NEW: YouTube Subscribe Task
  btnYoutube.addEventListener('click', () => {
    if (completedTasks['youtube']) return;
    window.open('https://youtube.com/@starlar.1?si=MXHDQE_quqeRN7pA', '_blank');
    setTimeout(() => {
      tokens += 3;
      tokenCountElem.textContent = tokens;
      completedTasks['youtube'] = true;
      document.getElementById('task-youtube').classList.add('task-completed');
      btnYoutube.textContent = '·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Äº·ÄÆ';
      btnYoutube.disabled = true;
      saveGameState();
      alert('YouTube Subscribe ·Äï·Äº·ÄÆ·Ä∏ 3 Token Card ·Äõ·Äõ·Äæ·Ä≠·Äï·Ä´·Äû·Ää·Ä∫!');
    }, 1000);
  });

  // NEW: Telegram Share Task
  let shareCount = parseInt(localStorage.getItem('shareCount')) || 0;
  btnShare.addEventListener('click', () => {
    if (completedTasks['share']) return;
    // open Telegram share intent
    window.open('https://t.me/share/url?url=https://starlar1.github.io/Event1/&text=MLBB Diamonds ·Äô·Äª·Ä¨·Ä∏·ÄÄ·Ä≠·ÄØ ·Ä°·ÄÅ·Äô·Ä≤·Ä∑·Äõ·Äö·Ä∞·Äõ·Äî·Ä∫ Event ·Äê·ÄΩ·ÄÑ·Ä∫·Äï·Ä´·Äù·ÄÑ·Ä∫·Äú·Ä≠·ÄØ·ÄÄ·Ä∫·Äï·Ä´ üíé', '_blank');
    shareCount++;
    localStorage.setItem('shareCount', shareCount);
    if (shareCount >= 3) {
      tokens += 3;
      tokenCountElem.textContent = tokens;
      completedTasks['share'] = true;
      document.getElementById('task-share').classList.add('task-completed');
      btnShare.textContent = '·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Äº·ÄÆ';
      btnShare.disabled = true;
      saveGameState();
      alert('Telegram ·Äê·ÄΩ·ÄÑ·Ä∫ 3 ·ÄÅ·Ä´ Share ·Äï·Äº·ÄÆ·Ä∏ 3 Token ·Äõ·Äõ·Äæ·Ä≠·Äï·Ä´·Äû·Ää·Ä∫!');
    } else {
      alert(`Share ${shareCount}/3 ·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ·Åã ·ÅÉ ·ÄÅ·Ä´ ·Äï·Äº·ÄÆ·Ä∏·Äô·Äæ 3 Token Card ·Äõ·Äõ·Äæ·Ä≠·Äô·Ää·Ä∫`);
    }
  });

// NEW: Moonton Channel Join Task
btnMoonton.addEventListener('click', () => {
  if (completedTasks['moonton']) return;

  window.open('https://t.me/MoontonCompamyMM', '_blank');

  setTimeout(() => {
    tokens += 3;
    tokenCountElem.textContent = tokens;
    completedTasks['moonton'] = true;

    document.getElementById('task-moonton').classList.add('task-completed');
    btnMoonton.textContent = '·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Äº·ÄÆ';
    btnMoonton.disabled = true;

    saveGameState();
    alert('Channel Join ·Äï·Äº·ÄÆ·Ä∏ 3 Token Card ·Äõ·Äõ·Äæ·Ä≠·Äï·Ä´·Äû·Ää·Ä∫!');
  }, 1000);
});

// NEW: Lily Dia Shop Channel Join Task
btnLily.addEventListener('click', () => {
  if (completedTasks['lily']) return;

  window.open('https://t.me/lily_diashop', '_blank');

  setTimeout(() => {
    tokens += 3;
    tokenCountElem.textContent = tokens;
    completedTasks['lily'] = true;

    document.getElementById('task-lily').classList.add('task-completed');
    btnLily.textContent = '·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Äº·ÄÆ';
    btnLily.disabled = true;

    saveGameState();
    alert('Channel Join ·Äï·Äº·ÄÆ·Ä∏ 3 Token Card ·Äõ·Äõ·Äæ·Ä≠·Äï·Ä´·Äû·Ää·Ä∫!');
  }, 1000);
});


// NEW: 10 Times Share Task
let share10Count = parseInt(localStorage.getItem('share10Count')) || 0;
btnShare10.addEventListener('click', () => {
  if (completedTasks['share10']) return;
  
  // open Telegram share intent
  window.open('https://t.me/share/url?url=https://starlar1.github.io/Event1/&text=MLBB Diamonds ·Äô·Äª·Ä¨·Ä∏·ÄÄ·Ä≠·ÄØ ·Ä°·ÄÅ·Äô·Ä≤·Ä∑·Äõ·Äö·Ä∞·Äõ·Äî·Ä∫ Event ·Äê·ÄΩ·ÄÑ·Ä∫·Äï·Ä´·Äù·ÄÑ·Ä∫·Äú·Ä≠·ÄØ·ÄÄ·Ä∫·Äï·Ä´ üíé', '_blank');
  
  share10Count++;
  localStorage.setItem('share10Count', share10Count);
  
  if (share10Count >= 10) {
    tokens += 5;
    tokenCountElem.textContent = tokens;
    completedTasks['share10'] = true;
    document.getElementById('task-share10').classList.add('task-completed');
    btnShare10.textContent = '·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Äº·ÄÆ';
    btnShare10.disabled = true;
    saveGameState();
    alert('Telegram ·Äê·ÄΩ·ÄÑ·Ä∫ 10 ·ÄÅ·Ä´ Share ·Äï·Äº·ÄÆ·Ä∏ 5 Token ·Äõ·Äõ·Äæ·Ä≠·Äï·Ä´·Äû·Ää·Ä∫!');
  } else {
    alert(`Share ${share10Count}/10 ·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ·Åã ·ÅÅ·ÅÄ ·ÄÅ·Ä´ ·Äï·Äº·ÄÆ·Ä∏·Äô·Äæ 5 Token Card ·Äõ·Äõ·Äæ·Ä≠·Äô·Ää·Ä∫`);
  }
});

  // Exchange System
  document.querySelectorAll('.exchange-item').forEach(button => {
  button.addEventListener('click', function() {
    const card = this.closest('.exchange-card');
    const itemName = card.querySelector('p').innerText; // ‚úÖ Item Name

    const diamond = this.getAttribute('data-diamond');
    const coinCost = this.getAttribute('data-coins');

    if(coins < coinCost) {
      alert('Coin Card ·Äô·Äú·ÄØ·Ä∂·Äú·Ä±·Ä¨·ÄÄ·Ä∫·Äï·Ä´!');
      return;
    }

    currentExchange = {diamond, coinCost, itemName};
    exchangeDetails.textContent = `${diamond} Diamond ·Ä°·Äê·ÄΩ·ÄÄ·Ä∫ ${coinCost} Coins ·Äú·Ä≠·ÄØ·Ä°·Äï·Ä∫·Äï·Ä´·Äû·Ää·Ä∫`;
    exchangeForm.style.display = 'block';
  });
});

  cancelExchange.addEventListener('click', () => {
    exchangeForm.style.display = 'none';
    currentExchange = null;
  });

  confirmExchange.addEventListener('click', () => {
    const gameId = gameIdInput.value.trim();
    const serverId = serverIdInput.value.trim();

    if(!gameId || !serverId) {
      alert('Game ID ·Äî·Äæ·ÄÑ·Ä∑·Ä∫ Server ID ·Äë·Ää·Ä∑·Ä∫·Äû·ÄΩ·ÄÑ·Ä∫·Ä∏·Äï·Ä±·Ä∏·Äï·Ä´!');
      return;
    }

    // Deduct coins
    coins -= parseInt(currentExchange.coinCost);
    coinCountElem.textContent = coins;

    // Send to Telegram
    sendToTelegram(gameId, serverId, currentExchange.diamond, currentExchange.coinCost, currentExchange.itemName);

    // Show success message
    exchangeForm.style.display = 'none';
    telegramSuccess.style.display = 'block';

    // Reset form
    gameIdInput.value = '';
    serverIdInput.value = '';
    currentExchange = null;

    saveGameState();
  });

  closeSuccess.addEventListener('click', () => {
    telegramSuccess.style.display = 'none';
  });

// Telegram Integration
function sendToTelegram(gameId, serverId, diamond, coinCost, itemName) {
  const botToken = '8094270595:AAERziCUrOYf38DMOSReu1oOSEf2LLG_qS0';
  const chatId = '@WinnerEvent';

  const message = `üîÑ ·Äú·Ä≤·Äú·Äæ·Ää·Ä∫·Äô·Äæ·ÄØ·Ä°·Äû·ÄÖ·Ä∫\n\nüì¶ Item: ${itemName}\nGame ID: ${gameId}\nServer ID: ${serverId}\nDiamond: ${diamond}\nCoins: ${coinCost}\n\nüïí ${new Date().toLocaleString()}`;

  fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({chat_id: chatId, text: message})
  }).catch(err => console.error('Telegram error:', err));
}

  // Initialize the game
  initializeGame();

  // ·Äï·Äº·Ä±·Ä¨·ÄÑ·Ä∫·Ä∏·Äô·Äö·Ä∑·Ä∫·ÄÖ·Ä¨·Äô·Äª·Ä¨·Ä∏
  const chatTexts = [
    "Event ·ÄÄ·Äî·Ä± Diamonds ·Äê·ÄΩ·Ä±·Äõ·Äö·Ä∞·Äú·Ä≠·ÄØ·ÄÄ·Ä∫·Äï·Ä´ üíú",
    "Token ·Äô·Äª·Ä¨·Ä∏·Äõ·Äõ·Äæ·Ä≠·Äõ·Äî·Ä∫ Tasks ·Äô·Äª·Ä¨·Ä∏·Äú·ÄØ·Äï·Ä∫·Äï·Ä´ ",
    "·Äú·Ä∞·Äû·ÄØ·Ä∂·Ä∏·Äô·Äª·Ä¨·Ä∏·Ä°·Ä±·Ä¨·ÄÑ·Ä∫ Share ·Äï·Ä±·Ä∏·Äï·Ä´·Ä°·ÄØ·Äî·Ä∫·Ä∏",
    "·Äî·ÄÑ·Ä∫·Äô·Äú·Ä¨·Ä∏·ÄÅ·Äª·ÄÖ·Ä∫·Äû·Ä∞·Äô·Äõ·Äæ·Ä≠·Äê·Ä¨ üòπ ",
    "·Äï·Äº·Äî·Ä∫·Äô·Äú·Ä¨·Äê·Ä≤·Ä∑·Äû·Ä∞·ÄÄ·Ä≠·ÄØ ·ÄÖ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äô·Äî·Ä±·Äï·Ä´·Äî·Ä≤·Ä∑·Äú·Ä¨·Ä∏ üíî"
  ];

  const chatTextElem = document.getElementById("chat-text");
  let chatIndex = 0;
  let charIndex = 0;

  // ·ÄÖ·Ä¨·Äõ·Ä≠·ÄØ·ÄÄ·Ä∫·Äû·Äú·Ä≠·ÄØ ·Äï·Ä±·Ä´·Ä∫·Ä°·Ä±·Ä¨·ÄÑ·Ä∫ function
  function typeText() {
    const currentText = chatTexts[chatIndex];
    if (charIndex < currentText.length) {
      chatTextElem.textContent += currentText.charAt(charIndex);
      charIndex++;
      setTimeout(typeText, 60); // ·ÄÖ·Ä¨·Äú·ÄØ·Ä∂·Ä∏·Äõ·Ä≠·ÄØ·ÄÄ·Ä∫·Äî·Äæ·ÄØ·Äî·Ä∫·Ä∏ (·Äô·Äº·Äî·Ä∫/·Äî·Äæ·Ä±·Ä∏ ·Äï·Äº·ÄÑ·Ä∫·Äú·Ä≠·ÄØ·Ä∑·Äõ)
    } else {
      // ·ÄÖ·Ä¨·Ä°·Äï·Äº·ÄÆ·Ä∏·Äõ·Ä±·Ä¨·ÄÄ·Ä∫·Äõ·ÄÑ·Ä∫ ·ÅÖ ·ÄÖ·ÄÄ·Äπ·ÄÄ·Äî·Ä∑·Ä∫·Äî·Ä≤·Ä∑ ·Äï·Äº·Ä±·Ä¨·ÄÑ·Ä∫·Ä∏
      setTimeout(changeChatText, 5000);
    }
  }

  // ·ÄÖ·Ä¨·Äï·Äº·Ä±·Ä¨·ÄÑ·Ä∫·Ä∏ function
  function changeChatText() {
    chatIndex = (chatIndex + 1) % chatTexts.length;
    chatTextElem.textContent = ""; // ·ÄÖ·Ä¨·Äõ·Äæ·ÄÑ·Ä∫·Ä∏
    charIndex = 0;
    typeText(); // ·Äî·Ä±·Ä¨·ÄÄ·Ä∫·ÄÖ·Ä¨·Äõ·Ä≠·ÄØ·ÄÄ·Ä∫
  }

  // ·ÄÖ·Äê·ÄÑ·Ä∫·Ä°·Äú·ÄØ·Äï·Ä∫·Äú·ÄØ·Äï·Ä∫
  typeText();

// ===== New Battle UI =====
const battleBtnNew = document.getElementById('battle-btn'); 
const battleScreenNew = document.getElementById('battle-screen-new');
const backBattleNew = document.getElementById('back-battle-new');
const openTokenBtn = document.getElementById('open-token-btn');
const tokenResult = document.getElementById('token-result');
const tokenResultImg = document.getElementById('token-result-img');
const tokenResultText = document.getElementById('token-result-text');
const tokenResultClose = document.getElementById('token-result-close');
const battleTriesElem = document.getElementById('battle-tries');

let battleTry = parseInt(localStorage.getItem('battleTry')) || 0;
let lastBattleTime = parseInt(localStorage.getItem('lastBattleTime')) || Date.now();
const BATTLE_LIMIT_TIME = 5 * 60 * 60 * 1000; // 5 ·Äî·Ä¨·Äõ·ÄÆ
const BATTLE_LIMIT_COUNT = 3;

function resetBattleLimit() {
  const now = Date.now();
  if (now - lastBattleTime >= BATTLE_LIMIT_TIME) {
    battleTry = 0;
    lastBattleTime = now;
    localStorage.setItem('battleTry', battleTry);
    localStorage.setItem('lastBattleTime', lastBattleTime);
  }
}

function updateBattleDisplay() {
  resetBattleLimit();
  const remainingTries = BATTLE_LIMIT_COUNT - battleTry;
  
  if (battleTry < BATTLE_LIMIT_COUNT) {
    battleTriesElem.textContent = `‚úÖ ·Äñ·Ä±·Ä¨·ÄÄ·Ä∫·ÄÅ·ÄΩ·ÄÑ·Ä∑·Ä∫ ${remainingTries} ·ÄÄ·Äº·Ä≠·Äô·Ä∫ ·ÄÄ·Äª·Äî·Ä∫·Äõ·Äæ·Ä≠·Äï·Ä´·Äû·Ää·Ä∫`;
    openTokenBtn.disabled = false;
  } else {
    battleTriesElem.textContent = `‚ùå  ·ÅÖ ·Äî·Ä¨·Äõ·ÄÆ·ÄÖ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äï·Ä´`;
    openTokenBtn.disabled = true;
  }
}

// ·ÄÖ·Ä¨·Äô·Äª·ÄÄ·Ä∫·Äî·Äæ·Ä¨·ÄÖ·Äê·ÄÑ·Ä∫·Äú·ÄØ·Äï·Ä∫·ÄÜ·Ä±·Ä¨·ÄÑ·Ä∫·ÄÅ·Äª·Ä≠·Äî·Ä∫ reset
resetBattleLimit();

// Navigation
battleBtnNew.addEventListener('click', ()=>{
  mainScreen.style.display='none';
  battleScreenNew.style.display='block';
  updateBattleDisplay();
});

backBattleNew.addEventListener('click', ()=>{
  battleScreenNew.style.display='none';
  mainScreen.style.display='block';
});

// ·Äñ·Ä±·Ä¨·ÄÄ·Ä∫ Button
openTokenBtn.addEventListener('click', ()=>{
  resetBattleLimit();
  if (battleTry >= BATTLE_LIMIT_COUNT) {
    alert('‚ùå ·ÅÖ ·Äî·Ä¨·Äõ·ÄÆ·Ä°·Äê·ÄΩ·ÄÑ·Ä∫·Ä∏ ·ÅÉ ·ÄÅ·Ä´·Äû·Ä¨ ·Äñ·Ä±·Ä¨·ÄÄ·Ä∫·ÄÅ·ÄΩ·ÄÑ·Ä∑·Ä∫·Äõ·Äæ·Ä≠·Äï·Ä´·Äû·Ää·Ä∫!');
    return;
  }

  battleTry++;
  lastBattleTime = Date.now();
  localStorage.setItem('battleTry', battleTry);
  localStorage.setItem('lastBattleTime', lastBattleTime);

  // Random Token 1/2/3/5
  const rewards = [1, 2, 3, 5];
  const reward = rewards[Math.floor(Math.random() * rewards.length)];

  tokens += reward;
  tokenCountElem.textContent = tokens;
  saveGameState();

  // Popup ·Äï·Äº
  tokenResultImg.src = 'https://iili.io/KVxjsG1.png';
  tokenResultText.textContent = `+${reward} Token Card ·Äõ·Äõ·Äæ·Ä≠·Äï·Ä´·Äû·Ää·Ä∫`;
  tokenResult.style.display = 'flex';

  // Display update
  updateBattleDisplay();
});

tokenResultClose.addEventListener('click', ()=>{
  tokenResult.style.display = 'none';
});

// ·ÅÉ·ÅÄ ·ÄÖ·ÄÄ·Äπ·ÄÄ·Äî·Ä∑·Ä∫·Äê·ÄÖ·Ä∫·ÄÅ·Ä´ ·Ä°·Äú·Ä≠·ÄØ·Ä°·Äú·Äª·Ä±·Ä¨·ÄÄ·Ä∫ ·ÄÖ·ÄÖ·Ä∫·ÄÜ·Ä±·Ä∏
setInterval(updateBattleDisplay, 30000);


// Exchange Chat Typing Text (Home style)
const exchangeTexts = [
  `Coin ·Äñ·Äº·ÄÑ·Ä∑·Ä∫ ·Äú·Ä≤·Äô·Ää·Ä∫·ÄÜ·Ä≠·ÄØ ·Äî·Äæ·Ä≠·Äï·Ä∫·Äï·Ä´ <span class="exchange-link" id="exchangeLink">·Äú·Ä≤·Äô·Ää·Ä∫</span> ‚ù§Ô∏è `,
  `Wp Pass ·ÄÄ·Ä≠·ÄØ Coin 35000 ·Äî·Ä≤·Ä∑·Äú·Ä≤·Äú·Ä≠·ÄØ·Ä∑·Äõ·Äê·Äö·Ä∫·Äî·Ä±·Ä¨·Ä∫ üíú`,
  `·Äú·Ä≤·Äñ·Ä≠·ÄØ·Ä∑ Coin ·Äô·Äú·Ä±·Ä¨·ÄÄ·Ä∫·Äõ·ÄÑ·Ä∫ Tasks ·Äô·Äª·Ä¨·Ä∏·Äî·Äæ·ÄÑ·Ä∑·Ä∫ Token Box ·ÄÄ·Äö·Ä∞·Äï·Ä´ üíõ`,
  `·Äö·ÄÅ·ÄØ Event ·ÄÄ·Ä≠·ÄØ·Äë·ÄØ·Äê·Ä∫·Äû·Ä∞·ÄÄ @Starlar1 ·Äï·Ä´ ·Äû·Ä∞·Ä∑·ÄÖ·ÄÆ ·Ä°·Äú·ÄØ·Äï·Ä∫·ÄÄ·Ä≠·ÄÖ ·Äï·Äº·Ä±·Ä¨·Äú·Ä≠·ÄØ·Ä∑·Äõ·Äï·Ä´·Äê·Äö·Ä∫ ü©µ `
];

const exchangeChatText = document.getElementById("exchange-chat-text");
let exchangeIndex = 0;
let exchangeChar = 0;

function typeExchangeText() {
  const text = exchangeTexts[exchangeIndex];
  if (exchangeChar < text.length) {
    exchangeChatText.innerHTML = text.slice(0, exchangeChar + 1);
    exchangeChar++;
    setTimeout(typeExchangeText, 60);
  } else {
    // Add click listener when finished typing
    const exchangeLink = document.getElementById("exchangeLink");
    if (exchangeLink) {
      exchangeLink.addEventListener("click", () => {
        // Exchange Screen ·ÄÄ·Ä≠·ÄØ ·Äï·Ä±·Ä´·Ä∫·Ä°·Ä±·Ä¨·ÄÑ·Ä∫·Äú·ÄØ·Äï·Ä∫·ÄÅ·Äº·ÄÑ·Ä∫·Ä∏
        mainScreen.style.display = 'none';
        exchangeScreen.style.display = 'block';
        
        // Anime and Background ·ÄÄ·Ä≠·ÄØ·Äñ·Äª·Ä±·Ä¨·ÄÄ·Ä∫·Äô·Äö·Ä∫
        document.getElementById("exchange-chat-container").style.display = "none";
        
        // Exchange items ·ÄÄ·Ä≠·ÄØ·Äï·Äº·Äô·Äö·Ä∫
        document.getElementById("exchange-items").style.display = "block";
      });
    }
    setTimeout(changeExchangeText, 4000);
  }
}

function changeExchangeText() {
  exchangeIndex = (exchangeIndex + 1) % exchangeTexts.length;
  exchangeChatText.innerHTML = "";
  exchangeChar = 0;
  typeExchangeText();
}

// ·ÄÖ·Äê·ÄÑ·Ä∫·Äú·ÄØ·Äï·Ä∫
typeExchangeText();

// Back button ·Äî·Äæ·Ä≠·Äï·Ä∫·Äõ·ÄÑ·Ä∫ Anime ·Äï·Äº·Äî·Ä∫·Äï·Äº·Äõ·Äî·Ä∫
backExchange.addEventListener('click', ()=>{
  exchangeScreen.style.display='none';
  mainScreen.style.display='block';
  
  // Anime ·ÄÄ·Ä≠·ÄØ·Äï·Äº·Äî·Ä∫·Äï·Äº·Äõ·Äî·Ä∫
  document.getElementById("exchange-chat-container").style.display = "flex";
  document.getElementById("exchange-items").style.display = "none";
});

// Menu Toggle Functionality
const menuToggle = document.getElementById('sidebar-toggle');
const menuButtons = document.getElementById('sidebar-buttons');
const menuContainer = document.querySelector('.sidebar-menu');

menuToggle.addEventListener('click', (e) => {
  e.stopPropagation();
  menuButtons.classList.toggle('show');
  
  // Toggle active class for animation
  if (menuButtons.classList.contains('show')) {
    menuToggle.classList.add('active');
  } else {
    menuToggle.classList.remove('active');
  }
});

// Close menu when clicking outside
document.addEventListener('click', (e) => {
  if (!menuContainer.contains(e.target) && menuButtons.classList.contains('show')) {
    menuButtons.classList.remove('show');
    menuToggle.classList.remove('active');
  }
});

// Prevent menu from closing when clicking inside menu buttons
menuButtons.addEventListener('click', (e) => {
  e.stopPropagation();
});

// ===== NEW SPLASH SCREEN CODE =====
document.addEventListener('DOMContentLoaded', function() {
    const splashScreen = document.getElementById('splash-screen');
    const mainScreen = document.getElementById('main-screen');
    const countdownText = document.getElementById('countdown-text');
    const enterBtn = document.getElementById('enter-btn');
    const bgMusic = document.getElementById('bg-music');

    // Main Screen ·ÄÄ·Ä≠·ÄØ ·ÄÖ·Äê·ÄÑ·Ä∫·Äê·Ä≤·Ä∑·Ä°·ÄÅ·Ä´ ·Äñ·Äª·Ä±·Ä¨·ÄÄ·Ä∫·Äë·Ä¨·Ä∏·Äô·Äö·Ä∫
    if (mainScreen) {
        mainScreen.style.display = 'none';
    }

    // ·ÄÖ·ÄÄ·Äπ·ÄÄ·Äî·Ä∑·Ä∫·Äô·Äê·ÄΩ·ÄÄ·Ä∫·Äê·Ä±·Ä¨·Ä∑ Loading... ·ÄÖ·Ä¨·Äê·Äî·Ä∫·Ä∏·Äû·Ä¨·Äï·Äº·Äô·Äö·Ä∫
    if (countdownText) {
        countdownText.textContent = "Loading...";
    }

    // ·ÅÉ ·ÄÖ·ÄÄ·Äπ·ÄÄ·Äî·Ä∑·Ä∫·Ä°·ÄÄ·Äº·Ä¨·Äô·Äæ·Ä¨ Button ·Äï·Ä±·Ä´·Ä∫·Ä°·Ä±·Ä¨·ÄÑ·Ä∫·Äú·ÄØ·Äï·Ä∫·Äô·Äö·Ä∫
    setTimeout(() => {
        if (countdownText) {
            countdownText.style.display = 'none';
        }
        if (enterBtn) {
            enterBtn.style.display = 'block';
        }
    }, 3000); // ·ÅÉ ·ÄÖ·ÄÄ·Äπ·ÄÄ·Äî·Ä∑·Ä∫·ÄÄ·Äº·Ä¨

    // Enter Button ·ÄÄ·Ä≠·ÄØ·Äî·Äæ·Ä≠·Äï·Ä∫·Äõ·ÄÑ·Ä∫
    if (enterBtn) {
        enterBtn.addEventListener('click', () => {
            // Splash Screen ·ÄÄ·Ä≠·ÄØ·Äñ·Äª·Ä±·Ä¨·ÄÄ·Ä∫
            if (splashScreen) {
                splashScreen.style.display = 'none';
            }

            // ·Äê·Ä≠·ÄØ·ÄÄ·Ä∫·Äõ·Ä≠·ÄØ·ÄÄ·Ä∫ Main Screen ·ÄÄ·Ä≠·ÄØ·Äï·Äº·Äô·Äö·Ä∫
            if (mainScreen) {
                mainScreen.style.display = 'block';
            }

            // ·Äû·ÄÆ·ÄÅ·Äª·ÄÑ·Ä∫·Ä∏·Äñ·ÄΩ·ÄÑ·Ä∑·Ä∫
            if (bgMusic) {
                bgMusic.play().catch(e => {
                    console.log('Audio play failed:', e);
                });
            }
        });
    }
});
// ===== SUPABASE CONFIGURATION (FOUR SERVERS WITH 300 USER LIMIT EACH) =====
const SUPABASE_SERVERS = {
  server1: {
    url: 'https://nrkthuuevjhhxwkhtcea.supabase.co',
    key: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5ya3RodXVldmpoaHh3a2h0Y2VhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE4OTQyNDMsImV4cCI6MjA3NzQ3MDI0M30.lFhuekPUyi58i6FR84YydZdvzYaqrCEL4uAWJLjPBqQ',
    maxUsers: 300,
    enabled: true,
    newUsers: true
  },
  server2: {
    url: 'https://bpstyyndguvfluwswctb.supabase.co',
    key: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJwc3R5eW5kZ3V2Zmx1d3N3Y3RiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE4MTgxNjcsImV4cCI6MjA3NzM5NDE2N30.p9epvaIEnqoPEoCzfhwAjJjBTpeXlSAO51zH8NnVOIY',
    maxUsers: 300,
    enabled: true,
    newUsers: true
  },
  server3: {
    url: 'https://lgqxdvvjovqtuxdahupk.supabase.co',
    key: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxncXhkdnZqb3ZxdHV4ZGFodXBrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE4MjcxNjksImV4cCI6MjA3NzQwMzE2OX0.kl1LVF1nv5N1qw-TEEZwYwmwYOlwnHEHDXscI-23uUU',
    maxUsers: 300,
    enabled: true,
    newUsers: true
  },
  // ‚úÖ NEW SERVER 4
  server4: {
    url: 'https://ydqmtegtlwtadqevptfi.supabase.co',
    key: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkcW10ZWd0bHd0YWRxZXZwdGZpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5ODM5NTcsImV4cCI6MjA3NzU1OTk1N30.Inb5ttutkulTo3ACreVjYkXx1rp-pxGRnBs2k7TX3CQ',
    maxUsers: 300,
    enabled: true,
    newUsers: true
  }
};
// Server selection variables
let currentServer = localStorage.getItem('currentServer') || 'server2';
let userCounts = JSON.parse(localStorage.getItem('userCounts')) || {
  server1: 0,
  server2: 0,
  server3: 0,
  server4: 0  // ‚úÖ NEW
};

// Initialize current Supabase client
let supabase = window.supabase.createClient(
  SUPABASE_SERVERS[currentServer].url, 
  SUPABASE_SERVERS[currentServer].key
);
// Function to check server capacity and select appropriate server
async function selectServerForNewUser() {
  try {
    // Check enabled servers that allow new users only
    const availableServers = Object.keys(SUPABASE_SERVERS).filter(server => 
      SUPABASE_SERVERS[server].enabled && SUPABASE_SERVERS[server].newUsers
    );
    
    if (availableServers.length === 0) {
      throw new Error('No servers available for new users');
    }
    
    // Check user counts for available servers
    const serverCounts = {};
    
    for (const server of availableServers) {
      try {
        const { count, error } = await window.supabase
          .createClient(SUPABASE_SERVERS[server].url, SUPABASE_SERVERS[server].key)
          .from('users')
          .select('*', { count: 'exact', head: true });
        
        serverCounts[server] = error ? userCounts[server] : (count || 0);
      } catch (error) {
        console.error(`Error checking ${server}:`, error);
        serverCounts[server] = userCounts[server];
      }
    }
    
    // Update local counts
    Object.assign(userCounts, serverCounts);
    localStorage.setItem('userCounts', JSON.stringify(userCounts));
    
    console.log('Available servers for new users:');
    availableServers.forEach(server => {
      console.log(`${server}: ${userCounts[server]}/${SUPABASE_SERVERS[server].maxUsers} users`);
    });
    
    // Find server with lowest usage that has capacity
    const serversWithCapacity = availableServers.filter(server => 
      userCounts[server] < SUPABASE_SERVERS[server].maxUsers
    );
    
    if (serversWithCapacity.length === 0) {
      throw new Error('All available servers are full (300 users each)');
    }
    
    // Select server with lowest current usage
    const selectedServer = serversWithCapacity.reduce((lowest, server) => 
      userCounts[server] < userCounts[lowest] ? server : lowest
    );
    
    return selectedServer;
    
  } catch (error) {
    console.error('Error selecting server for new user:', error);
    throw error;
  }
}

// Function to switch Supabase client
function switchSupabaseClient(server) {
  currentServer = server;
  supabase = window.supabase.createClient(
    SUPABASE_SERVERS[server].url, 
    SUPABASE_SERVERS[server].key
  );
  localStorage.setItem('currentServer', server);
  console.log('Switched to server:', server);
}
// ===== SUPABASE DATABASE FUNCTIONS =====

// Function to migrate user to a new server if original server is disabled
async function migrateUserToNewServer(user) {
  try {
    const newServer = await selectServerForNewUser();
    
    // Save user to new server
    switchSupabaseClient(newServer);
    await saveUserToSupabase(user);
    
    // Update user's server info
    user.server = newServer;
    localStorage.setItem('currentUser', JSON.stringify(user));
    localStorage.setItem('userServer', newServer);
    
    // Update user count
    userCounts[newServer]++;
    localStorage.setItem('userCounts', JSON.stringify(userCounts));
    
    console.log(`User migrated from ${user.server} to ${newServer}`);
    
  } catch (error) {
    console.error('Error migrating user:', error);
    throw new Error('User migration failed');
  }
}

// Update the saveUserToSupabase function to include server info
async function saveUserToSupabase(userData) {
  try {
    const { data, error } = await supabase
      .from('users')
      .upsert({
        user_id: userData.uid,
        display_name: userData.displayName,
        photo_url: userData.photoURL,
        tokens: userData.tokens,
        coins: userData.coins,
        crystals: userData.crystals,
        completed_tasks: userData.completedTasks,
        last_token_time: userData.lastTokenTime,
        battle_try: userData.battleTry,
        last_battle_time: userData.lastBattleTime,
        share_count: userData.shareCount,
        share10_count: userData.share10Count,
        frame_id: currentUserFrame,
        server: userData.server || currentServer, // Include server info
        last_login: userData.lastLogin,
        updated_at: new Date().toISOString()
      }, {
        onConflict: 'user_id'
      });

    if (error) throw error;
    console.log('User saved to Supabase Server:', currentServer);
    return data;
  } catch (error) {
    console.error('Error saving user to Supabase:', error);
    throw error;
  }
}
// Get user from Supabase - UPDATED WITH FRAME SUPPORT
async function getUserFromSupabase(userId) {
  try {
    const { data, error } = await supabase
      .from('users')
      .select('*')
      .eq('user_id', userId)
      .single();

    if (error && error.code !== 'PGRST116') throw error;
    
    if (data) {
      return {
        uid: data.user_id,
        displayName: data.display_name,
        photoURL: data.photo_url,
        tokens: data.tokens,
        coins: data.coins,
        crystals: data.crystals || 0, // ‚úÖ NEW
        completedTasks: data.completed_tasks,
        lastTokenTime: data.last_token_time,
        battleTry: data.battle_try,
        lastBattleTime: data.last_battle_time,
        shareCount: data.share_count,
        share10Count: data.share10_count,
        frameId: data.frame_id || 'default', // ‚úÖ NEW: Include frame_id
        lastLogin: data.last_login,
        createdAt: data.created_at,
        updatedAt: data.updated_at
      };
    }
    return null;
  } catch (error) {
    console.error('Error getting user from Supabase:', error);
    return null;
  }
}

// ===== PROFILE CIRCLE SYSTEM ===== //

// DOM Elements for Profile Circle System
const loginScreen = document.getElementById('login-screen');
const userNameInput = document.getElementById('user-name');
const profilePicUpload = document.getElementById('profile-pic-upload');
const profilePicPreview = document.getElementById('profile-pic-preview');
const defaultAvatar = document.getElementById('default-avatar');
const createAccountBtn = document.getElementById('create-account-btn');

// Profile Circle Elements
const profileCircle = document.getElementById('profile-circle');
const profileCircleImg = document.getElementById('profile-circle-img');
const profileCircleDefault = document.getElementById('profile-circle-default');

// Account Screen Elements
const accountScreen = document.getElementById('account-screen');
const closeAccountBtn = document.getElementById('close-account-btn');
const accountAvatarImg = document.getElementById('account-avatar-img');
const accountAvatarDefault = document.getElementById('account-avatar-default');
const accountNameDisplay = document.getElementById('account-name-display');
const accountIdDisplay = document.getElementById('account-id-display');
const accountTokens = document.getElementById('account-tokens');
const accountCoins = document.getElementById('account-coins');
const editProfileBtn = document.getElementById('edit-profile-btn');

// Profile Picture Upload Handler
profilePicUpload.addEventListener('change', function(e) {
  const file = e.target.files[0];
  if (file) {
    if (file.size > 2 * 1024 * 1024) {
      alert('·Äï·ÄØ·Ä∂·Ä°·Äõ·ÄΩ·Äö·Ä∫·Ä°·ÄÖ·Ä¨·Ä∏·Äû·Ää·Ä∫ 2MB ·Äë·ÄÄ·Ä∫·Äô·ÄÄ·Äº·ÄÆ·Ä∏·Äõ·Äï·Ä´!');
      return;
    }

    const reader = new FileReader();
    reader.onload = function(e) {
      profilePicPreview.src = e.target.result;
      profilePicPreview.style.display = 'block';
      defaultAvatar.style.display = 'none';
    }
    reader.readAsDataURL(file);
  }
});

// Modified Create Account Function with Loading System
createAccountBtn.addEventListener('click', async function() {
  const userName = userNameInput.value.trim();

  if (!userName) {
    alert('·ÄÄ·Äª·Ä±·Ä∏·Äá·Ä∞·Ä∏·Äï·Äº·ÄØ·Åç ·Äî·Ä¨·Äô·Ää·Ä∫·Äë·Ää·Ä∑·Ä∫·Äû·ÄΩ·ÄÑ·Ä∫·Ä∏·Äï·Ä´!');
    return;
  }

  if (userName.length < 2) {
    alert('·ÄÄ·Äª·Ä±·Ä∏·Äá·Ä∞·Ä∏·Äï·Äº·ÄØ·Åç ·Äî·Ä¨·Äô·Ää·Ä∫·Ä°·Äî·Ää·Ä∫·Ä∏·ÄÜ·ÄØ·Ä∂·Ä∏ ·ÅÇ ·Äú·ÄØ·Ä∂·Ä∏·Äë·Ää·Ä∑·Ä∫·Äï·Ä´!');
    return;
  }

  try {
    // Check if we're in edit mode
    if (createAccountBtn.textContent.includes('Update') && currentUser) {
      // UPDATE existing profile - use current server
      currentUser.displayName = userName;
      currentUser.photoURL = profilePicPreview.style.display !== 'none' ? profilePicPreview.src : null;

      // Save to current Supabase server
      await saveUserToSupabase(currentUser);
      
      // Save to localStorage
      localStorage.setItem('currentUser', JSON.stringify(currentUser));
      
      // Hide login screen
      loginScreen.style.display = 'none';
      
      // Update profile circle
      updateProfileCircle();
      
      // Reset button text
      createAccountBtn.textContent = '·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äñ·ÄΩ·ÄÑ·Ä∑·Ä∫·Äô·Ää·Ä∫';
      
      alert('Profile updated successfully!');
    } else {
      // CREATE new account - show loading
      createAccountBtn.disabled = true;
      createAccountBtn.textContent = 'Loading... ';
      
      // Select appropriate server for new user
      const selectedServer = await selectServerForNewUser();
      switchSupabaseClient(selectedServer);
      
      const userId = generate10DigitId();
      
      const userData = {
        uid: userId,
        displayName: userName,
        photoURL: profilePicPreview.style.display !== 'none' ? profilePicPreview.src : null,
        createdAt: new Date().toISOString(),
        lastLogin: new Date().toISOString(),
        tokens: 0,
        coins: 0,
        crystals: 0,
        completedTasks: {
          '3hour': false,
          'channel1': false,
          'channel2': false,
          'channel3': false,
          'channel4': false,
          'youtube': false,
          'share': false,
          'moonton': false,
          'share10': false,
          'lily': false,
          'maxdiamond': false
        },
        lastTokenTime: 0,
        battleTry: 0,
        lastBattleTime: Date.now(),
        shareCount: 0,
        share10Count: 0,
        frameId: 'default',
        server: selectedServer
      };
      
      // Save to selected Supabase server
      await saveUserToSupabase(userData);
      
      // Update user count for selected server
      userCounts[selectedServer]++;
      localStorage.setItem('userCounts', JSON.stringify(userCounts));
      
      // Save to localStorage
      localStorage.setItem('currentUser', JSON.stringify(userData));
      localStorage.setItem('userServer', selectedServer);
      
      // Set current user
      currentUser = userData;
      
      // Hide login screen
      loginScreen.style.display = 'none';
      
      // Update profile circle
      updateProfileCircle();
      
      // Show main screen after login
      const mainScreen = document.getElementById('main-screen');
      if (mainScreen) {
        mainScreen.style.display = 'block';
      }
      
      alert(`·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äñ·ÄΩ·ÄÑ·Ä∑·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ! Event ·ÄÄ·Ä≠·ÄØ·ÄÖ·Äê·ÄÑ·Ä∫·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äï·Ä´·Äï·Äº·ÄÆ·Åã\n·Äû·ÄÑ·Ä∑·Ä∫ User ID: ${userId}\nServer: ${selectedServer}`);
    }
  } catch (error) {
    console.error('Error creating/updating account:', error);
    
    // Reset button state
    createAccountBtn.disabled = false;
    createAccountBtn.textContent = '·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äñ·ÄΩ·ÄÑ·Ä∑·Ä∫·Äô·Ää·Ä∫';
    
    if (error.message.includes('full')) {
      alert('‚ùå ·ÄÜ·Ä¨·Äó·Ä¨·Äô·Äª·Ä¨·Ä∏ ·Äï·Äº·Ää·Ä∑·Ä∫·Äû·ÄΩ·Ä¨·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ! (·Äê·ÄÖ·Ä∫·ÄÜ·Ä¨·Äó·Ä¨·Äú·Äª·Äæ·ÄÑ·Ä∫ ·ÅÉ·ÅÄ·ÅÄ ·Äö·Ä±·Ä¨·ÄÄ·Ä∫·Äû·Ä¨)\n·ÄÄ·Äª·Ä±·Ä∏·Äá·Ä∞·Ä∏·Äï·Äº·ÄØ·Åç ·Äî·Ä±·Ä¨·ÄÄ·Ä∫·Äô·Äæ·Äë·Äï·Ä∫·ÄÄ·Äº·Ä≠·ÄØ·Ä∏·ÄÖ·Ä¨·Ä∏·Äï·Ä´·Åã');
    } else if (error.message.includes('No servers available')) {
      alert('‚ùå ·Äö·ÄÅ·ÄØ·Ä°·ÄÅ·Äª·Ä≠·Äî·Ä∫·Äê·ÄΩ·ÄÑ·Ä∫ ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Ä°·Äû·ÄÖ·Ä∫·Äñ·ÄΩ·ÄÑ·Ä∑·Ä∫·ÄÅ·ÄΩ·ÄÑ·Ä∑·Ä∫ ·Äô·Äõ·Äæ·Ä≠·Äï·Ä´·Åã\n·ÄÄ·Äª·Ä±·Ä∏·Äá·Ä∞·Ä∏·Äï·Äº·ÄØ·Åç ·Äî·Ä±·Ä¨·ÄÄ·Ä∫·Äô·Äæ·Äë·Äï·Ä∫·ÄÄ·Äº·Ä≠·ÄØ·Ä∏·ÄÖ·Ä¨·Ä∏·Äï·Ä´·Åã');
    } else {
      alert('·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äñ·ÄΩ·ÄÑ·Ä∑·Ä∫·Äõ·Ä¨·Äê·ÄΩ·ÄÑ·Ä∫ ·Ä°·Äô·Äæ·Ä¨·Ä∏·Äê·ÄÖ·Ä∫·ÄÅ·ÄØ·Äñ·Äº·ÄÖ·Ä∫·Äî·Ä±·Äï·Ä´·Äû·Ää·Ä∫·Åã ·ÄÄ·Äª·Ä±·Ä∏·Äá·Ä∞·Ä∏·Äï·Äº·ÄØ·Åç ·Äî·Ä±·Ä¨·ÄÄ·Ä∫·Äô·Äæ·Äë·Äï·Ä∫·ÄÄ·Äº·Ä≠·ÄØ·Ä∏·ÄÖ·Ä¨·Ä∏·Äï·Ä´·Åã');
    }
  }
});
// Generate 10-digit ID function
function generate10DigitId() {
  const min = 1000000000;
  const max = 9999999999;
  const randomId = Math.floor(Math.random() * (max - min + 1)) + min;
  return randomId.toString();
}

// Profile Circle Click Event
profileCircle.addEventListener('click', () => {
  if (currentUser) {
    showAccountScreen();
  }
});

// Close Account Screen
closeAccountBtn.addEventListener('click', () => {
  accountScreen.style.display = 'none';
});

// Show Account Screen - crystal ·Äô·Äï·Ä´·Äê·Ä±·Ä¨·Ä∑·Äï·Ä´
function showAccountScreen() {
  if (currentUser) {
    if (currentUser.photoURL) {
      accountAvatarImg.src = currentUser.photoURL;
      accountAvatarImg.style.display = 'block';
      accountAvatarDefault.style.display = 'none';
    } else {
      accountAvatarImg.style.display = 'none';
      accountAvatarDefault.style.display = 'block';
    }

    accountNameDisplay.textContent = currentUser.displayName;
    accountIdDisplay.textContent = `ID: ${currentUser.uid}`;
    accountTokens.textContent = currentUser.tokens || 0;
    accountCoins.textContent = currentUser.coins || 0;
    // accountCrystals.textContent = currentUser.crystals || 0; // ‚ùå ·Äí·ÄÆ·Äú·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏·ÄÄ·Ä≠·ÄØ·Äñ·Äö·Ä∫·Äõ·Äæ·Ä¨·Ä∏·Äï·Ä´
    
    accountScreen.style.display = 'flex';
  }
}
// Update Profile Circle
function updateProfileCircle() {
  if (currentUser) {
    if (currentUser.photoURL) {
      profileCircleImg.src = currentUser.photoURL;
      profileCircleImg.style.display = 'block';
      profileCircleDefault.style.display = 'none';
    } else {
      profileCircleImg.style.display = 'none';
      profileCircleDefault.style.display = 'block';
    }
    profileCircle.style.display = 'flex';
  } else {
    profileCircle.style.display = 'none';
  }
}

// Edit Profile Button
editProfileBtn.addEventListener('click', () => {
  accountScreen.style.display = 'none';
  loginScreen.style.display = 'flex';

  if (currentUser) {
    userNameInput.value = currentUser.displayName;

    if (currentUser.photoURL) {
      profilePicPreview.src = currentUser.photoURL;
      profilePicPreview.style.display = 'block';
      defaultAvatar.style.display = 'none';
    } else {
      profilePicPreview.style.display = 'none';
      defaultAvatar.style.display = 'block';
    }
    
    createAccountBtn.textContent = 'Update Profile';
  }
});

// Save User Data Function - UPDATED
async function saveUserData() {
  if (currentUser) {
    // Make sure these variables are defined in your global scope
    currentUser.tokens = typeof tokens !== 'undefined' ? tokens : currentUser.tokens;
    currentUser.coins = typeof coins !== 'undefined' ? coins : currentUser.coins;
    currentUser.crystals = typeof crystals !== 'undefined' ? crystals : currentUser.crystals; // ‚úÖ NEW
    currentUser.completedTasks = typeof completedTasks !== 'undefined' ? completedTasks : currentUser.completedTasks;
    currentUser.lastTokenTime = typeof lastTokenTime !== 'undefined' ? lastTokenTime : currentUser.lastTokenTime;
    currentUser.battleTry = typeof battleTry !== 'undefined' ? battleTry : currentUser.battleTry;
    currentUser.lastBattleTime = typeof lastBattleTime !== 'undefined' ? lastBattleTime : currentUser.lastBattleTime;
    currentUser.shareCount = typeof shareCount !== 'undefined' ? shareCount : currentUser.shareCount;
    currentUser.share10Count = typeof share10Count !== 'undefined' ? share10Count : currentUser.share10Count;
    currentUser.frameId = currentUserFrame; // ‚úÖ NEW: Save current frame
    currentUser.lastLogin = new Date().toISOString();

    // Save to localStorage
    localStorage.setItem('currentUser', JSON.stringify(currentUser));
    
    // Save to Supabase
    try {
      await saveUserToSupabase(currentUser);
    } catch (error) {
      console.error('Error saving to Supabase:', error);
    }
  }
}

// Modified user loading function to handle existing Server 1 users
document.addEventListener('DOMContentLoaded', async function() {
  const savedUser = localStorage.getItem('currentUser');
  const userServer = localStorage.getItem('userServer');

  if (savedUser && userServer) {
    try {
      currentUser = JSON.parse(savedUser);
      
      // Check if the saved server is still enabled
      if (SUPABASE_SERVERS[userServer] && SUPABASE_SERVERS[userServer].enabled) {
        // Switch to the user's original server (even if it's Server 1)
        switchSupabaseClient(userServer);
        console.log('Loaded existing user from:', userServer);
      } else {
        // If original server is disabled, try to migrate user
        console.log('Original server disabled, migrating user...');
        await migrateUserToNewServer(currentUser);
      }
      
      // Try to sync with Supabase
      try {
        const supabaseUser = await getUserFromSupabase(currentUser.uid);
        if (supabaseUser) {
          currentUser = {
            ...currentUser,
            ...supabaseUser
          };
          localStorage.setItem('currentUser', JSON.stringify(currentUser));
          
          if (supabaseUser.frameId && supabaseUser.frameId !== 'default') {
            currentUserFrame = supabaseUser.frameId;
            localStorage.setItem('currentUserFrame', currentUserFrame);
          }
        }
      } catch (supabaseError) {
        console.log('Using local data, Supabase sync failed:', supabaseError);
      }
      
      updateProfileCircle();
      initializeGameWithUser(currentUser);
      
    } catch (error) {
      console.error('Error loading user data:', error);
      localStorage.removeItem('currentUser');
      localStorage.removeItem('userServer');
      loginScreen.style.display = 'flex';
    }
  } else {
    loginScreen.style.display = 'flex';
  }
});
// Initialize Game with User Data - UPDATED
function initializeGameWithUser(userData) {
  // Initialize your game variables here
  if (typeof tokens !== 'undefined') tokens = userData.tokens || 0;
  if (typeof coins !== 'undefined') coins = userData.coins || 0;
  if (typeof crystals !== 'undefined') crystals = userData.crystals || 0; // ‚úÖ NEW
  if (typeof completedTasks !== 'undefined') completedTasks = userData.completedTasks || {
    '3hour': false,
    'channel1': false,
    'channel2': false,
    'channel3': false,
    'channel4': false,
    'youtube': false,
    'share': false,
    'moonton': false,
    'share10': false,
    'lily': false,
    'maxdiamond': false // ‚úÖ NEW
  };
  if (typeof lastTokenTime !== 'undefined') lastTokenTime = userData.lastTokenTime || 0;
  if (typeof battleTry !== 'undefined') battleTry = userData.battleTry || 0;
  if (typeof lastBattleTime !== 'undefined') lastBattleTime = userData.lastBattleTime || Date.now();
  if (typeof shareCount !== 'undefined') shareCount = userData.shareCount || 0;
  if (typeof share10Count !== 'undefined') share10Count = userData.share10Count || 0;
  
  // ‚úÖ NEW: Load frame from user data
  if (userData.frameId && userData.frameId !== 'default') {
    currentUserFrame = userData.frameId;
    localStorage.setItem('currentUserFrame', currentUserFrame);
  }

  // Update UI elements if they exist
  const tokenCountElem = document.getElementById('token-count');
  const coinCountElem = document.getElementById('coin-count');
  
  if (tokenCountElem) tokenCountElem.textContent = tokens;
  if (coinCountElem) coinCountElem.textContent = coins;
  
  // ‚úÖ NEW: Crystal display update
  const crystalCountElem = document.querySelector('.token-card .crystal + .count');
  if (crystalCountElem) {
    crystalCountElem.textContent = crystals;
  }

  // Update task states if function exists
  if (typeof updateTaskStates === 'function') {
    updateTaskStates();
  }

  // Start timer if function exists
  if (typeof updateTaskTimer === 'function') {
    updateTaskTimer();
  }
  
  // ‚úÖ NEW: Update profile with frame
  setTimeout(() => {
    updateProfileWithFrame();
  }, 500);
}
// Sync function for periodic data sync
async function syncWithSupabase() {
  if (currentUser) {
    try {
      await saveUserToSupabase(currentUser);
      console.log('Data synced with Supabase');
    } catch (error) {
      console.error('Sync failed:', error);
    }
  }
}

// Sync every 5 minutes
setInterval(syncWithSupabase, 5 * 60 * 1000);

// Override saveGameState if it exists
if (typeof saveGameState !== 'undefined') {
  const originalSaveGameState = saveGameState;
  saveGameState = function() {
    if (originalSaveGameState) originalSaveGameState();
    saveUserData();
  };
}
// This is completely separate from existing code

// Create Rank Button and add to sidebar
const rankBtn = document.createElement('button');
rankBtn.className = 'sidebar-btn';
rankBtn.id = 'rank-btn';
rankBtn.innerHTML = '<span>Rankings</span>';

// Add rank button to sidebar (after existing buttons)
const sidebarButtons = document.getElementById('sidebar-buttons');
sidebarButtons.appendChild(rankBtn);

// Rank System Variables
let currentUserRank = 0;
let rankSubscription = null;
let currentRankType = 'coins'; // 'coins' or 'tokens'

// Rank System DOM Elements
const rankScreen = document.getElementById('rank-screen');
const backRank = document.getElementById('back-rank');
const rankList = document.getElementById('rank-list');
const profileInfo = document.getElementById('profile-info');
const profileName = document.getElementById('profile-name');
const profileCoins = document.getElementById('profile-coins');
const profileId = document.getElementById('profile-id');
const coinsRankBtn = document.getElementById('coins-rank-btn');
const tokensRankBtn = document.getElementById('tokens-rank-btn');

// Rank System Navigation
rankBtn.addEventListener('click', () => {
  mainScreen.style.display = 'none';
  rankScreen.style.display = 'block';
  switchRankTab('coins');
});

backRank.addEventListener('click', () => {
  rankScreen.style.display = 'none';
  mainScreen.style.display = 'block';
});

// Rank Tab Event Listeners
coinsRankBtn.addEventListener('click', () => {
  switchRankTab('coins');
});

tokensRankBtn.addEventListener('click', () => {
  switchRankTab('tokens');
});

// Global variable to control loading
let currentLoading = null;

// Switch Rank Tab Function - FIXED VERSION
function switchRankTab(type) {
  currentRankType = type;
  
  // Cancel previous loading if any
  if (currentLoading) {
    currentLoading.cancel = true;
    console.log('Cancelled previous loading');
  }
  
  // Update button styles
  coinsRankBtn.classList.toggle('active', type === 'coins');
  tokensRankBtn.classList.toggle('active', type === 'tokens');
  
  // Update button backgrounds
  coinsRankBtn.style.background = type === 'coins' ? '#007bff' : 'rgba(255,255,255,0.2)';
  tokensRankBtn.style.background = type === 'tokens' ? '#007bff' : 'rgba(255,255,255,0.2)';
  
  // Clear current rankings before loading new ones
  rankList.innerHTML = '<div style="text-align: center; padding: 20px; color: white;">Loading ' + type + ' rankings...</div>';
  
  // Reload rankings with new type
  loadRankings();
}

// Load Rankings from Supabase - UPDATED WITH FRAME SUPPORT
async function loadRankings() {
  // Create loading controller
  const loadingController = { cancel: false };
  currentLoading = loadingController;
  
  try {
    let allUsers = [];
    const MAX_USERS = 300;
    
    // Get total user count
    const { count, error: countError } = await supabase
      .from('users')
      .select('*', { count: 'exact', head: true });
    
    if (countError) throw countError;
    
    const totalUsers = Math.min(count, MAX_USERS);
    
    // Show initial progress
    rankList.innerHTML = '<div style="text-align: center; padding: 20px; color: white;">Loading ' + currentRankType + ' rankings... 0/' + totalUsers + '</div>';
    
    // Load users one by one - UPDATED TO INCLUDE FRAME_ID
    for (let i = 0; i < totalUsers; i++) {
      // Check if loading was cancelled before each request
      if (loadingController.cancel) {
        console.log('Loading cancelled at user', i);
        return;
      }
      
      let userData;
      
      if (currentRankType === 'coins') {
        const { data: coinsData, error: coinsError } = await supabase
          .from('users')
          .select('user_id, display_name, coins, tokens, photo_url, frame_id') // ‚úÖ ADDED frame_id
          .order('coins', { ascending: false })
          .range(i, i);

        if (coinsError) throw coinsError;
        userData = coinsData;
      } else {
        // Token rank - order by tokens
        const { data: tokensData, error: tokensError } = await supabase
          .from('users')
          .select('user_id, display_name, coins, tokens, photo_url, frame_id') // ‚úÖ ADDED frame_id
          .order('tokens', { ascending: false })
          .range(i, i);

        if (tokensError) throw tokensError;
        userData = tokensData;
      }
      
      // Check again if cancelled after request
      if (loadingController.cancel) {
        console.log('Loading cancelled after request', i);
        return;
      }
      
      if (userData && userData.length > 0) {
        allUsers.push(userData[0]);
        
        // Update progress
        const progressElement = document.createElement('div');
        progressElement.style.textAlign = 'center';
        progressElement.style.marginBottom = '15px';
        progressElement.style.color = '#ddd';
        progressElement.style.fontSize = '14px';
        progressElement.style.background = 'rgba(0,0,0,0.5)';
        progressElement.style.padding = '8px';
        progressElement.style.borderRadius = '8px';
        progressElement.textContent = `Loading ${currentRankType} rankings... ${i + 1}/${totalUsers}`;
        
        // Clear and display current progress
        rankList.innerHTML = '';
        rankList.appendChild(progressElement);
        
        // Display what we have so far
        displayRankings(allUsers);
        
        // Small delay to show the progressive loading effect
        await new Promise(resolve => setTimeout(resolve, 30));
      }
    }
    
    // Check if cancelled before final display
    if (loadingController.cancel) {
      console.log('Loading cancelled before final display');
      return;
    }
    
    // Final display with all users
    const finalProgress = document.createElement('div');
    finalProgress.style.textAlign = 'center';
    finalProgress.style.marginBottom = '15px';
    finalProgress.style.color = '#90ee90';
    finalProgress.style.fontSize = '14px';
    finalProgress.style.background = 'rgba(0,0,0,0.5)';
    finalProgress.style.padding = '8px';
    finalProgress.style.borderRadius = '8px';
    finalProgress.textContent = `‚úÖ Complete! Loaded ${allUsers.length} users by ${currentRankType}`;
    
    rankList.innerHTML = '';
    rankList.appendChild(finalProgress);
    displayRankings(allUsers);
    
  } catch (error) {
    // Only show error if not cancelled
    if (!loadingController.cancel) {
      console.error('Error loading rankings:', error);
      rankList.innerHTML = '<div style="text-align: center; padding: 20px; color: #ff6b6b;">Error loading rankings</div>';
    }
  } finally {
    // Clear loading controller if this is the current one
    if (currentLoading === loadingController) {
      currentLoading = null;
    }
  }
}

// ‚úÖ NEW: Create Rank Avatar HTML with Frame Support (FIXED VERSION)
function createRankAvatarHtml(user, userFrame) {
  const hasFrame = userFrame && userFrame !== 'default';
  const frameClass = hasFrame ? `frame-active frame-${userFrame}` : '';

  return `
    <div class="rank-avatar ${frameClass}">
      ${user.photo_url ? 
        `<img src="${user.photo_url}" alt="${user.display_name}">` :
        `<div class="default-avatar">üë§</div>`
      }
    </div>
  `;
}

// ‚úÖ UPDATED: Display Rankings with Frame Support
function displayRankings(users) {
  if (!users || users.length === 0) {
    return;
  }

  // Remove existing rank items (keep progress element)
  const progressElement = rankList.querySelector('div:first-child');
  const existingRankItems = rankList.querySelectorAll('.rank-item');
  existingRankItems.forEach(item => item.remove());
  
  // Add new rank items
  users.forEach((user, index) => {
    const isTop1 = index === 0;
    const isTop2 = index === 1;
    const isTop3 = index === 2;
    const isCurrentUser = currentUser && user.user_id === currentUser.uid;
    const isTokenRank = currentRankType === 'tokens';
    
    let rankClass = 'rank-item';
    if (isTop1) rankClass += ' rank-top-1';
    else if (isTop2) rankClass += ' rank-top-2';
    else if (isTop3) rankClass += ' rank-top-3';
    if (isTokenRank) rankClass += ' token-rank-item';
    if (isCurrentUser) rankClass += ' current-user-rank';
    
    // Get user frame data from Supabase
    const userFrame = user.frame_id || 'default';
    
    // Create rank avatar with frame support
    const avatarHtml = createRankAvatarHtml(user, userFrame);
    
    // Display value based on current rank type
    const value = isTokenRank ? (user.tokens || 0) : (user.coins || 0);
    const valueLabel = isTokenRank ? 'Tokens' : 'Coins';
    const valueColor = isTokenRank ? '#00ff88' : 'gold';
    
    const rankItem = document.createElement('div');
    rankItem.className = rankClass;
    rankItem.innerHTML = `
      <div class="rank-position">#${index + 1}</div>
      ${avatarHtml}
      <div class="rank-details">
        <div class="rank-name">${user.display_name || 'Anonymous'}</div>
        <div class="rank-coins" style="color: ${valueColor}">${value} ${valueLabel}</div>
        <div class="rank-id">ID: ${user.user_id}</div>
      </div>
    `;
    
    rankList.appendChild(rankItem);
  });
}
// Update Profile Info Display - MODIFIED
function updateProfileInfo() {
  if (currentUser) {
    profileName.textContent = currentUser.displayName;
    profileCoins.textContent = `${currentUser.coins || 0} Coins`;
    // Show full 10-digit ID instead of shortened version
    profileId.textContent = `ID: ${currentUser.uid}`;
    profileInfo.style.display = 'block';
  } else {
    profileInfo.style.display = 'none';
  }
}

// Update Rank in Database
async function updateUserRank() {
  if (!currentUser) return;
  
  try {
    // Update rank table
    const { error } = await supabase
      .from('rank')
      .upsert({
        id: currentUser.uid,
        name: currentUser.displayName,
        coins: currentUser.coins || 0,
        tokens: currentUser.tokens || 0,
        avatar: currentUser.photoURL,
        updated_at: new Date().toISOString()
      }, {
        onConflict: 'id'
      });

    if (error) {
      console.log('Note: Rank table might not exist, continuing without rank update');
      return;
    }
    
    console.log('Rank updated successfully');
  } catch (error) {
    console.log('Rank update skipped (table might not exist):', error);
  }
}

// Real-time updates for rankings
function setupRealTimeRankings() {
  try {
    rankSubscription = supabase
      .channel('rank-updates')
      .on('postgres_changes', 
        { 
          event: '*', 
          schema: 'public', 
          table: 'users' 
        }, 
        (payload) => {
          // Reload rankings when user data changes
          if (rankScreen.style.display === 'block') {
            loadRankings();
          }
          // Update profile info if current user data changed
          if (currentUser && payload.new && payload.new.user_id === currentUser.uid) {
            updateProfileInfo();
          }
        }
      )
      .subscribe();

    console.log('Real-time rankings setup complete');
  } catch (error) {
    console.log('Real-time rankings not available:', error);
  }
}

// Initialize Rank System
function initializeRankSystem() {
  if (currentUser) {
    updateProfileInfo();
    updateUserRank();
  }
  
  // Set up real-time updates
  setupRealTimeRankings();
  
  // Auto-refresh rankings every 30 seconds when rank screen is open
  setInterval(() => {
    if (rankScreen.style.display === 'block') {
      loadRankings();
    }
  }, 30000);
  
  console.log('Rank system initialized');
}

// Monitor coin changes and update display
function monitorCoinChanges() {
  // Override the coin update function
  const originalCoinUpdate = () => {
    if (tokenCountElem) tokenCountElem.textContent = tokens;
    if (coinCountElem) coinCountElem.textContent = coins;
  };
  
  // Create a new function that updates both coins and profile info
  window.updateCoinDisplay = function() {
    originalCoinUpdate();
    updateProfileInfo();
    if (currentUser) {
      updateUserRank();
    }
  };
  
  // Replace direct coin updates with our new function
  // This doesn't modify existing code, just provides an alternative
  console.log('Coin change monitor activated');
}

// Start Rank System when page loads
document.addEventListener('DOMContentLoaded', function() {
  // Wait a bit for everything to initialize
  setTimeout(() => {
    if (currentUser) {
      initializeRankSystem();
      monitorCoinChanges();
    }
    
    // Also initialize when user logs in later
    const originalCreateAccount = createAccountBtn.onclick;
    createAccountBtn.onclick = async function(e) {
      if (originalCreateAccount) {
        await originalCreateAccount.call(this, e);
      }
      // After login, initialize rank system
      setTimeout(() => {
        if (currentUser) {
          initializeRankSystem();
          monitorCoinChanges();
        }
      }, 1000);
    };
  }, 2000);
});

// Manual refresh function (can be called from console)
window.refreshRankings = function() {
  loadRankings();
  updateProfileInfo();
};

console.log('Rank System loaded successfully!');

// ===== WINNER SCREEN FUNCTIONALITY =====

// DOM Elements for Winner Screen
const winnerBtn = document.getElementById('winner-btn');
const winnerScreen = document.getElementById('winner-screen');
const backWinner = document.getElementById('back-winner');

// Winner Screen Navigation
winnerBtn.addEventListener('click', () => {
  mainScreen.style.display = 'none';
  winnerScreen.style.display = 'block';
});

backWinner.addEventListener('click', () => {
  winnerScreen.style.display = 'none';
  mainScreen.style.display = 'block';
});

// ================================
// üéÉ HALLOWEEN BOX FULL SCRIPT üéÉ
// ================================

// DOM Elements
const halloweenBtn = document.getElementById('halloween-btn');
const halloweenScreen = document.getElementById('halloween-screen');
const backHalloween = document.getElementById('back-halloween');
const openHalloweenBtn = document.getElementById('open-halloween-btn');
const levelUpBtn = document.getElementById('level-up-btn');
const halloweenStatus = document.getElementById('halloween-status');
const levelUpCost = document.getElementById('level-up-cost');
const halloweenBoxImage = document.getElementById('halloween-box-image');

// Halloween Box State
let halloweenShareCount = parseInt(localStorage.getItem('halloweenShareCount')) || 0;
let halloweenLastOpenTime = parseInt(localStorage.getItem('halloweenLastOpenTime')) || 0;
let halloweenBoxLevel = parseInt(localStorage.getItem('halloweenBoxLevel')) || 1;
const HALLOWEEN_COOLDOWN = 60 * 60 * 1000; // 1 hour cooldown

// Box Images
const boxImages = {
  1: 'https://i.ibb.co/DDB3QSqT/Grid-Art-20251019-184913232.png',
  2: 'https://i.ibb.co/d3HywXr/Grid-Art-20251019-184943138.png',
  3: 'https://i.ibb.co/4wDVgfXx/Grid-Art-20251019-185015164.png',
  4: 'https://i.ibb.co/Cpt43RKJ/Grid-Art-20251019-185046966.png'
};

// Reward Ranges
const rewardRanges = {
  1: { tokens: { min: 1, max: 2 }, coins: { min: 10, max: 20 }, crystals: { min: 10, max: 20 } },
  2: { tokens: { min: 2, max: 3 }, coins: { min: 20, max: 30 }, crystals: { min: 20, max: 30 } },
  3: { tokens: { min: 3, max: 4 }, coins: { min: 30, max: 40 }, crystals: { min: 30, max: 40 } },
  4: { tokens: { min: 5, max: 6 }, coins: { min: 50, max: 60 }, crystals: { min: 50, max: 60 } }
};

// Level Up Costs
const levelUpCosts = { 2: 300, 3: 700, 4: 1500 };

// Navigation
halloweenBtn.addEventListener('click', () => {
  mainScreen.style.display = 'none';
  halloweenScreen.style.display = 'block';
  updateHalloweenDisplay();
});

backHalloween.addEventListener('click', () => {
  halloweenScreen.style.display = 'none';
  mainScreen.style.display = 'block';
});

// ================================
// üéÅ Update Display
// ================================
function updateHalloweenDisplay() {
  const now = Date.now();
  const timeRemaining = HALLOWEEN_COOLDOWN - (now - halloweenLastOpenTime);

  // Update box image
  halloweenBoxImage.innerHTML = `<img src="${boxImages[halloweenBoxLevel]}" alt="Box Level ${halloweenBoxLevel}" style="width:100%;height:100%;">`;

  // Level cost
  if (halloweenBoxLevel < 4) {
    const nextLevel = halloweenBoxLevel + 1;
    levelUpCost.textContent = `Level ${nextLevel} ·Äê·ÄÑ·Ä∫·Äõ·Äî·Ä∫: ${levelUpCosts[nextLevel]} Coins`;
    levelUpBtn.style.display = 'block';
  } else {
    levelUpCost.textContent = 'Box Level ·Ä°·Äô·Äº·ÄÑ·Ä∑·Ä∫·ÄÜ·ÄØ·Ä∂·Ä∏·Äû·Ä≠·ÄØ·Ä∑·Äõ·Ä±·Ä¨·ÄÄ·Ä∫·Äõ·Äæ·Ä≠·Äï·Ä´·Äï·Äº·ÄÆ!';
    levelUpBtn.style.display = 'none';
  }

  // Status + Button
  if (timeRemaining > 0) {
    // üïí During cooldown ‚Üí No Share / No Open
    const minutes = Math.floor(timeRemaining / 60000);
    const seconds = Math.floor((timeRemaining % 60000) / 1000);
    halloweenStatus.innerHTML = `
      <div style="color:#ffa500;">‚è≥ ·Äî·Ä±·Ä¨·ÄÄ·Ä∫·Äë·Äï·Ä∫·Äñ·Ä±·Ä¨·ÄÄ·Ä∫·Äõ·Äî·Ä∫ ${minutes} ·Äô·Ä≠·Äî·ÄÖ·Ä∫ ${seconds} ·ÄÖ·ÄÄ·Äπ·ÄÄ·Äî·Ä∑·Ä∫ ·ÄÄ·Äª·Äî·Ä∫·Äï·Ä´·Äû·Ää·Ä∫</div>
      <div style="font-size:12px;margin-top:5px;">Box Level: ${halloweenBoxLevel}</div>`;
    openHalloweenBtn.textContent = '‚è≥ ·ÄÖ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·ÄÜ·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏·Äî·Ä±·Äï·Ä´·Äû·Ää·Ä∫...';
    openHalloweenBtn.disabled = true;
    openHalloweenBtn.style.background = '#555';
    openHalloweenBtn.style.fontSize = '15px';
    openHalloweenBtn.style.padding = '9px 13px';
    openHalloweenBtn.style.borderRadius = '8px';
    openHalloweenBtn.style.color = '#ccc';
    return;
  }

  if (halloweenShareCount < 3) {
    // üî∏ Need to Share First
    halloweenStatus.innerHTML = `
      <div style="color:#ff6b6b;">‚ùå ·Äñ·Ä±·Ä¨·ÄÄ·Ä∫·Äõ·Äî·Ä∫·Ä°·Äê·ÄΩ·ÄÄ·Ä∫ Share ${3 - halloweenShareCount} ·ÄÅ·Ä´ ·Äú·Ä≠·ÄØ·Ä°·Äï·Ä∫·Äï·Ä´·Äû·Ää·Ä∫</div>
      <div style="font-size:12px;margin-top:5px;">Box Level: ${halloweenBoxLevel}</div>`;
    openHalloweenBtn.textContent = 'üì¢ Share ·Äú·ÄØ·Äï·Ä∫·Äõ·Äî·Ä∫';
    openHalloweenBtn.disabled = false;
    openHalloweenBtn.style.background = '#ff6600';
    openHalloweenBtn.style.fontSize = '16px';
    openHalloweenBtn.style.padding = '10px 14px';
    openHalloweenBtn.style.borderRadius = '10px';
    openHalloweenBtn.style.color = '#fff';
    openHalloweenBtn.style.border = 'none';
    openHalloweenBtn.style.cursor = 'pointer';
  } else {
    // ‚úÖ Ready to Open
    halloweenStatus.innerHTML = `
      <div style="color:#90ee90;">‚úÖ ·Äñ·Ä±·Ä¨·ÄÄ·Ä∫·ÄÅ·ÄΩ·ÄÑ·Ä∑·Ä∫·Äõ·Äæ·Ä≠·Äï·Ä´·Äû·Ää·Ä∫!</div>
      <div style="font-size:12px;margin-top:5px;">Box Level: ${halloweenBoxLevel}</div>`;
    openHalloweenBtn.textContent = 'üéÉ Box ·Äñ·Ä±·Ä¨·ÄÄ·Ä∫·Äô·Ää·Ä∫';
    openHalloweenBtn.disabled = false;
    openHalloweenBtn.style.background = '#00cc66';
    openHalloweenBtn.style.fontSize = '16px';
    openHalloweenBtn.style.padding = '10px 14px';
    openHalloweenBtn.style.borderRadius = '10px';
    openHalloweenBtn.style.color = '#fff';
    openHalloweenBtn.style.border = 'none';
    openHalloweenBtn.style.cursor = 'pointer';
  }
}

// Random Reward Generator
function getRandomReward(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

// ================================
// üîò Main Button Action
// ================================
openHalloweenBtn.addEventListener('click', () => {
  const now = Date.now();
  const timeRemaining = HALLOWEEN_COOLDOWN - (now - halloweenLastOpenTime);

  // ‚è≥ Prevent actions during cooldown
  if (timeRemaining > 0) {
    alert('‚è≥ ·Äî·Ä±·Ä¨·ÄÄ·Ä∫·Äë·Äï·Ä∫·Äñ·Ä±·Ä¨·ÄÄ·Ä∫·Äõ·Äî·Ä∫·Ä°·ÄÅ·Äª·Ä≠·Äî·Ä∫·Äô·Äï·Äº·Ää·Ä∑·Ä∫·Äû·Ä±·Ä∏·Äï·Ä´·Åã ·ÄÖ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·ÄÜ·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏·Äï·Ä´·Åã');
    return;
  }

  // Need 3 shares first
  if (halloweenShareCount < 3) {
    window.open(
      'https://t.me/share/url?url=https://starlar1.github.io/Starlar-Company-Event-/&text=üéÉ Halloween Event! MLBB Diamonds ·Äô·Äª·Ä¨·Ä∏·ÄÄ·Ä≠·ÄØ ·Ä°·ÄÅ·Äô·Ä≤·Ä∑·Äõ·Äö·Ä∞·Äú·Ä≠·ÄØ·ÄÄ·Ä∫·Äï·Ä´ üíé',
      '_blank'
    );
    halloweenShareCount++;
    localStorage.setItem('halloweenShareCount', halloweenShareCount);
    alert(`Share ${halloweenShareCount}/3 ·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ${halloweenShareCount >= 3 ? " ‚úÖ ·Äö·ÄÅ·ÄØ ·Äñ·Ä±·Ä¨·ÄÄ·Ä∫·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äï·Ä´·Äï·Äº·ÄÆ!" : "·Åã ·ÅÉ ·ÄÅ·Ä´ ·Äï·Äº·ÄÆ·Ä∏·Äô·Äæ ·Äñ·Ä±·Ä¨·ÄÄ·Ä∫·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äô·Ää·Ä∫·Åã"}`);
    updateHalloweenDisplay();
    return;
  }

  // Reset share + update time
  halloweenShareCount = 0;
  halloweenLastOpenTime = now;
  localStorage.setItem('halloweenShareCount', 0);
  localStorage.setItem('halloweenLastOpenTime', now);

  // Random reward type (only one)
  const r = rewardRanges[halloweenBoxLevel];
  const rewardTypes = ['tokens', 'coins', 'crystals'];
  const randomType = rewardTypes[Math.floor(Math.random() * rewardTypes.length)];

  let rewardTokens = 0;
  let rewardCoins = 0;
  let rewardCrystals = 0;

  if (randomType === 'tokens') {
    rewardTokens = getRandomReward(r.tokens.min, r.tokens.max);
    tokens += rewardTokens;
    alert(`üéÉ Halloween Box ·Äñ·Ä±·Ä¨·ÄÄ·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ!\n\nüéÅ ·Äõ·Äõ·Äæ·Ä≠·Äû·Ä±·Ä¨·ÄÜ·ÄØ: ${rewardTokens} Token Cards`);
  } else if (randomType === 'coins') {
    rewardCoins = getRandomReward(r.coins.min, r.coins.max);
    coins += rewardCoins;
    alert(`üéÉ Halloween Box ·Äñ·Ä±·Ä¨·ÄÄ·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ!\n\nüéÅ ·Äõ·Äõ·Äæ·Ä≠·Äû·Ä±·Ä¨·ÄÜ·ÄØ: ${rewardCoins} Coins`);
  } else {
    rewardCrystals = getRandomReward(r.crystals.min, r.crystals.max);
    crystals += rewardCrystals;
    alert(`üéÉ Halloween Box ·Äñ·Ä±·Ä¨·ÄÄ·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ!\n\nüéÅ ·Äõ·Äõ·Äæ·Ä≠·Äû·Ä±·Ä¨·ÄÜ·ÄØ: ${rewardCrystals} Crystals`);
  }

  // Update UI
  if (tokenCountElem) tokenCountElem.textContent = tokens;
  if (coinCountElem) coinCountElem.textContent = coins;
  const crystalCountElem = document.querySelector('.token-card .crystal + .count');
  if (crystalCountElem) crystalCountElem.textContent = crystals;

  saveGameState();
  updateHalloweenDisplay();
});

// ================================
// ‚¨ÜÔ∏è Level Up
// ================================
levelUpBtn.addEventListener('click', () => {
  if (halloweenBoxLevel >= 4) {
    alert('Box Level ·Ä°·Äô·Äº·ÄÑ·Ä∑·Ä∫·ÄÜ·ÄØ·Ä∂·Ä∏·Äû·Ä≠·ÄØ·Ä∑·Äõ·Ä±·Ä¨·ÄÄ·Ä∫·Äõ·Äæ·Ä≠·Äï·Ä´·Äï·Äº·ÄÆ!');
    return;
  }

  const next = halloweenBoxLevel + 1;
  const cost = levelUpCosts[next];
  if (coins < cost) {
    alert(`Coins ·Äô·Äú·ÄØ·Ä∂·Äú·Ä±·Ä¨·ÄÄ·Ä∫·Äï·Ä´! (${cost} ·Äú·Ä≠·ÄØ·Ä°·Äï·Ä∫)`);
    return;
  }

  if (confirm(`Level ${next} ·Äû·Ä≠·ÄØ·Ä∑·Äê·ÄÑ·Ä∫·Äõ·Äî·Ä∫ ${cost} Coins ·Äû·ÄØ·Ä∂·Ä∏·Äô·Ää·Ä∫·Åã ·Äû·Ä±·ÄÅ·Äª·Ä¨·Äï·Ä´·Äû·Äú·Ä¨·Ä∏?`)) {
    coins -= cost;
    halloweenBoxLevel = next;
    localStorage.setItem('halloweenBoxLevel', halloweenBoxLevel);
    coinCountElem.textContent = coins;
    saveGameState();
    alert(`üéâ Box Level ${next} ·Äû·Ä≠·ÄØ·Ä∑·Äê·ÄÑ·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ!`);
    updateHalloweenDisplay();
  }
});

// Auto refresh display
setInterval(() => {
  if (halloweenScreen.style.display === 'block') updateHalloweenDisplay();
}, 1000);

// ===============================
// ===============================
// üé® FRAME SYSTEM FULL SCRIPT (UPDATED)
// ===============================
// Frame System Variables
let currentUserFrame = localStorage.getItem('currentUserFrame') || 'default';

// Frame System DOM Elements
const editFrameBtn = document.getElementById('edit-frame-btn');
const frameScreen = document.getElementById('frame-screen');
const closeFrameBtn = document.getElementById('close-frame-btn');
const userCrystalBalance = document.getElementById('user-crystal-balance');

// Frame Images (PNG with transparency)
const frameImages = {
  '1': 'https://i.ibb.co/QV84J2p/Grid-Art-20251021-174653561.png',
  '2': 'https://i.ibb.co/WvbrkX5Q/Grid-Art-20251021-174724409.png', 
  '3': 'https://i.ibb.co/4gmzsRv1/Grid-Art-20251021-185346595.png',
  '4': 'https://i.ibb.co/tTHqDxgL/Grid-Art-20251021-185427346.png',
  '5': 'https://i.ibb.co/b5yDXZ3X/Grid-Art-20251021-191526385.png',
  '6': 'https://i.ibb.co/fdDyXb4f/Grid-Art-20251021-191206825.png',
  // NEW FRAMES
  '7': 'https://i.ibb.co/WvhQNXV0/Grid-Art-20251022-203314542.png', // Free
  '8': 'https://i.ibb.co/YFPQqWLT/Grid-Art-20251022-203053097.png', // 200 Crystal
  '9': 'https://i.ibb.co/CKHjc9Yv/Grid-Art-20251022-203131283.png', // 300 Crystal
  '10': 'https://i.ibb.co/3YPVPzBQ/Grid-Art-20251022-203203551.png', // 300 Crystal
  '11': 'https://i.ibb.co/5xf2gynX/Grid-Art-20251022-203239723.png', // 100 Crystal
  '12': 'https://i.ibb.co/bRBtyRZz/Grid-Art-20251022-202649925.png', // 200 Crystal
  '13': 'https://i.ibb.co/LwVZZ8k/Grid-Art-20251022-202724485.png', // 100 Crystal
  '14': 'https://i.ibb.co/dwKFfgZP/bceab2c603a6123d4e7f8c3189cdb77f.gif', // 500 Crystal
  // NEW FRAMES (·Ä°·Äû·ÄÖ·Ä∫)
  '15': 'https://i.ibb.co/7tbQSvR5/Grid-Art-20251023-110346131.png', // 100 Crystal
  '16': 'https://i.ibb.co/TByr3SP5/Grid-Art-20251023-110424499.png', // 100 Crystal
  '17': 'https://i.ibb.co/yc8Y4Qsp/Grid-Art-20251023-110503741.png', // 200 Crystal
  '18': 'https://i.ibb.co/7dyyNNWC/Grid-Art-20251023-110615606.png', // 100 Crystal
  '19': 'https://i.ibb.co/Gfcnkmsf/Grid-Art-20251023-110704674.png',  // Free
  // ·Ä°·Äû·ÄÖ·Ä∫·Äë·Äï·Ä∫·Äë·Ää·Ä∑·Ä∫·Äô·Ää·Ä∑·Ä∫ Frame ·Äô·Äª·Ä¨·Ä∏
  '20': 'https://i.ibb.co/gFtR2ctd/Grid-Art-20251023-123518546.png', // 100 Crystal
  '21': 'https://i.ibb.co/hxkQX8gr/Grid-Art-20251023-123550710.png', // 100 Crystal
  '22': 'https://i.ibb.co/7JcHyRmC/Grid-Art-20251023-123620592.png', // 100 Crystal
  '23': 'https://i.ibb.co/tp6K9jtJ/Grid-Art-20251023-123654397.png', // 100 Crystal
  '24': 'https://i.ibb.co/jkFL2LVM/Grid-Art-20251023-123726543.png', // 100 Crystal
  '25': 'https://i.ibb.co/N2sMqPZB/Grid-Art-20251023-123800635.png', // 200 Crystal
  '26': 'https://i.ibb.co/HLNH2K6B/Grid-Art-20251023-123846894.png', // 200 Crystal
  '27': 'https://i.ibb.co/F4Pmw0g4/Grid-Art-20251023-123923903.png'  // Free
};

// Frame costs
const frameCosts = {
  '1': 100,
  '2': 100,
  '3': 200,
  '4': 200,
  '5': 200,
  '6': 300,
  // NEW FRAME COSTS
  '7': 0,    // Free
  '8': 200,  // 200 Crystal
  '9': 300,  // 300 Crystal
  '10': 300, // 300 Crystal
  '11': 100, // 100 Crystal
  '12': 200, // 200 Crystal
  '13': 100, // 100 Crystal
  '14': 500, // 500 Crystal
  // NEW FRAME COSTS (·Ä°·Äû·ÄÖ·Ä∫)
  '15': 100, // 100 Crystal
  '16': 100, // 100 Crystal
  '17': 200, // 200 Crystal
  '18': 100, // 100 Crystal
  '19': 0,   // Free
  // ·Ä°·Äû·ÄÖ·Ä∫·Äë·Äï·Ä∫·Äë·Ää·Ä∑·Ä∫·Äô·Ää·Ä∑·Ä∫ Frame Costs ·Äô·Äª·Ä¨·Ä∏
  '20': 100, // 100 Crystal
  '21': 100, // 100 Crystal
  '22': 100, // 100 Crystal
  '23': 100, // 100 Crystal
  '24': 100, // 100 Crystal
  '25': 200, // 200 Crystal
  '26': 200, // 200 Crystal
  '27': 0    // Free
};

// Frame System Event Listeners
editFrameBtn.addEventListener('click', () => {
  accountScreen.style.display = 'none';
  frameScreen.style.display = 'block';
  updateFrameButtons();
  updateUserCrystalBalance();
});

closeFrameBtn.addEventListener('click', () => {
  frameScreen.style.display = 'none';
  accountScreen.style.display = 'flex';
});

// ‚úÖ NEW: Update user crystal balance display
function updateUserCrystalBalance() {
  if (userCrystalBalance) {
    userCrystalBalance.textContent = crystals;
  }
}

// Update Frame Buttons - NEW FUNCTION
function updateFrameButtons() {
  const frameButtons = document.querySelectorAll('.frame-action-btn');
  
  frameButtons.forEach(button => {
    const frameId = button.getAttribute('data-frame');
    
    if (currentUserFrame === frameId) {
      // Currently equipped frame
      button.textContent = '·Äñ·Äº·ÄØ·Äê·Ä∫·Äô·Ää·Ä∫';
      button.style.background = '#dc3545';
    } else if (hasPurchasedFrame(frameId)) {
      // Purchased but not equipped
      button.textContent = '·Äê·Äï·Ä∫·Äô·Ää·Ä∫';
      button.style.background = '#28a745';
    } else {
      // Not purchased
      button.textContent = `·ÅÄ·Äö·Ä∫·Äô·Ää·Ä∫ (${frameCosts[frameId]})`;
      button.disabled = crystals < frameCosts[frameId];
      button.style.background = crystals >= frameCosts[frameId] ? '#007bff' : '#6c757d';
    }
  });
}

// Check if user has purchased a frame
function hasPurchasedFrame(frameId) {
  const purchasedFrames = JSON.parse(localStorage.getItem('purchasedFrames') || '[]');
  return purchasedFrames.includes(frameId);
}

// Save purchased frame
function savePurchasedFrame(frameId) {
  const purchasedFrames = JSON.parse(localStorage.getItem('purchasedFrames') || '[]');
  if (!purchasedFrames.includes(frameId)) {
    purchasedFrames.push(frameId);
    localStorage.setItem('purchasedFrames', JSON.stringify(purchasedFrames));
  }
}

// Get all purchased frames
function getPurchasedFrames() {
  return JSON.parse(localStorage.getItem('purchasedFrames') || '[]');
}

// Frame Button Click Handler - UPDATED WITH SUPABASE SYNC
document.addEventListener('click', function(e) {
  if (e.target.classList.contains('frame-action-btn')) {
    const frameId = e.target.getAttribute('data-frame');
    const frameCost = frameCosts[frameId];
    
    if (currentUserFrame === frameId) {
      // Remove frame
      if (confirm('Frame ·ÄÄ·Ä≠·ÄØ·Äï·Äº·Äî·Ä∫·Äñ·Äº·ÄØ·Äê·Ä∫·Äô·Ää·Ä∫·Åã ·Äû·Ä±·ÄÅ·Äª·Ä¨·Äï·Ä´·Äû·Äú·Ä¨·Ä∏?')) {
        currentUserFrame = 'default';
        localStorage.setItem('currentUserFrame', currentUserFrame);
        updateProfileWithFrame();
        updateFrameButtons();
        alert('Frame ·ÄÄ·Ä≠·ÄØ·Ä°·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äº·ÄÑ·Ä∫·ÄÖ·ÄΩ·Ä¨·Äñ·Äº·ÄØ·Äê·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ!');
      }
    } else if (hasPurchasedFrame(frameId)) {
      // Equip frame
      currentUserFrame = frameId;
      localStorage.setItem('currentUserFrame', currentUserFrame);
      updateProfileWithFrame();
      updateFrameButtons();
      alert(`Frame ${frameId} ·ÄÄ·Ä≠·ÄØ·Ä°·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äº·ÄÑ·Ä∫·ÄÖ·ÄΩ·Ä¨·Äê·Äï·Ä∫·ÄÜ·ÄÑ·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ!`);
    } else {
      // Purchase frame
      if (crystals < frameCost) {
        alert(`Crystals ·Äô·Äú·ÄØ·Ä∂·Äú·Ä±·Ä¨·ÄÄ·Ä∫·Äï·Ä´! ${frameCost} Crystals ·Äú·Ä≠·ÄØ·Ä°·Äï·Ä∫·Äï·Ä´·Äû·Ää·Ä∫·Åã`);
        return;
      }
      
      if (confirm(`Frame ${frameId} ·ÄÄ·Ä≠·ÄØ ${frameCost} Crystals ·Äñ·Äº·ÄÑ·Ä∑·Ä∫ ·ÅÄ·Äö·Ä∫·Äö·Ä∞·Äô·Ää·Ä∫·Åã ·Äû·Ä±·ÄÅ·Äª·Ä¨·Äï·Ä´·Äû·Äú·Ä¨·Ä∏?`)) {
        crystals -= frameCost;
        const crystalCountElem = document.querySelector('.token-card .crystal + .count');
        if (crystalCountElem) crystalCountElem.textContent = crystals;
        
        savePurchasedFrame(frameId);
        currentUserFrame = frameId;
        localStorage.setItem('currentUserFrame', currentUserFrame);
        updateProfileWithFrame();
        saveGameState();
        updateUserCrystalBalance();
        updateFrameButtons();
        
        alert(`Frame ${frameId} ·ÄÄ·Ä≠·ÄØ·Ä°·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äº·ÄÑ·Ä∫·ÄÖ·ÄΩ·Ä¨ ·ÅÄ·Äö·Ä∫·Äö·Ä∞·Äï·Äº·ÄÆ·Ä∏ ·Äê·Äï·Ä∫·ÄÜ·ÄÑ·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ!`);
      }
    }
  }
});

// ‚úÖ UPDATE PROFILE WITH FRAME (FIXED VERSION - PROFILE CIRCLES)
function updateProfileWithFrame() {
  const accountAvatar = document.querySelector('.account-avatar');
  if (accountAvatar) {
    if (currentUserFrame !== 'default') {
      const frameImg = frameImages[currentUserFrame];
      const profileImg = currentUser?.photoURL || '';

      accountAvatar.innerHTML = `
        <div style="position: relative; width: 100px; height: 100px; margin: 0 auto;">
          <!-- Background Box (·Ä°·Ä±·Ä¨·ÄÄ·Ä∫·ÄÜ·ÄØ·Ä∂·Ä∏) -->
          <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;
              background: rgba(255,255,255,0.1); border: 2px solid gold; border-radius: 50% !important; z-index: 0;"></div>

          <!-- Profile Picture (·Ä°·Äú·Äö·Ä∫) -->
          ${profileImg ? 
            `<img src="${profileImg}" alt="Profile"
              style="position: absolute; top: 4px; left: 4px; width: 92px; height: 92px;
              object-fit: cover; border-radius: 50% !important; z-index: 1;">` :
            `<div style="position: absolute; top: 4px; left: 4px; width: 92px; height: 92px;
              background: rgba(255,255,255,0.3); display: flex; align-items: center;
              justify-content: center; font-size: 24px; border-radius: 50% !important; z-index: 1;">üë§</div>`
          }

          <!-- Frame (·Ä°·Äï·Ä±·Ä´·Ä∫·Äò·ÄÄ·Ä∫·Äë·ÄΩ·ÄÄ·Ä∫·Ä°·Ä±·Ä¨·ÄÑ·Ä∫) -->
          <img src="${frameImg}" alt="Frame"
            style="position: absolute; top: -15px; left: -15px; width: 130px; height: 130px;
            object-fit: contain; z-index: 2; pointer-events: none;">
        </div>
      `;
    } else {
      accountAvatar.innerHTML = currentUser?.photoURL
        ? `<img src="${currentUser.photoURL}" alt="Profile"
            style="width: 100%; height: 100%; object-fit: cover; border-radius: 50% !important;">`
        : '<div class="default-avatar" style="border-radius: 50% !important;">üë§</div>';
    }
  }

  // ‚úÖ profile-circle section (·Ä°·Äï·Ä±·Ä´·Ä∫·Ää·Ä¨·Äú·Ä±·Ä∏·Äú·Ää·Ä∫·Ä∏ ·Ä°·Äê·Ä∞·Äê·Ä∞ logic)
  const profileCircle = document.getElementById('profile-circle');
  if (profileCircle) {
    if (currentUserFrame !== 'default') {
      const frameImg = frameImages[currentUserFrame];
      const profileImg = currentUser?.photoURL || '';

      profileCircle.innerHTML = `
        <div style="position: relative; width: 40px; height: 40px;">
          <!-- Background Box -->
          <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;
              background: rgba(255,255,255,0.1); border: 1px solid gold; border-radius: 50% !important; z-index: 0;"></div>

          <!-- Profile -->
          ${profileImg ?
            `<img src="${profileImg}" alt="Profile"
              style="position: absolute; top: 2px; left: 2px; width: 36px; height: 36px;
              object-fit: cover; border-radius: 50% !important; z-index: 1;">` :
            `<div style="position: absolute; top: 2px; left: 2px; width: 36px; height: 36px;
              background: rgba(255,255,255,0.3); display: flex; align-items: center;
              justify-content: center; font-size: 12px; border-radius: 50% !important; z-index: 1;">üë§</div>`
          }

          <!-- Frame (·Ä°·Äï·Ä±·Ä´·Ä∫·Äë·ÄΩ·ÄÄ·Ä∫·Äï·Äº·Äû) -->
          <img src="${frameImg}" alt="Frame"
            style="position: absolute; top: -6px; left: -6px; width: 52px; height: 52px;
            object-fit: contain; z-index: 2; pointer-events: none;">
        </div>
      `;
    } else {
      profileCircle.innerHTML = currentUser?.photoURL
        ? `<img id="profile-circle-img" src="${currentUser.photoURL}"
            style="width: 100%; height: 100%; object-fit: cover; border-radius: 50% !important;">`
        : '<div class="default-avatar" id="profile-circle-default" style="border-radius: 50% !important;">üë§</div>';
    }
  }

  // ‚úÖ Save frame to Supabase for Rank system
  if (currentUser) {
    saveUserFrameToSupabase();
  }
}

// ‚úÖ NEW: Save user frame to Supabase for Rank display
async function saveUserFrameToSupabase() {
  try {
    if (!currentUser) return;
    
    const { error } = await supabase
      .from('users')
      .update({ 
        frame_id: currentUserFrame,
        updated_at: new Date().toISOString()
      })
      .eq('user_id', currentUser.uid);

    if (error) {
      console.error('Error saving frame to Supabase:', error);
      // If frame_id column doesn't exist, we'll handle it gracefully
      if (error.code === '42703') { // column doesn't exist
        console.log('frame_id column not found in Supabase table');
      }
    } else {
      console.log('Frame saved to Supabase for Rank display');
    }
  } catch (error) {
    console.error('Error in saveUserFrameToSupabase:', error);
  }
}

// ‚úÖ FIXED: Create Rank Avatar HTML with CSS Frame Overlay
function createRankAvatarHtml(user, userFrame) {
  const hasFrame = userFrame && userFrame !== 'default';
  const frameClass = hasFrame ? `frame-active frame-${userFrame}` : '';

  return `
    <div class="rank-avatar ${frameClass}">
      ${user.photo_url ? 
        `<img src="${user.photo_url}" alt="${user.display_name}">` :
        `<div class="default-avatar">üë§</div>`
      }
    </div>
  `;
}
// ‚úÖ NEW: Update saveUserToSupabase function to include frame_id
async function saveUserToSupabase(userData) {
  try {
    const { data, error } = await supabase
      .from('users')
      .upsert({
        user_id: userData.uid,
        display_name: userData.displayName,
        photo_url: userData.photoURL,
        tokens: userData.tokens,
        coins: userData.coins,
        crystals: userData.crystals,
        completed_tasks: userData.completedTasks,
        last_token_time: userData.lastTokenTime,
        battle_try: userData.battleTry,
        last_battle_time: userData.lastBattleTime,
        share_count: userData.shareCount,
        share10_count: userData.share10Count,
        frame_id: currentUserFrame, // ‚úÖ NEW: Include frame_id
        last_login: userData.lastLogin,
        updated_at: new Date().toISOString()
      }, {
        onConflict: 'user_id'
      });

    if (error) throw error;
    console.log('User saved to Supabase:', data);
    return data;
  } catch (error) {
    console.error('Error saving user to Supabase:', error);
    throw error;
  }
}

// ‚úÖ NEW: Update getUserFromSupabase to include frame_id
async function getUserFromSupabase(userId) {
  try {
    const { data, error } = await supabase
      .from('users')
      .select('*')
      .eq('user_id', userId)
      .single();

    if (error && error.code !== 'PGRST116') throw error;
    
    if (data) {
      return {
        uid: data.user_id,
        displayName: data.display_name,
        photoURL: data.photo_url,
        tokens: data.tokens,
        coins: data.coins,
        crystals: data.crystals || 0,
        completedTasks: data.completed_tasks,
        lastTokenTime: data.last_token_time,
        battleTry: data.battle_try,
        lastBattleTime: data.last_battle_time,
        shareCount: data.share_count,
        share10Count: data.share10_count,
        frameId: data.frame_id || 'default', // ‚úÖ NEW: Include frame_id
        lastLogin: data.last_login,
        createdAt: data.created_at,
        updatedAt: data.updated_at
      };
    }
    return null;
  } catch (error) {
    console.error('Error getting user from Supabase:', error);
    return null;
  }
}

// ‚úÖ NEW: Update displayRankings function to use frames
function displayRankings(users) {
  if (!users || users.length === 0) {
    return;
  }

  // Remove existing rank items (keep progress element)
  const progressElement = rankList.querySelector('div:first-child');
  const existingRankItems = rankList.querySelectorAll('.rank-item');
  existingRankItems.forEach(item => item.remove());
  
  // Add new rank items
  users.forEach((user, index) => {
    const isTop1 = index === 0;
    const isTop2 = index === 1;
    const isTop3 = index === 2;
    const isCurrentUser = currentUser && user.user_id === currentUser.uid;
    const isTokenRank = currentRankType === 'tokens';
    
    let rankClass = 'rank-item';
    if (isTop1) rankClass += ' rank-top-1';
    else if (isTop2) rankClass += ' rank-top-2';
    else if (isTop3) rankClass += ' rank-top-3';
    if (isTokenRank) rankClass += ' token-rank-item';
    if (isCurrentUser) rankClass += ' current-user-rank';
    
    // Get user frame data from Supabase
    const userFrame = user.frame_id || 'default';
    
    // Create rank avatar with frame support
    const avatarHtml = createRankAvatarHtml(user, userFrame);
    
    // Display value based on current rank type
    const value = isTokenRank ? (user.tokens || 0) : (user.coins || 0);
    const valueLabel = isTokenRank ? 'Tokens' : 'Coins';
    const valueColor = isTokenRank ? '#00ff88' : 'gold';
    
    const rankItem = document.createElement('div');
    rankItem.className = rankClass;
    rankItem.innerHTML = `
      <div class="rank-position">#${index + 1}</div>
      ${avatarHtml}
      <div class="rank-details">
        <div class="rank-name">${user.display_name || 'Anonymous'}</div>
        <div class="rank-coins" style="color: ${valueColor}">${value} ${valueLabel}</div>
        <div class="rank-id">ID: ${user.user_id}</div>
      </div>
    `;
    
    rankList.appendChild(rankItem);
  });
}

// Initialize purchased frames if not exists
function initializePurchasedFrames() {
  if (!localStorage.getItem('purchasedFrames')) {
    localStorage.setItem('purchasedFrames', JSON.stringify([]));
  }
}

// Initialize frame system
document.addEventListener('DOMContentLoaded', function() {
  initializePurchasedFrames();
  setTimeout(() => {
    if (currentUser) {
      updateProfileWithFrame();
      // Load current user's frame from Supabase
      loadUserFrameFromSupabase();
    }
  }, 1000);
});

// ‚úÖ NEW: Load user frame from Supabase
async function loadUserFrameFromSupabase() {
  try {
    if (!currentUser) return;
    
    const supabaseUser = await getUserFromSupabase(currentUser.uid);
    if (supabaseUser && supabaseUser.frameId) {
      currentUserFrame = supabaseUser.frameId;
      localStorage.setItem('currentUserFrame', currentUserFrame);
      updateProfileWithFrame();
    }
  } catch (error) {
    console.error('Error loading frame from Supabase:', error);
  }
}

// Game Mode System Variables
const gameModeBtn = document.getElementById('game-mode-btn');
const gameModeScreen = document.getElementById('game-mode-screen');
const backGameMode = document.getElementById('back-game-mode');
const shareToPlayBtn = document.getElementById('share-to-play-btn');
const startGameBtn = document.getElementById('start-game-btn');
const cooldownTimer = document.getElementById('cooldown-timer');
const cooldownTime = document.getElementById('cooldown-time');
const modeSelection = document.getElementById('mode-selection');
const modeCards = document.querySelectorAll('.mode-card');

// Pumpkin Game System Variables
const pumpkinGameScreen = document.getElementById('pumpkin-game-screen');
const countdownScreen = document.getElementById('countdown-screen');
const countdownNumber = document.getElementById('countdown-number');
const gameArea = document.getElementById('game-area');
const gameTimer = document.getElementById('game-timer');
const gameScore = document.getElementById('game-score');
const gameOverScreen = document.getElementById('game-over-screen');
const finalScore = document.getElementById('final-score');
const aiFinalScore = document.getElementById('ai-final-score');
const rewardMessage = document.getElementById('reward-message');
const winnerMessage = document.getElementById('winner-message');
const playAgainBtn = document.getElementById('play-again-btn');
const exitGameBtn = document.getElementById('exit-game-btn');
const aiPlayerAvatar = document.getElementById('ai-player-avatar');
const aiPlayerScore = document.getElementById('ai-player-score');

// Game Variables
let gameTime = 15;
let score = 0;
let aiScore = 0;
let gameInterval;
let itemInterval;
let aiInterval;
let countdownInterval;
let cooldownInterval;
let currentMode = 'easy';
let gameActive = false;
let maxAIScore = 20;
let pumpkinsPerSpawn = 5;    // Updated: Easy mode has 5 pumpkins
let tntPerSpawn = 10;        // Updated: Easy mode has 10 TNT

// Cooldown System Variables - MODIFIED: 2 plays per share
const GAME_COOLDOWN = 1 * 60 * 60 * 1000; // 1 hour in milliseconds
const MAX_PLAYS_PER_SHARE = 2; // 2 plays allowed per share
let lastPlayTime = parseInt(localStorage.getItem('lastPlayTime')) || 0;
let lastShareTime = parseInt(localStorage.getItem('lastShareTime')) || 0;
let playsRemaining = parseInt(localStorage.getItem('playsRemaining')) || 0;

// Initialize Game Mode Screen - MODIFIED: Check plays remaining
function initializeGameModeScreen() {
  const now = Date.now();
  const timeSinceLastShare = now - lastShareTime;
  
  // If never shared or share cooldown expired, show share button
  if (lastShareTime === 0 || timeSinceLastShare > GAME_COOLDOWN) {
    showShareButton();
    return;
  }
  
  // If shared within last hour, check plays remaining
  if (playsRemaining > 0) {
    showStartGameButton();
  } else {
    // No plays remaining, show cooldown
    showCooldownTimer();
    startCooldownTimer();
  }
}

// Show Share Button - MODIFIED: Add plays info
function showShareButton() {
  shareToPlayBtn.style.display = 'block';
  startGameBtn.style.display = 'none';
  cooldownTimer.style.display = 'none';
  modeSelection.style.display = 'none';
  
  // Update share button text to show plays info
  const shareText = shareToPlayBtn.querySelector('div:first-child');
  const subText = shareToPlayBtn.querySelector('div:last-child');
  if (shareText && subText) {
    shareText.textContent = "Share ·Äï·Ä´";
    subText.textContent = "Share ·Äï·Äº·ÄÆ·Ä∏ 2 ·ÄÅ·Ä´·ÄÜ·Ä±·Ä¨·Ä∑·Äú·Ä≠·ÄØ·Ä∑·Äõ·Äô·Ää·Ä∫";
  }
}

// Show Start Game Button - MODIFIED: Show plays remaining
function showStartGameButton() {
  shareToPlayBtn.style.display = 'none';
  startGameBtn.style.display = 'block';
  cooldownTimer.style.display = 'none';
  modeSelection.style.display = 'none';
  
  // Update start button text to show plays remaining
  const startText = startGameBtn.querySelector('div:first-child');
  if (startText) {
    startText.textContent = `·ÄÇ·Ä≠·Äô·Ä∫·Ä∏·ÄÄ·ÄÖ·Ä¨·Ä∏·Äô·Ää·Ä∫ (${playsRemaining} ·ÄÄ·Äº·Ä≠·Äô·Ä∫·ÄÄ·Äª·Äî·Ä∫)`;
  }
}

// Show Cooldown Timer - MODIFIED: Show when plays exhausted
function showCooldownTimer() {
  shareToPlayBtn.style.display = 'none';
  startGameBtn.style.display = 'none';
  cooldownTimer.style.display = 'block';
  modeSelection.style.display = 'none';
  
  // Update cooldown message
  const cooldownTitle = cooldownTimer.querySelector('div:first-child');
  if (cooldownTitle) {
    cooldownTitle.textContent = "·ÄÜ·Ä±·Ä¨·Ä∑·ÄÅ·ÄΩ·ÄÑ·Ä∑·Ä∫·Äï·Äº·Äî·Ä∫·Äõ·Äõ·Äî·Ä∫";
  }
}

// Start Cooldown Timer - MODIFIED: Wait for next share opportunity
function startCooldownTimer() {
  const now = Date.now();
  const timeRemaining = GAME_COOLDOWN - (now - lastShareTime);
  
  updateCooldownDisplay(timeRemaining);
  
  cooldownInterval = setInterval(() => {
    const now = Date.now();
    const timeRemaining = GAME_COOLDOWN - (now - lastShareTime);
    
    if (timeRemaining <= 0) {
      clearInterval(cooldownInterval);
      showShareButton(); // Can share again for more plays
    } else {
      updateCooldownDisplay(timeRemaining);
    }
  }, 1000);
}

// Update Cooldown Display - MODIFIED: Show time until next share
function updateCooldownDisplay(timeRemaining) {
  const hours = Math.floor(timeRemaining / (1000 * 60 * 60));
  const minutes = Math.floor((timeRemaining % (1000 * 60 * 60)) / (1000 * 60));
  const seconds = Math.floor((timeRemaining % (1000 * 60)) / 1000);
  
  if (hours > 0) {
    cooldownTime.textContent = `${hours}·Äî·Ä¨·Äõ·ÄÆ ${minutes}·Äô·Ä≠·Äî·ÄÖ·Ä∫`;
  } else {
    cooldownTime.textContent = `${minutes}·Äô·Ä≠·Äî·ÄÖ·Ä∫ ${seconds}·ÄÖ·ÄÄ·Äπ·ÄÄ·Äî·Ä∑·Ä∫`;
  }
}

// Game Mode Navigation
gameModeBtn.addEventListener('click', () => {
  mainScreen.style.display = 'none';
  gameModeScreen.style.display = 'block';
  initializeGameModeScreen();
});

backGameMode.addEventListener('click', () => {
  gameModeScreen.style.display = 'none';
  mainScreen.style.display = 'block';
  // Clear intervals when leaving
  clearInterval(cooldownInterval);
});

// Share to Play Button Click - MODIFIED: Reset plays counter
shareToPlayBtn.addEventListener('click', () => {
  // Open Telegram share
  const shareUrl = 'https://t.me/share/url?url=https://starlar1.github.io/Starlar-Company-Event-/&text=Gamer%20Vs%20Gamer%20Event%20%0AMLBB%20Diamond%20·Äô·Äª·Ä¨·Ä∏·ÄÄ·Ä≠·ÄØ%20·Ä°·ÄÅ·Äô·Ä≤·Ä∑·Äõ·Äö·Ä∞·Äú·Ä≠·ÄØ·ÄÄ·Ä∫·Äï·Ä´%20%0A';
  window.open(shareUrl, '_blank');
  
  // Save share time and reset plays counter
  lastShareTime = Date.now();
  playsRemaining = MAX_PLAYS_PER_SHARE;
  localStorage.setItem('lastShareTime', lastShareTime.toString());
  localStorage.setItem('playsRemaining', playsRemaining.toString());
  
  // Show start game button immediately after share
  setTimeout(() => {
    showStartGameButton();
  }, 1000);
});

// Start Game Button Click - MODIFIED: Show mode selection
startGameBtn.addEventListener('click', () => {
  startGameBtn.style.display = 'none';
  modeSelection.style.display = 'block';
});

// Game Mode Selection
modeCards.forEach(card => {
  card.addEventListener('click', function() {
    const mode = this.getAttribute('data-mode');
    selectGameMode(mode);
  });
});

// Game Mode Selection Function - MODIFIED: Decrement plays counter
function selectGameMode(mode) {
  currentMode = mode;
  
  // Set difficulty parameters - UPDATED WITH YOUR REQUIREMENTS
  if (currentMode === 'easy') {
    gameTime = 15;
    pumpkinsPerSpawn = 5;    // ·Ä°·Äú·ÄΩ·Äö·Ä∫·ÄÄ ·Äñ·Äõ·ÄØ·Ä∂·Äû·ÄÆ·Ä∏ 5
    tntPerSpawn = 10;        // ·Ä°·Äú·ÄΩ·Äö·Ä∫·ÄÄ TNT 10
    maxAIScore = 30;
    aiPlayerAvatar.style.backgroundImage = 'url("https://i.ibb.co/4ZRK4Yzs/Grid-Art-20251023-165303031.png")';
  } else {
    gameTime = 30;
    pumpkinsPerSpawn = 13;   // ·Ä°·ÄÅ·ÄÄ·Ä∫·ÄÖ·Ä¨·Ä∏·ÄÄ ·Äñ·Äõ·ÄØ·Ä∂·Äû·ÄÆ·Ä∏ 13
    tntPerSpawn = 15;        // ·Ä°·ÄÅ·ÄÄ·Ä∫·ÄÖ·Ä¨·Ä∏·ÄÄ TNT 20
    maxAIScore = 60;
    aiPlayerAvatar.style.backgroundImage = 'url("https://i.ibb.co/LhYbJbsC/Grid-Art-20251023-165232034.png")';
  }
  
  // Decrement plays counter
  playsRemaining--;
  localStorage.setItem('playsRemaining', playsRemaining.toString());
  
  // Update last play time
  lastPlayTime = Date.now();
  localStorage.setItem('lastPlayTime', lastPlayTime.toString());
  
  // Game screen ·ÄÄ·Ä≠·ÄØ·Äï·Äº·Äï·Ä´
  gameModeScreen.style.display = 'none';
  pumpkinGameScreen.style.display = 'block';
  
  // Countdown ·ÄÖ·Äï·Ä´
  startCountdown();
}

// Countdown Function
function startCountdown() {
  let countdown = 3;
  countdownNumber.textContent = countdown;
  countdownScreen.style.display = 'flex';
  
  countdownInterval = setInterval(() => {
    countdown--;
    countdownNumber.textContent = countdown;
    countdownNumber.classList.add('countdown-pop');
    
    setTimeout(() => {
      countdownNumber.classList.remove('countdown-pop');
    }, 500);
    
    if (countdown <= 0) {
      clearInterval(countdownInterval);
      countdownScreen.style.display = 'none';
      // Game ·ÄÖ·Äï·Ä´
      startGame();
    }
  }, 1000);
}

// Start Game Function
function startGame() {
  // Reset game state
  score = 0;
  aiScore = 0;
  gameActive = true;
  
  // Update UI
  gameTimer.textContent = gameTime;
  gameScore.textContent = score;
  aiPlayerScore.textContent = aiScore;
  gameOverScreen.style.display = 'none';
  
  // Clear game area
  gameArea.innerHTML = '';
  
  // Start timers
  startGameTimer();
  startItemSpawner();
  startAIPlayer();
}

// Start AI Player Function - UPDATED: Faster AI for hard mode
function startAIPlayer() {
  clearInterval(aiInterval);
  
  // AI will score gradually throughout the game
  const targetScore = maxAIScore;
  const incrementTime = (gameTime * 1000) / targetScore;
  
  aiInterval = setInterval(() => {
    if (!gameActive) return;
    
    // Increment AI score - faster in hard mode
    if (aiScore < targetScore) {
      aiScore++;
      aiPlayerScore.textContent = aiScore;
    }
  }, incrementTime);
}

// Spawn Multiple Items Function - UPDATED: More items per spawn
function spawnMultipleItems() {
  if (!gameActive) return;
  
  // Clear existing items
  const existingItems = gameArea.querySelectorAll('.pumpkin-item, .tnt-item, .pumpkin-loading, .tnt-loading');
  existingItems.forEach(item => item.remove());
  
  // Spawn pumpkins with loading circles (only for pumpkins)
  for (let i = 0; i < pumpkinsPerSpawn; i++) {
    spawnItemWithLoading('pumpkin');
  }
  
  // Spawn TNT without loading circles
  for (let i = 0; i < tntPerSpawn; i++) {
    spawnItem('tnt');
  }
}

// Spawn Item with Loading Circle - For Pumpkins Only
function spawnItemWithLoading(type) {
  // First create loading circle (only for pumpkins)
  if (type === 'pumpkin') {
    const loadingCircle = document.createElement('div');
    loadingCircle.className = 'pumpkin-loading';
    
    // Generate random position
    const {posX, posY} = getRandomPosition();
    
    loadingCircle.style.left = `${posX}px`;
    loadingCircle.style.top = `${posY}px`;
    
    // Add to game area
    gameArea.appendChild(loadingCircle);
    
    // After 0.5 seconds, replace with actual pumpkin
    setTimeout(() => {
      if (loadingCircle.parentNode) {
        loadingCircle.remove();
      }
      spawnItem('pumpkin', posX, posY);
    }, 500);
  } else {
    // For TNT, spawn directly without loading
    spawnItem('tnt');
  }
}

// Get Random Position Function
function getRandomPosition() {
  const maxX = window.innerWidth - 80;
  const maxY = window.innerHeight - 80;
  const minX = 20;
  const minY = 80;
  
  let posX, posY, overlaps;
  let attempts = 0;
  
  do {
    posX = Math.floor(Math.random() * (maxX - minX)) + minX;
    posY = Math.floor(Math.random() * (maxY - minY)) + minY;
    
    // Check for overlap with existing items
    overlaps = false;
    const existingItems = gameArea.querySelectorAll('.pumpkin-item, .tnt-item, .pumpkin-loading, .tnt-loading');
    
    for (const existingItem of existingItems) {
      const rect = existingItem.getBoundingClientRect();
      const distance = Math.sqrt(Math.pow(posX - (rect.left + 32.5), 2) + Math.pow(posY - (rect.top + 32.5), 2));
      
      if (distance < 80) {
        overlaps = true;
        break;
      }
    }
    
    attempts++;
  } while (overlaps && attempts < 50);
  
  return {posX, posY};
}

// Spawn Single Item Function
function spawnItem(type, posX = null, posY = null) {
  const item = document.createElement('div');
  
  if (type === 'tnt') {
    item.className = 'tnt-item';
    item.style.backgroundImage = 'url("https://i.ibb.co/Mxmk2QNz/Grid-Art-20251023-170434446.png")';
    item.dataset.type = 'tnt';
  } else {
    item.className = 'pumpkin-item';
    item.style.backgroundImage = 'url("https://i.ibb.co/FLfCGBFM/Grid-Art-20251023-170309324.png")';
    item.dataset.type = 'pumpkin';
  }
  
  // If position not provided, generate random position
  if (!posX || !posY) {
    const position = getRandomPosition();
    posX = position.posX;
    posY = position.posY;
  }
  
  item.style.left = `${posX}px`;
  item.style.top = `${posY}px`;
  
  // Add click event
  item.addEventListener('click', handleItemClick);
  
  // Add touch event for mobile
  item.addEventListener('touchstart', handleItemClick, { passive: false });
  
  // Add to game area
  gameArea.appendChild(item);
  
  // Remove after 1.5 seconds (2 seconds total for pumpkins with loading)
  setTimeout(() => {
  if (item.parentNode) {
    item.remove();
  }
}, 3000); // 3 seconds
}

// Handle Item Click
function handleItemClick(event) {
  if (!gameActive) return;
  
  // Prevent default for touch events
  if (event.type === 'touchstart') {
    event.preventDefault();
  }
  
  const item = event.currentTarget;
  const type = item.dataset.type;
  
  if (type === 'pumpkin') {
    // Add score
    score += 1;
    gameScore.textContent = score;
    
    // Visual feedback
    item.style.transform = 'scale(1.3)';
    item.style.opacity = '0.7';
    setTimeout(() => {
      if (item.parentNode) {
        item.remove();
      }
    }, 200);
    
  } else if (type === 'tnt') {
    // Game over
    endGame(true);
  }
}

// End Game Function
function endGame(isTNT = false) {
  gameActive = false;
  
  // Clear intervals
  clearInterval(gameInterval);
  clearInterval(itemInterval);
  clearInterval(aiInterval);
  clearInterval(countdownInterval);
  
  // Clear game area
  gameArea.innerHTML = '';
  
  // Calculate rewards
  let rewardTokens = 0;
  let penaltyCoins = 0;
  let rewardText = '';
  
  if (score > aiScore) {
    // Player wins
    if (currentMode === 'easy') {
      rewardTokens = 2;
      rewardText = `üèÜ ·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äï·Ä´·Äû·Ää·Ä∫! 2 Token ·Äõ·Äõ·Äæ·Ä≠·Äï·Ä´·Äû·Ää·Ä∫!`;
    } else {
      rewardTokens = 5;
      rewardText = `üèÜ ·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äï·Ä´·Äû·Ää·Ä∫! 5 Token ·Äõ·Äõ·Äæ·Ä≠·Äï·Ä´·Äû·Ää·Ä∫!`;
    }
    
    // Add tokens
    tokens += rewardTokens;
    if (tokenCountElem) tokenCountElem.textContent = tokens;
    
  } else {
    // Player loses
    if (currentMode === 'easy') {
      penaltyCoins = 100;
      rewardText = `üíî ·Äõ·Äæ·ÄØ·Ä∂·Ä∏·Äï·Ä´·Äû·Ää·Ä∫! 100 Coins ·ÄÜ·ÄØ·Ä∂·Ä∏·Äõ·Äæ·ÄØ·Ä∂·Ä∏·Äï·Ä´·Äû·Ää·Ä∫!`;
    } else {
      penaltyCoins = 300;
      rewardText = `üíî ·Äõ·Äæ·ÄØ·Ä∂·Ä∏·Äï·Ä´·Äû·Ää·Ä∫! 300 Coins ·ÄÜ·ÄØ·Ä∂·Ä∏·Äõ·Äæ·ÄØ·Ä∂·Ä∏·Äï·Ä´·Äû·Ää·Ä∫!`;
    }
    
    // Deduct coins (but not below 0)
    coins = Math.max(0, coins - penaltyCoins);
    if (coinCountElem) coinCountElem.textContent = coins;
  }
  
  // Determine winner message
  let winnerText = '';
  if (score > aiScore) {
    winnerText = 'üéâ ·Äû·ÄÑ·Ä∫·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äï·Ä´·Äû·Ää·Ä∫!';
  } else if (score < aiScore) {
    winnerText = 'ü§ñ AI Player ·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äï·Ä´·Äû·Ää·Ä∫!';
  } else {
    winnerText = 'ü§ù ·Äê·Ä∞·Ää·ÄÆ·Äï·Ä´·Äû·Ää·Ä∫!';
  }
  
  // Show game over screen
  finalScore.textContent = `·Äû·ÄÑ·Ä∑·Ä∫·Äõ·Ä≤·Ä∑·Ä°·Äô·Äæ·Äê·Ä∫: ${score}`;
  aiFinalScore.textContent = `AI Player ·Ä°·Äô·Äæ·Äê·Ä∫: ${aiScore}`;
  rewardMessage.textContent = rewardText;
  winnerMessage.textContent = winnerText;
  gameOverScreen.style.display = 'flex';
  
  // Show different message for TNT
  if (isTNT) {
    const gameOverTitle = gameOverScreen.querySelector('h2');
    gameOverTitle.textContent = 'TNT ·Äî·Äæ·Ä≠·Äï·Ä∫·Äô·Ä≠·Äï·Ä´·Äû·Ää·Ä∫!';
    gameOverTitle.style.color = '#ff6b6b';
  }
  
  // Save game state
  saveGameState();
}

// Game Timer
function startGameTimer() {
  clearInterval(gameInterval);
  
  gameInterval = setInterval(() => {
    gameTime--;
    gameTimer.textContent = gameTime;
    
    if (gameTime <= 0) {
      endGame();
    }
  }, 1000);
}

// Item Spawner
function startItemSpawner() {
  clearInterval(itemInterval);
  
  // Spawn items every 2 seconds
  itemInterval = setInterval(() => {
    if (!gameActive) return;
    spawnMultipleItems();
  }, 2000);
}

// Game Navigation - MODIFIED: Check plays remaining
playAgainBtn.addEventListener('click', () => {
  gameOverScreen.style.display = 'none';
  
  // Always go back to game mode screen
  pumpkinGameScreen.style.display = 'none';
  gameModeScreen.style.display = 'block';
  initializeGameModeScreen(); // This will check plays remaining
});

exitGameBtn.addEventListener('click', () => {
  pumpkinGameScreen.style.display = 'none';
  mainScreen.style.display = 'block';
  endGame();
});

// Check cooldowns on page load and periodically
document.addEventListener('DOMContentLoaded', function() {
  // Initialize game mode screen state
  initializeGameModeScreen();
});

// Periodically check cooldowns (every minute)
setInterval(() => {
  if (gameModeScreen.style.display === 'block') {
    initializeGameModeScreen(); // Update display based on current time
  }
}, 60000); // Check every minute

const music = document.getElementById('bg-music');

// Default ·Äû·ÄÆ·ÄÅ·Äª·ÄÑ·Ä∫·Ä∏ (Halloween Waltz)
let defaultMusic = "Halloween_Waltz__Ìï†Î°úÏúà_ÏôàÏ∏†_(256k).mp3";
// ·ÄÄ·Äº·Ä±·Ä∏·ÄÖ·Ä¨·Ä∏·ÄÇ·Ä≠·Äô·Ä∫·Ä∏·Äû·ÄÆ·ÄÅ·Äª·ÄÑ·Ä∫·Ä∏ (Blue Archive OST)
let battleMusic = "„Éñ„É´„Éº„Ç¢„Éº„Ç´„Ç§„Éñ_Blue_Archive_OST_11._Connected_Sky(256k).mp3";

// ·ÄÄ·Äº·Ä±·Ä∏·ÄÖ·Ä¨·Ä∏·ÄÇ·Ä≠·Äô·Ä∫·Ä∏·ÄÄ·Ä≠·ÄØ·Äî·Äæ·Ä≠·Äï·Ä∫·Äê·Ä¨·Äî·Ä≤·Ä∑ ·Äû·ÄÖ·Ä∫·Äû·ÄÆ·ÄÅ·Äª·ÄÑ·Ä∫·Ä∏·Äñ·ÄΩ·ÄÑ·Ä∑·Ä∫·Äô·Äö·Ä∫
document.getElementById('game-mode-btn').addEventListener('click', () => {
  if (music.src.indexOf(battleMusic) === -1) { // ·Äô·Äê·Ä∞·Äõ·ÄÑ·Ä∫·Äô·Äæ·Äï·Äº·Ä±·Ä¨·ÄÑ·Ä∫·Ä∏
    music.src = battleMusic;
    music.play().catch(err => console.log("Autoplay blocked:", err));
  } else {
    music.play();
  }
});

// Event ·Äû·Ä≠·ÄØ·Ä∑·ÄÄ·Ä≠·ÄØ·Äî·Äæ·Ä≠·Äï·Ä∫·Äê·Ä¨·Äî·Ä≤·Ä∑ ·Ä°·Äõ·ÄÑ·Ä∫·Äû·ÄÆ·ÄÅ·Äª·ÄÑ·Ä∫·Ä∏·Äï·Äº·Äî·Ä∫·Äñ·ÄΩ·ÄÑ·Ä∑·Ä∫·Äô·Äö·Ä∫
document.getElementById('event-btn').addEventListener('click', () => {
  if (music.src.indexOf(defaultMusic) === -1) {
    music.src = defaultMusic;
    music.play().catch(err => console.log("Autoplay blocked:", err));
  } else {
    music.play();
  }
});

// Home ·Äû·Ä≠·ÄØ·Ä∑·Äï·Äº·Äî·Ä∫·Äê·Ä≤·Ä∑·ÄÅ·Äú·ÄØ·Äê·Ä∫·Äê·ÄΩ·Ä±·ÄÄ·Ä≠·ÄØ·Äî·Äæ·Ä≠·Äï·Ä∫·Äõ·ÄÑ·Ä∫ ·Äû·ÄÆ·ÄÅ·Äª·ÄÑ·Ä∫·Ä∏pause·Äñ·Äº·ÄÖ·Ä∫·Äî·Ä±·Äõ·ÄÑ·Ä∫·Äï·Äº·Äî·Ä∫·Äñ·ÄΩ·ÄÑ·Ä∑·Ä∫·Äô·Äö·Ä∫
const homeButtons = ['back-winner', 'back-rank', 'back-btn', 'sidebar-toggle'];
homeButtons.forEach(id => {
  const btn = document.getElementById(id);
  if (btn) {
    btn.addEventListener('click', () => {
      if (music.paused) {
        music.play();
      }
    });
  }
});

// Function to display server status (for debugging)
function displayServerStatus() {
  console.log('=== Server Status ===');
  Object.keys(SUPABASE_SERVERS).forEach(server => {
    const status = SUPABASE_SERVERS[server].enabled ? 
                  (SUPABASE_SERVERS[server].newUsers ? 'üü¢ Available' : 'üü° Existing Only') : 
                  'üî¥ Disabled';
    console.log(`${server}: ${status} (${userCounts[server] || 0}/${SUPABASE_SERVERS[server].maxUsers} users)`);
  });
  console.log('=====================');
}

// Call this function during initialization
displayServerStatus();
</script>
</body>
</html>
